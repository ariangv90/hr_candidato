
<!-- saved from url=(0068)https://www.programcreek.com/python/example/97694/dns.resolver.query -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><script src="./Python Examples of dns.resolver.query_files/rules-p-31iz6hfFutd16.js" async=""></script><script src="./Python Examples of dns.resolver.query_files/quant.js" async="" type="text/javascript"></script><script async="" src="./Python Examples of dns.resolver.query_files/analytics.js"></script><script data-ezscrex="false" data-cfasync="false" data-pagespeed-no-defer="">var __ez=__ez||{};__ez.stms=Date.now();__ez.evt={};__ez.script={};__ez.ck=__ez.ck||{};__ez.template={};__ez.template.isOrig=false;__ez.queue=function(){var e=0,i=0,n=[],t=!1,r=[],s=[],o=!0,a=function(e,i,t,r,s,o,a){var l=this;this.name=e,this.funcName=i,this.parameters=null===t?null:t instanceof Array?t:[t],this.isBlock=r,this.blockedBy=s,this.deleteWhenComplete=o,this.isError=!1,this.isComplete=!1,this.isInitialized=!1,this.proceedIfError=a,this.isTimeDelay=!1,this.process=function(){f("... func = "+e),l.isInitialized=!0,l.isComplete=!0,f("... func.apply: "+e);var i=l.funcName.split("."),t=null;i.length>3||(t=3===i.length?window[i[0]][i[1]][i[2]]:2===i.length?window[i[0]][i[1]]:window[l.funcName]),null!=t&&t.apply(null,this.parameters),!0===l.deleteWhenComplete&&delete n[e],!0===l.isBlock&&(f("----- F'D: "+l.name),m())}},l=function(e,i,n,t,r,s,o){var a=this;this.name=e,this.path=i,this.async=r,this.defer=s,this.isBlock=n,this.blockedBy=t,this.isInitialized=!1,this.isError=!1,this.isComplete=!1,this.proceedIfError=o,this.isTimeDelay=!1,this.process=function(){a.isInitialized=!0,f("... file = "+e);var n=document.createElement("script");n.src=i,!0===r?n.async=!0:!0===s&&(n.defer=!0),n.onerror=function(){f("----- ERR'D: "+a.name),a.isError=!0,!0===a.isBlock&&m()},n.onreadystatechange=n.onload=function(){var e=n.readyState;f("----- F'D: "+a.name),e&&!/loaded|complete/.test(e)||(a.isComplete=!0,!0===a.isBlock&&m())},document.getElementsByTagName("head")[0].appendChild(n)}},c=function(e,i){this.name=e,this.path="",this.async=!1,this.defer=!1,this.isBlock=!1,this.blockedBy=[],this.isInitialized=!0,this.isError=!1,this.isComplete=i,this.proceedIfError=!1,this.isTimeDelay=!1,this.process=function(){}};function d(e){!0!==h(e)&&0!=o&&e.process()}function h(e){if(!0===e.isTimeDelay&&!1===t)return f(e.name+" blocked = TIME DELAY!"),!0;if(e.blockedBy instanceof Array)for(var i=0;i<e.blockedBy.length;i++){var r=e.blockedBy[i];if(!1===n.hasOwnProperty(r))return f(e.name+" blocked = "+r),!0;if(!0===e.proceedIfError&&!0===n[r].isError)return!1;if(!1===n[r].isComplete)return f(e.name+" blocked = "+r),!0}return!1}function f(e){var i=window.location.href,n=new RegExp("[?&]ezq=([^&#]*)","i").exec(i);"1"===(n?n[1]:null)&&console.debug(e)}function m(){++e>200||(f("let's go"),u(r),u(s))}function u(e){for(var i in e)if(!1!==e.hasOwnProperty(i)){var n=e[i];!0===n.isComplete||h(n)||!0===n.isInitialized||!0===n.isError?!0===n.isError?f(n.name+": error"):!0===n.isComplete?f(n.name+": complete already"):!0===n.isInitialized&&f(n.name+": initialized already"):n.process()}}return window.addEventListener("load",(function(){setTimeout((function(){t=!0,f("TDELAY -----"),m()}),5e3)}),!1),{addFile:function(e,i,t,o,a,c,h,f){var m=new l(e,i,t,o,a,c,h);!0===f?r[e]=m:s[e]=m,n[e]=m,d(m)},addDelayFile:function(e,i){var t=new l(e,i,!1,[],!1,!1,!0);t.isTimeDelay=!0,f(e+" ...  FILE! TDELAY"),s[e]=t,n[e]=t,d(t)},addFunc:function(e,t,o,l,c,h,f,m,u){!0===h&&(e=e+"_"+i++);var p=new a(e,t,o,l,c,f,m);!0===u?r[e]=p:s[e]=p,n[e]=p,d(p)},addDelayFunc:function(e,i,t){var r=new a(e,i,t,!1,[],!0,!0);r.isTimeDelay=!0,f(e+" ...  FUNCTION! TDELAY"),s[e]=r,n[e]=r,d(r)},items:n,processAll:m,setallowLoad:function(e){o=e},markLoaded:function(e){if(e&&0!==e.length){if(e in n){var i=n[e];!0===i.isComplete?f(i.name+" "+e+": error loaded duplicate"):(i.isComplete=!0,i.isInitialized=!0)}else n[e]=new c(e,!0);f("markLoaded dummyfile: "+n[e].name)}},logWhatsBlocked:function(){for(var e in n)!1!==n.hasOwnProperty(e)&&h(n[e])}}}();__ez.evt.add=function(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent?e.attachEvent("on"+t,n):e["on"+t]=n()},__ez.evt.remove=function(e,t,n){e.removeEventListener?e.removeEventListener(t,n,!1):e.detachEvent?e.detachEvent("on"+t,n):delete e["on"+t]};__ez.script.add=function(e){var t=document.createElement("script");t.src=e,t.async=!0,t.type="text/javascript",document.getElementsByTagName("head")[0].appendChild(t)};__ez.dot={};</script><link rel="preconnect" href="https://go.ezoic.net/" crossorigin=""><script data-ezscrex="false" data-cfasync="false" data-pagespeed-no-defer="" src="./Python Examples of dns.resolver.query_files/cash.js"></script><script ez-screx="true">(function(){function storageAvailable(type){var storage;try{storage=window[type];var x='__storage_test__';storage.setItem(x,x);storage.removeItem(x);return true;}
catch(e){return e instanceof DOMException&&(e.code===22||e.code===1014||e.name==='QuotaExceededError'||e.name==='NS_ERROR_DOM_QUOTA_REACHED')&&(storage&&storage.length!==0);}}
function remove_ama_config(){if(storageAvailable('localStorage')){localStorage.removeItem("google_ama_config");}}
remove_ama_config()})()</script><script data-ezscrex="false" data-cfasync="false">__ez.ssaf=[17,19,16];__ez.sswp=4;__ez.ssv=401214;__ez.sshsdef=true;</script><script>var ezoicTestActive=true</script><script data-ezscrex="false" data-cfasync="false">var _ezaq={"ad_cache_level":1,"ad_count_adjustment":0,"ad_lazyload_version":14,"ad_load_version":1,"ad_location_ids":"","ad_transform_level":0,"adx_ad_count":0,"bidder_method":1,"bidder_version":3,"city":"Havana","country":"CU","days_since_last_visit":-1,"display_ad_count":0,"domain_id":55920,"domain_test_group":20210305,"ds_adsize_opt_id":-1,"engaged_time_visit":0,"ezcache_level":1,"ezcache_skip_code":11,"form_factor_id":1,"framework_id":1,"has_bad_image":0,"has_bad_words":0,"iab_category":"","iab_category_0":"596","iab_category_1":"631","is_from_recommended_pages":false,"is_return_visitor":false,"is_sitespeed":1,"last_page_load":"","last_pageview_id":"","lt_cache_level":0,"max_ads":0,"metro_code":0,"optimization_version":1,"page_ad_positions":"","page_view_count":0,"page_view_id":"897511a0-0f10-454d-5758-1d17bb00d9e8","position_selection_id":46,"postal_code":"","pv_event_count":0,"response_size_orig":148844,"response_time_orig":386,"serverid":"34.230.29.149:20010","state":"03","sub_page_ad_positions":"","t_epoch":1661430316,"template_id":134,"time_on_site_visit":0,"url":"https://www.programcreek.com/python/example/97694/dns.resolver.query","user_id":0,"weather_precipitation":0,"weather_summary":"","weather_temperature":0,"word_count":2853,"worst_bad_word_level":0};var _ezim_d={};var _ezat={"domain_id":55920,"form_factor_id":1,"framework_id":1,"pageview_date":"2022-08-25","pageview_id":"897511a0-0f10-454d-5758-1d17bb00d9e8","template_id":134,"url":"https://www.programcreek.com/python/example/97694/dns.resolver.query","visit_uuid":"67ff7e23-e333-4d6c-7f41-912cb8840983"};</script><script data-ezscrex="false" data-pagespeed-no-defer="" data-cfasync="false">__ez.queue.addFile('banger.js','/porpoiseant/banger.js?cb=195-0&bv=145&v=61&PageSpeed=off',true,[],true,false,false,true);</script><script src="./Python Examples of dns.resolver.query_files/banger.js" async=""></script><script data-ezscrex="false" data-cfasync="false" data-pagespeed-no-defer="">!function(){var e;__ez.vep=(e=[],{Add:function(i,t){__ez.dot.isDefined(i)&&__ez.dot.isValid(t)&&e.push({type:"video",video_impression_id:i,domain_id:__ez.dot.getDID(),t_epoch:__ez.dot.getEpoch(0),data:__ez.dot.dataToStr(t)})},Fire:function(){if(void 0===document.visibilityState||"prerender"!==document.visibilityState){if(__ez.dot.isDefined(e)&&e.length>0)for(;e.length>0;){var i=5;i>e.length&&(i=e.length);var t=e.splice(0,i),o=__ez.dot.getURL("/detroitchicago/grapefruit.gif")+"?orig="+(!0===__ez.template.isOrig?1:0)+"&v="+btoa(JSON.stringify(t));__ez.dot.Fire(o)}e=[]}}})}();</script><script data-ezscrex="false" data-cfasync="false" data-pagespeed-no-defer=""></script><title>Python Examples of dns.resolver.query</title><style>html,body{background-color:#fff;font-size:11pt;color:#000;padding:0;margin:0 auto;width:100%;min-width:1140px;font-family:arial,sans-serif;line-height:1.5;color:#333}*{list-style-image:none;list-style-position:outside;list-style-type:none;margin:0;padding:0}#header{background-color:#02427a;margin:0 auto;color:#fff;position:fixed;top:0;width:100%}#header a{text-decoration:none;color:#fff}.header_bg{background-color:#0357a1}#header-center{height:30px;padding:0;margin:0 auto;width:100%}#top-logo{float:left;margin-left:20px;margin:0;padding:1px;overflow:hidden;height:28px}ul#navigation{float:left;margin-left:20px;list-style-type:none;margin:0;padding:0;overflow:hidden;height:30px}ul#login,ul#language-nav{float:right;margin-right:20px;list-style-type:none;margin:0;padding:0;overflow:hidden;height:30px}#navigation li a,#language-nav li a,#login li a{display:block;color:#fff;text-align:center;padding:5px 10px;text-decoration:none}#language-nav li a{display:block;color:#fff;text-align:center;padding:5px 10px;text-decoration:none;border-radius:0;background-color:#035842}#navigation li a:hover,#login li a:hover{background-color:#035ba8;text-decoration:none}#language-nav li a:hover{background-color:#03ad81;text-decoration:none}#navigation li,#language-nav li,#login li{float:left}.dropbtn{background-color:#02427a;color:#fff;padding:6px 10px 4px;font-size:16px;border:none;height:30px;font-size:11pt}.dropdown{position:relative;display:inline-block}.dropdown-content{display:none;position:absolute;background-color:#02427a;min-width:180px;box-shadow:0 8px 16px rgba(0,0,0,.2);z-index:1}.dropdown-content a{color:#000;padding:6px 12px;text-decoration:none;display:block}.dropdown-content a:hover{background-color:#0357a1}.dropdown:hover .dropdown-content{display:block}.dropdown:hover .dropbtn{background-color:#3e8e41}.main-title{text-align:center;margin:50px 0 20px}.title_font{color:#0467b8}.logo_font{font-size:38}#loginArea{width:500px;margin:0 auto;padding:10px;color:#707070;background-color:#fff;border:1px solid #ccc;border-radius:5px}#loginArea input[type=text],#loginArea textarea,#loginArea input[type=password]{font-family:Arial,Sans-Serif;font-size:13px;margin-bottom:5px;display:block;padding:4px;border:solid 1px #85b1de;width:300px;height:30px;background-color:#fff}#loginArea input[type=submit]{background-color:#f5f5f5;border:1px solid rgba(0,0,0,.1);color:Grey;cursor:pointer;font-size:13px;font-weight:700;height:30px;margin:12px 6px;padding:0 8px;text-align:center}#register_link{color:#02427a;cursor:pointer;font-size:15px;font-weight:700;height:29px;line-height:27px;margin:12px 6px;display:inline}#register_link a{text-decoration:none;color:#02427a}#inputArea input[type=submit]{background-color:#f5f5f5;border:1px solid rgba(0,0,0,.1);color:Grey;cursor:pointer;font-size:12px;font-weight:700;height:29px;line-height:27px;margin:12px 6px;min-width:54px;padding:0 8px;text-align:center}a{color:#3572b0;text-decoration:none}h1{font-size:26px;font-weight:400;line-height:1.25}p{margin-left:5px;margin-right:5px}#main_center{padding:5px;padding-top:10px;clear:both;margin:0 auto;width:100%}#content{margin:0 auto;padding:5px;width:1140px}.sb-font-big{text-align:center}.sb-font-tiny{font-size:16px;font-weight:500;color:#02999c;margin-top:20px}#main{padding:2px;width:830px;margin-top:10px}#sidebar-example{margin-top:10px;display:inline;float:right;line-height:1.5em;font-size:15px;color:#424345;width:300px}#footer{clear:both;color:#707070;font-size:12px;line-height:1.66667;margin-top:90px;min-height:44px;padding:0 10px 21px;text-align:center;width:100%}#clear_both{clear:both;width:100%;height:5px;margin-top:5px;margin-bottom:5px;border:5px solid red}.each_list{clear:both;display:block;margin-bottom:10px;background-color:#f7f5f5;min-height:80px}.list_item{float:left;padding:3px;text-align:left;color:blue;width:300px}a.tag{padding:5px;background-color:#ebeff2;border:1px solid #ebeff2;border-radius:5px;color:#6b6d6d;display:inline-block;margin:5px;height:20px;line-height:20px}a.tag:hover{padding:5px;background-color:#f9f9d6;border:1px solid #bfbfbf;border-radius:5px;margin:5px;height:20px;line-height:20px;color:grey}.delete{display:inline-block;padding-bottom:2px;cursor:pointer;cursor:hand}.highlight{background-color:#85f97073;border-radius:2px;padding:1px 1px 1px 3px}ul#paging,ul#paging li{margin:2px;padding:0}ul#paging li{font-size:16px;display:inline-block;border:1px solid #d0d5d6;background:ivory;padding:3px;width:25px;text-align:center}ul#api-list,ul#api-list li{margin:1px}ul#api-list li{font-size:15px;border-bottom:1px solid #d0d5d6;padding:5px;display:block;overflow:hidden}ul#api-list li a:hover{text-decoration:underline}ul#api-list li.with-hover:hover{background-color:#e3f2f7}#api-list-apiname{float:left;word-wrap:break-word;font-size:15px}#api-list-middle{color:#bbb;float:left;font-size:15px}#api-list-right{color:#bbb;float:right;font-size:15px}.examplebox{padding:0;word-wrap:break-word;border:1px solid #d8d8d8;border-radius:3px;width:100%;margin-top:10px;margin-bottom:20px;background-color:#fff}.exampleboxheader{font-size:13px;border-bottom:1px solid #d8d8d8;background-color:#f7f7f7;width:100%;margin-bottom:2px}.exampleboxbody{width:100%}.vote,.save{padding-bottom:2px;cursor:pointer;cursor:hand;color:blue}.vote_msg{display:inline-block;padding-bottom:2px;cursor:pointer;cursor:hand;color:blue}.click_button{border-radius:2px;border:1px solid #d8d8d8;padding:3px;color:#555;cursor:pointer;cursor:hand;background-color:#f7f7f7}.click_button:hover{border:1px solid #333;background-color:#dcdede}#index_page_top_text_box{margin-bottom:10px;margin-top:30px;border:1px solid #c2c0c0;padding:10px;background-color:#f7f9fc;font-size:16px;font-family:Candara,Calibri,Segoe,segoe ui,Optima,Arial,sans-serif;border-radius:5px}.sidebarbox{border:1px solid #d8d8d8;border-radius:3px;padding:0;word-wrap:break-word;background-color:#fff}.sidebarbox li{list-style-image:url(https://www.programcreek.com/common/static/images/c2.png)}.sidebarboxheader{font-size:17px;padding:5px 0 5px 10px;border-bottom:1px solid #d8d8d8;background-color:#f7f7f7}.sidebarboxbody{margin:2px 0 0 18px;padding:5px}#view_complete_list:hover{cursor:pointer;cursor:hand}#search_page_main{width:100%;clear:both;min-width:1e3px}#search-box-above-blank{height:240px;width:100%;clear:both}#search_box_container{width:535px;margin:0 auto}#search_box_logo{width:535px;margin:0 auto;text-align:center}#search-box{font-family:Arial,Sans-Serif;font-size:13px;padding:4px;border:solid 1px #c9c7c7;width:100%;height:30px;background-color:#fff}#search-box-div{width:85%;overflow:hidden;float:left}#search-button{background-color:#f5f5f5;border:1px solid rgba(0,0,0,.1);color:Grey;cursor:pointer;font-size:13px;height:30px;padding:4px 8px;text-align:center}#search-button-div{width:15%;text-align:right;float:right}#search_box_bottom_space{height:40px;width:100%;clear:both}.example-box-below-search{clear:both;margin-top:80px;margin-bottom:30px;font-family:Arial,Helvetica,sans-serif;font-size:18px;letter-spacing:1px;word-spacing:1px;text-align:center}#search_box_below__gap_or_results{width:1e3px;margin:auto}.italic_font{font-style:italic}a.italic_font:hover{font-style:italic;background-color:#f9f9d6;color:grey}progress::-webkit-progress-bar{background-color:hsl(210deg 8% 90%);width:600px}progress{background-color:hsl(210deg 8% 90%);width:700px}progress::-webkit-progress-value{background-color:hsl(210deg 7% 52%)!important}progress::-moz-progress-bar{background-color:hsl(210deg 7% 52%)!important}progress{color:hsl(210deg 7% 52%)}.popularity-div{margin-left:15px;color:grey;font-size:13px}</style><link rel="preload" href="./Python Examples of dns.resolver.query_files/jquery.js" as="script"><link rel="preload" href="./Python Examples of dns.resolver.query_files/jquery.highlight-3.js" as="script"><link rel="stylesheet" href="./Python Examples of dns.resolver.query_files/prettify.css"><link rel="preload" href="./Python Examples of dns.resolver.query_files/prettify.js" as="script"><meta name="description" content="This page shows Python examples of dns.resolver.query"><meta name="keywords" content="Python Examples of dns.resolver.query"><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-7639629-4','auto');ga('send','pageview');</script><style id="ezoicCSS">.ezoic-ad{display:inline-block;border:0}.ezoic-ad>div>iframe{margin:0!important;padding:0!important}.ezoic-floating-bottom{display:none!important}</style><link rel="canonical" href="https://www.programcreek.com/python/example/97694/dns.resolver.query"><script>var ezouid="1";</script><!--<base href="https://www.programcreek.com/python/example/97694/dns.resolver.query">--><base href="."><script>var ezoTemplate='pub_site';if(typeof ezouid=='undefined')
{var ezouid='none';}
var ezoFormfactor='1';var ezo_elements_to_check=Array();</script><script data-ezscrex="false">var soc_app_id='0';var did=55920;var ezdomain='programcreek.com';var ezoicSearchable=1;</script><script data-ezscrex="false" data-pagespeed-no-defer="" data-cfasync="false">function create_ezolpl(pvID,rv){var d=new Date();d.setTime(d.getTime()+(365*24*60*60*1000));var expires="expires="+d.toUTCString();__ez.ck.setByCat("ezux_lpl_55920="+new Date().getTime()+"|"+pvID+"|"+rv+"; "+expires,3);}
function attach_ezolpl(pvID,rv){if(document.readyState==="complete"){create_ezolpl(pvID,rv);}
if(window.attachEvent){window.attachEvent("onload",create_ezolpl,pvID,rv);}else{if(window.onload){var curronload=window.onload;var newonload=function(evt){curronload(evt);create_ezolpl(pvID,rv);};window.onload=newonload;}else{window.onload=create_ezolpl.bind(null,pvID,rv);}}}
__ez.queue.addFunc("attach_ezolpl","attach_ezolpl",["897511a0-0f10-454d-5758-1d17bb00d9e8","false"],false,['/detroitchicago/boise.js'],true,false,false,false);</script><script>var _audins_dom="programcreek_com",_audins_did=55920;__ez.queue.addFile('/detroitchicago/cmbv2.js','/detroitchicago/cmbv2.js?gcb=195-0&cb=04-6y02-9y06-14y07-2y19-7y0b-6y0d-21y13-4y17-6y1c-4y20-2y1f-5y21-3y2f-4y57-2&cmbcb=100&sj=x04x02x06x07x19x0bx0dx13x17x1cx20x1fx21x2fx57',true,[],true,false,true,false);</script><script src="./Python Examples of dns.resolver.query_files/cmbv2.js" async=""></script><script defer="">__ez.queue.addFile('/detroitchicago/cmbdv2.js','/detroitchicago/cmbdv2.js?gcb=195-0&cb=03-9y0c-6y18-6&cmbcb=100&sj=x03x0cx18',true,['/detroitchicago/cmbv2.js'],true,false,true,false);</script><script src="./Python Examples of dns.resolver.query_files/nmash.js"></script><script src="./Python Examples of dns.resolver.query_files/cmbdv2.js" async=""></script></head><body onload="prettyPrint()"><script src="./Python Examples of dns.resolver.query_files/jquery.js"></script><script src="./Python Examples of dns.resolver.query_files/jquery.highlight-3.js"></script><link rel="stylesheet" media="screen" href="./Python Examples of dns.resolver.query_files/prettify.css"><script src="./Python Examples of dns.resolver.query_files/prettify.js"></script><div id="header"><div id="header-center"><div id="top-logo"><img src="./Python Examples of dns.resolver.query_files/logo-java-topbar-left.png" height="28" ezimgfmt="rs rscb13 src ng ngcb13" class=" ezlazyloaded" data-ezsrc="https://www.programcreek.com/common/static/images/logo-java-topbar-left.png?ezimgfmt=rs:28x28/rscb13/ng:webp/ngcb13" ezoid="0.305240810032414"></div><ul id="navigation"><li><a href="https://www.programcreek.com/python">Search by Module</a></li><li><a href="https://www.programcreek.com/python?action=search_nlp">Search by Words</a></li><li><a href="https://www.programcreek.com/python?action=search_project">Search Projects</a></li></ul><div class="dropdown"><button class="dropbtn">Most Popular</button><div class="dropdown-content"><a href="https://www.programcreek.com/python/index/module/list">Top Python APIs</a>
<a href="https://www.programcreek.com/python?action=top_projects">Popular Projects</a></div></div><ul id="language-nav"><li><a href="https://www.programcreek.com/java-api-examples/">Java</a></li><li><a style="background-color:#138365" href="https://www.programcreek.com/python/">Python</a></li><li><a href="https://www.programcreek.com/javascript/">JavaScript</a></li><li><a href="https://www.programcreek.com/typescript/">TypeScript</a></li><li><a href="https://www.programcreek.com/cpp/">C++</a></li><li><a href="https://www.programcreek.com/scala/">Scala</a></li><li><a href="https://www.programcreek.com/">Blog</a></li></ul></div></div><div style="clear:both;width:100%"></div><div id="content"><div id="sidebar-example"><div style="height:65px;clear:both"></div><span id="ezoic-pub-ad-placeholder-117"></span><div class="sidebarbox"><div class="sidebarboxheader" id="relatedClass"><b>More from <span style="color:#0586e3"><i>dns.resolver</i></span></b></div><div class="sidebarboxbody"><ul><li><a href="https://www.programcreek.com/python/example/97690/dns.resolver.NoAnswer">.NoAnswer()</a></li><li><a href="https://www.programcreek.com/python/example/97691/dns.resolver.nameservers">.nameservers()</a></li><li><a href="https://www.programcreek.com/python/example/97692/dns.resolver.Resolver">.Resolver()</a></li><li><a href="https://www.programcreek.com/python/example/97693/dns.resolver.NoNameservers">.NoNameservers()</a></li><li><a href="https://www.programcreek.com/python/example/97694/dns.resolver.query">.query()</a></li><li><a href="https://www.programcreek.com/python/example/97695/dns.resolver.NXDOMAIN">.NXDOMAIN</a></li><li><a href="https://www.programcreek.com/python/example/97696/dns.resolver.lifetime">.lifetime()</a></li><li><a href="https://www.programcreek.com/python/example/97697/dns.resolver.timeout">.timeout()</a></li><li><a href="https://www.programcreek.com/python/example/123833/dns.resolver.Timeout">.Timeout()</a></li></ul></div></div><div style="height:10px;clear:both"></div><span id="ezoic-pub-ad-placeholder-118"></span><div class="sidebarbox"><div class="sidebarboxheader" id="relatedClass"><b>Related Methods</b></div><div class="sidebarboxbody"><ul><li><a href="https://www.programcreek.com/python/example/2/sys.exit">sys.exit()</a></li><li><a href="https://www.programcreek.com/python/example/3/sys.argv">sys.argv()</a></li><li><a href="https://www.programcreek.com/python/example/6/re.compile">re.compile()</a></li><li><a href="https://www.programcreek.com/python/example/13/time.time">time.time()</a></li><li><a href="https://www.programcreek.com/python/example/21/re.sub">re.sub()</a></li><li><a href="https://www.programcreek.com/python/example/24/time.sleep">time.sleep()</a></li><li><a href="https://www.programcreek.com/python/example/26/re.search">re.search()</a></li><li><a href="https://www.programcreek.com/python/example/30/re.match">re.match()</a></li><li><a href="https://www.programcreek.com/python/example/31/os.remove">os.remove()</a></li><li><a href="https://www.programcreek.com/python/example/40/logging.getLogger">logging.getLogger()</a></li><li><a href="https://www.programcreek.com/python/example/66/random.randint">random.randint()</a></li><li><a href="https://www.programcreek.com/python/example/76/logging.DEBUG">logging.DEBUG</a></li><li><a href="https://www.programcreek.com/python/example/83/datetime.timedelta">datetime.timedelta()</a></li><li><a href="https://www.programcreek.com/python/example/93/json.loads">json.loads()</a></li><li><a href="https://www.programcreek.com/python/example/94/json.dumps">json.dumps()</a></li><li><a href="https://www.programcreek.com/python/example/105/socket.socket">socket.socket()</a></li><li><a href="https://www.programcreek.com/python/example/130/re.findall">re.findall()</a></li><li><a href="https://www.programcreek.com/python/example/748/argparse.ArgumentParser">argparse.ArgumentParser()</a></li><li><a href="https://www.programcreek.com/python/example/3765/requests.get">requests.get()</a></li><li><a href="https://www.programcreek.com/python/example/97691/dns.resolver.nameservers">dns.resolver.nameservers()</a></li></ul></div></div><div style="height:10px;clear:both"></div><div class="sidebarbox"><div class="sidebarboxheader" id="relatedClass"><b>Related Modules</b></div><div class="sidebarboxbody"><ul><li><a href="https://www.programcreek.com/python/index/1/os">os</a></li><li><a href="https://www.programcreek.com/python/index/2/sys">sys</a></li><li><a href="https://www.programcreek.com/python/index/3/re">re</a></li><li><a href="https://www.programcreek.com/python/index/4/time">time</a></li><li><a href="https://www.programcreek.com/python/index/5/logging">logging</a></li><li><a href="https://www.programcreek.com/python/index/6/datetime">datetime</a></li><li><a href="https://www.programcreek.com/python/index/8/random">random</a></li><li><a href="https://www.programcreek.com/python/index/13/socket">socket</a></li><li><a href="https://www.programcreek.com/python/index/15/subprocess">subprocess</a></li><li><a href="https://www.programcreek.com/python/index/25/base64">base64</a></li><li><a href="https://www.programcreek.com/python/index/35/hashlib">hashlib</a></li><li><a href="https://www.programcreek.com/python/index/37/json">json</a></li><li><a href="https://www.programcreek.com/python/index/71/collections">collections</a></li><li><a href="https://www.programcreek.com/python/index/115/argparse">argparse</a></li><li><a href="https://www.programcreek.com/python/index/221/requests">requests</a></li></ul></div></div><span id="ezoic-pub-ad-placeholder-119"></span></div><div id="main"><script ez-screx="true">ezoicSiteSpeed($(document),String(/documentReady/).substring(1).slice(0,-1),String(/jQuery-document-dot-ready/).substring(1).slice(0,-1),function(){$('.vote_up').click(function(){var item_id=$(this).attr("id");$(this).fadeOut();var oldVotes=$('#'.concat(item_id).concat("votes")).text();var newVotes=parseInt(oldVotes)+1;$('#'.concat(item_id).concat("votes")).text(newVotes);$.post('https://www.programcreek.com/python/back.php',{todo:"like",example_id:item_id},function(data){});});$('.vote_down').click(function(){var item_id=$(this).attr("id");$(this).fadeOut();var oldVotes=$('#'.concat(item_id).concat("votes")).text();var newVotes=parseInt(oldVotes)-1;$('#'.concat(item_id).concat("votes")).text(newVotes);$.post('https://www.programcreek.com/python/back.php',{todo:"dislike",example_id:item_id},function(data){});});$('#saveMember').click(function(){var memberId=$(this).attr("memberid");var userId=$(this).attr("userid");if(!userId){alert("Available for registered users only. Sign up first (FREE).");exit();}
$(this).fadeOut();$.post('https://www.programcreek.com/python/back.php',{todo:"saveMember",memberId:memberId,userId:userId},function(data){});});$('.view_source_code').click(function(){alert("Available for registered users only. Sign up first (FREE).");});});</script><h1 class="main-title">Python <span class="title_font">dns.resolver.query()</span>
Examples</h1><div id="index_page_top_text_box">The following are <span style="color:#0586e3"><i>30</i></span>
code examples of <span style="color:#0586e3"><i>dns.resolver.query()</i></span>.
You can vote up the ones you like or vote down the ones you don't like,
and go to the original project or source file by following the links above each example.
You may also want to check out all available functions/classes of the module
<span style="color:#0586e3"><a href="https://www.programcreek.com/python/index/8870/dns.resolver">dns.resolver</a>
</span>, or try <a href="https://www.programcreek.com/python">the search function
<img src="./Python Examples of dns.resolver.query_files/search.png" width="15" ezimgfmt="rs rscb13 src ng ngcb13" class=" ezlazyloaded" data-ezsrc="https://www.programcreek.com/common/static/images/search.png?ezimgfmt=rs:15x15/rscb13/ng:webp/ngcb13" ezoid="0.7149388462230972">
</a>.</div><div style="margin:20px 0;width:100%"></div><div style="height:5px"></div><div style="margin:20px 2px;color:#424345;font-weight:700">Example #1</div><div class="examplebox"><div class="exampleboxheader"><table width="100%"><tbody><tr><td width="80%" style="padding:2px;font-size:14px;line-height:25px">Source Project:
<a href="https://www.programcreek.com/python/?project_name=mhelwig%2Fprivdns"><span style="font-style:italic">privdns</span>&nbsp;&nbsp;</a>
Author: <span style="font-style:italic">mhelwig</span>&nbsp;&nbsp;
File: <a href="https://www.programcreek.com/python?code=mhelwig%2Fprivdns%2Fprivdns-master%2Fprivdns.py">privdns.py </a>&nbsp;&nbsp;
License: <a href="https://www.programcreek.com/python?code=mhelwig%2Fprivdns%2Fprivdns-master%2FLICENSE">GNU Lesser General Public License v3.0</a></td><td width="10%" align="right" style="padding-right:5px;font-size:14px;color:#08c"><span style="color:#08c" id="394684votes">8</span>
votes</td><td width="12%" align="right" style="padding-right:5px;font-size:14px"><span class="vote vote_down click_button" style="float:right;padding-bottom:-2px;border-radius:2px;border:1px solid #d8d8d8" id="394684"><img alt="vote down" src="./Python Examples of dns.resolver.query_files/dislike.png" width="26" ezimgfmt="rs rscb13 src ng ngcb13" class=" ezlazyloaded" data-ezsrc="https://www.programcreek.com/common/static/images/dislike.png?ezimgfmt=rs:26x26/rscb13/ng:webp/ngcb13" ezoid="0.3601649576189736"></span>
<span class="vote vote_up click_button" style="float:left;padding-top:-2px;border-radius:2px;border:1px solid #d8d8d8" id="394684"><img alt="vote up" src="./Python Examples of dns.resolver.query_files/like.png" width="26" ezimgfmt="rs rscb13 src ng ngcb13" class=" ezlazyloaded" data-ezsrc="https://www.programcreek.com/common/static/images/like.png?ezimgfmt=rs:26x26/rscb13/ng:webp/ngcb13" ezoid="0.34383162259623257"></span></td></tr></tbody></table></div><div class="exampleboxbody"><pre class="prettyprint"><span class="kwd"><span class="kwd">def</span></span><span class="pln"><span class="pln"> resolve</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">resolver</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln">ip</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> quiet</span></span><span class="pun"><span class="pun">=</span></span><span class="kwd"><span class="kwd">False</span></span><span class="pun"><span class="pun">):</span></span><span class="pln"><span class="pln">
    </span></span><span class="kwd"><span class="kwd">try</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln">
        answer </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> resolver</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="highlight"><span class="pln">query</span></span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">ip</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">reverse_pointer</span></span><span class="pun"><span class="pun">,</span></span><span class="str"><span class="str">'ptr'</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln">
        </span></span><span class="kwd"><span class="kwd">if</span></span><span class="pln"><span class="pln"> </span></span><span class="kwd"><span class="kwd">not</span></span><span class="pln"><span class="pln"> quiet</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln">
            </span></span><span class="kwd"><span class="kwd">print</span></span><span class="pun"><span class="pun">(</span></span><span class="str"><span class="str">"[+] "</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">+</span></span><span class="pln"><span class="pln"> str</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">ip</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">+</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">" : "</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">+</span></span><span class="pln"><span class="pln"> str</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">answer</span></span><span class="pun"><span class="pun">[</span></span><span class="lit"><span class="lit">0</span></span><span class="pun"><span class="pun">]))</span></span><span class="pln"><span class="pln">
        </span></span><span class="kwd"><span class="kwd">return</span></span><span class="pln"><span class="pln"> </span></span><span class="lit"><span class="lit">1</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> str</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">answer</span></span><span class="pun"><span class="pun">[</span></span><span class="lit"><span class="lit">0</span></span><span class="pun"><span class="pun">])</span></span><span class="pln"><span class="pln">
    </span></span><span class="kwd"><span class="kwd">except</span></span><span class="pln"><span class="pln"> dns</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">resolver</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">NXDOMAIN</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln">
        </span></span><span class="kwd"><span class="kwd">if</span></span><span class="pln"><span class="pln"> </span></span><span class="kwd"><span class="kwd">not</span></span><span class="pln"><span class="pln"> quiet</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln">
            </span></span><span class="kwd"><span class="kwd">print</span></span><span class="pun"><span class="pun">(</span></span><span class="str"><span class="str">"[.] Resolved but no entry for "</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">+</span></span><span class="pln"><span class="pln"> str</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">ip</span></span><span class="pun"><span class="pun">))</span></span><span class="pln"><span class="pln">
        </span></span><span class="kwd"><span class="kwd">return</span></span><span class="pln"><span class="pln"> </span></span><span class="lit"><span class="lit">2</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> </span></span><span class="kwd"><span class="kwd">None</span></span><span class="pln"><span class="pln">
    </span></span><span class="kwd"><span class="kwd">except</span></span><span class="pln"><span class="pln"> dns</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">resolver</span></span><span class="pun"><span class="pun">.</span></span><span class="typ"><span class="typ">NoNameservers</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln">
        </span></span><span class="kwd"><span class="kwd">if</span></span><span class="pln"><span class="pln"> </span></span><span class="kwd"><span class="kwd">not</span></span><span class="pln"><span class="pln"> quiet</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln">
            </span></span><span class="kwd"><span class="kwd">print</span></span><span class="pun"><span class="pun">(</span></span><span class="str"><span class="str">"[-] Answer refused for "</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">+</span></span><span class="pln"><span class="pln"> str</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">ip</span></span><span class="pun"><span class="pun">))</span></span><span class="pln"><span class="pln">
        </span></span><span class="kwd"><span class="kwd">return</span></span><span class="pln"><span class="pln"> </span></span><span class="lit"><span class="lit">3</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> </span></span><span class="kwd"><span class="kwd">None</span></span><span class="pln"><span class="pln">
    </span></span><span class="kwd"><span class="kwd">except</span></span><span class="pln"><span class="pln"> dns</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">resolver</span></span><span class="pun"><span class="pun">.</span></span><span class="typ"><span class="typ">NoAnswer</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln">
        </span></span><span class="kwd"><span class="kwd">if</span></span><span class="pln"><span class="pln"> </span></span><span class="kwd"><span class="kwd">not</span></span><span class="pln"><span class="pln"> quiet</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln">
            </span></span><span class="kwd"><span class="kwd">print</span></span><span class="pun"><span class="pun">(</span></span><span class="str"><span class="str">"[-] No answer section for "</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">+</span></span><span class="pln"><span class="pln"> str</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">ip</span></span><span class="pun"><span class="pun">))</span></span><span class="pln"><span class="pln">
        </span></span><span class="kwd"><span class="kwd">return</span></span><span class="pln"><span class="pln"> </span></span><span class="lit"><span class="lit">4</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> </span></span><span class="kwd"><span class="kwd">None</span></span><span class="pln"><span class="pln">
    </span></span><span class="kwd"><span class="kwd">except</span></span><span class="pln"><span class="pln"> dns</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">exception</span></span><span class="pun"><span class="pun">.</span></span><span class="typ"><span class="typ">Timeout</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln">
        </span></span><span class="kwd"><span class="kwd">if</span></span><span class="pln"><span class="pln"> </span></span><span class="kwd"><span class="kwd">not</span></span><span class="pln"><span class="pln"> quiet</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln">
            </span></span><span class="kwd"><span class="kwd">print</span></span><span class="pun"><span class="pun">(</span></span><span class="str"><span class="str">"[-] Timeout"</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln">
        </span></span><span class="kwd"><span class="kwd">return</span></span><span class="pln"><span class="pln"> </span></span><span class="lit"><span class="lit">5</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> </span></span><span class="kwd"><span class="kwd">None</span></span><span class="pln"><span class="pln">

</span></span><span class="com"><span class="com"># log output to file </span></span></pre></div></div><span id="ezoic-pub-ad-placeholder-120"></span><div style="margin:20px 2px;color:#424345;font-weight:700">Example #2</div><div class="examplebox"><div class="exampleboxheader"><table width="100%"><tbody><tr><td width="80%" style="padding:2px;font-size:14px;line-height:25px">Source Project:
<a href="https://www.programcreek.com/python/?project_name=ValdikSS%2Fblockcheck"><span style="font-style:italic">blockcheck</span>&nbsp;&nbsp;</a>
Author: <span style="font-style:italic">ValdikSS</span>&nbsp;&nbsp;
File: <a href="https://www.programcreek.com/python?code=ValdikSS%2Fblockcheck%2Fblockcheck-master%2Fblockcheck.py">blockcheck.py </a>&nbsp;&nbsp;
License: <a href="https://www.programcreek.com/python?code=ValdikSS%2Fblockcheck%2Fblockcheck-master%2FLICENSE">MIT License</a></td><td width="10%" align="right" style="padding-right:5px;font-size:14px;color:#08c"><span style="color:#08c" id="388017votes">7</span>
votes</td><td width="12%" align="right" style="padding-right:5px;font-size:14px"><span class="vote vote_down click_button" style="float:right;padding-bottom:-2px;border-radius:2px;border:1px solid #d8d8d8" id="388017"><img alt="vote down" src="./Python Examples of dns.resolver.query_files/dislike.png" width="26" ezimgfmt="rs rscb13 src ng ngcb13" class=" ezlazyloaded" data-ezsrc="https://www.programcreek.com/common/static/images/dislike.png?ezimgfmt=rs:26x26/rscb13/ng:webp/ngcb13" ezoid="0.03442657594621479"></span>
<span class="vote vote_up click_button" style="float:left;padding-top:-2px;border-radius:2px;border:1px solid #d8d8d8" id="388017"><img alt="vote up" src="./Python Examples of dns.resolver.query_files/like.png" width="26" ezimgfmt="rs rscb13 src ng ngcb13" class=" ezlazyloaded" data-ezsrc="https://www.programcreek.com/common/static/images/like.png?ezimgfmt=rs:26x26/rscb13/ng:webp/ngcb13" ezoid="0.6603125305253092"></span></td></tr></tbody></table></div><div class="exampleboxbody"><pre class="prettyprint"><span class="kwd"><span class="kwd">def</span></span><span class="pln"><span class="pln"> _get_a_record</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">site</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> querytype</span></span><span class="pun"><span class="pun">=</span></span><span class="str"><span class="str">'A'</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> dnsserver</span></span><span class="pun"><span class="pun">=</span></span><span class="kwd"><span class="kwd">None</span></span><span class="pun"><span class="pun">):</span></span><span class="pln"><span class="pln">
    resolver </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> dns</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">resolver</span></span><span class="pun"><span class="pun">.</span></span><span class="typ"><span class="typ">Resolver</span></span><span class="pun"><span class="pun">()</span></span><span class="pln"><span class="pln">
    resolver</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">timeout </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> </span></span><span class="lit"><span class="lit">5</span></span><span class="pln"><span class="pln">
    resolver</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">lifetime </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> </span></span><span class="lit"><span class="lit">5</span></span><span class="pln"><span class="pln">

    </span></span><span class="kwd"><span class="kwd">if</span></span><span class="pln"><span class="pln"> dnsserver</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln">
        resolver</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">nameservers </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">[</span></span><span class="pln"><span class="pln">dnsserver</span></span><span class="pun"><span class="pun">]</span></span><span class="pln"><span class="pln">

    result </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">[]</span></span><span class="pln"><span class="pln">
    </span></span><span class="kwd"><span class="kwd">while</span></span><span class="pln"><span class="pln"> len</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">resolver</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">nameservers</span></span><span class="pun"><span class="pun">):</span></span><span class="pln"><span class="pln">
        </span></span><span class="kwd"><span class="kwd">try</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln">
            resolved </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> resolver</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="highlight"><span class="pln">query</span></span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">site</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> querytype</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln">
            print_debug</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">str</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">resolved</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">response</span></span><span class="pun"><span class="pun">))</span></span><span class="pln"><span class="pln">
            </span></span><span class="kwd"><span class="kwd">for</span></span><span class="pln"><span class="pln"> item </span></span><span class="kwd"><span class="kwd">in</span></span><span class="pln"><span class="pln"> resolved</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">rrset</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">items</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln">
                result</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">append</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">item</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">to_text</span></span><span class="pun"><span class="pun">())</span></span><span class="pln"><span class="pln">
            </span></span><span class="kwd"><span class="kwd">return</span></span><span class="pln"><span class="pln"> result

        </span></span><span class="kwd"><span class="kwd">except</span></span><span class="pln"><span class="pln"> dns</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">exception</span></span><span class="pun"><span class="pun">.</span></span><span class="typ"><span class="typ">Timeout</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln">
            print_debug</span></span><span class="pun"><span class="pun">(</span></span><span class="str"><span class="str">"DNS Timeout for"</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> site</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">"using"</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> resolver</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">nameservers</span></span><span class="pun"><span class="pun">[</span></span><span class="lit"><span class="lit">0</span></span><span class="pun"><span class="pun">])</span></span><span class="pln"><span class="pln">
            resolver</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">nameservers</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">remove</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">resolver</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">nameservers</span></span><span class="pun"><span class="pun">[</span></span><span class="lit"><span class="lit">0</span></span><span class="pun"><span class="pun">])</span></span><span class="pln"><span class="pln">

    </span></span><span class="com"><span class="com"># If all the requests failed</span></span><span class="pln"><span class="pln">
    </span></span><span class="kwd"><span class="kwd">return</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">""</span></span><span class="pln"><span class="pln"> </span></span></pre></div></div><span id="ezoic-pub-ad-placeholder-169"></span><div style="margin:20px 2px;color:#424345;font-weight:700">Example #3</div><div class="examplebox"><div class="exampleboxheader"><table width="100%"><tbody><tr><td width="80%" style="padding:2px;font-size:14px;line-height:25px">Source Project:
<a href="https://www.programcreek.com/python/?project_name=al0ne%2FVxscan"><span style="font-style:italic">Vxscan</span>&nbsp;&nbsp;</a>
Author: <span style="font-style:italic">al0ne</span>&nbsp;&nbsp;
File: <a href="https://www.programcreek.com/python?code=al0ne%2FVxscan%2FVxscan-master%2Flib%2Furl.py">url.py </a>&nbsp;&nbsp;
License: <a href="https://www.programcreek.com/python?code=al0ne%2FVxscan%2FVxscan-master%2FLICENSE">Apache License 2.0</a></td><td width="10%" align="right" style="padding-right:5px;font-size:14px;color:#08c"><span style="color:#08c" id="38927votes">6</span>
votes</td><td width="12%" align="right" style="padding-right:5px;font-size:14px"><span class="vote vote_down click_button" style="float:right;padding-bottom:-2px;border-radius:2px;border:1px solid #d8d8d8" id="38927"><img alt="vote down" src="./Python Examples of dns.resolver.query_files/dislike.png" width="26" ezimgfmt="rs rscb13 src ng ngcb13" class=" ezlazyloaded" data-ezsrc="https://www.programcreek.com/common/static/images/dislike.png?ezimgfmt=rs:26x26/rscb13/ng:webp/ngcb13" ezoid="0.1343684232742559"></span>
<span class="vote vote_up click_button" style="float:left;padding-top:-2px;border-radius:2px;border:1px solid #d8d8d8" id="38927"><img alt="vote up" src="./Python Examples of dns.resolver.query_files/like.png" width="26" ezimgfmt="rs rscb13 src ng ngcb13" class=" ezlazyloaded" data-ezsrc="https://www.programcreek.com/common/static/images/like.png?ezimgfmt=rs:26x26/rscb13/ng:webp/ngcb13" ezoid="0.8408202934036677"></span></td></tr></tbody></table></div><div class="exampleboxbody"><pre class="prettyprint"><span class="kwd"><span class="kwd">def</span></span><span class="pln"><span class="pln"> parse_ip</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">host</span></span><span class="pun"><span class="pun">):</span></span><span class="pln"><span class="pln">
    host </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> parse_host</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">host</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln">
    </span></span><span class="com"><span class="com"># 根据domain得到ip 例如www.xxx.com 得到 x.x.x.x</span></span><span class="pln"><span class="pln">
    </span></span><span class="kwd"><span class="kwd">try</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln">
        resolver </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> dns</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">resolver</span></span><span class="pun"><span class="pun">.</span></span><span class="typ"><span class="typ">Resolver</span></span><span class="pun"><span class="pun">()</span></span><span class="pln"><span class="pln">
        resolver</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">nameservers </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">[</span></span><span class="str"><span class="str">'1.1.1.1'</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">'8.8.8.8'</span></span><span class="pun"><span class="pun">]</span></span><span class="pln"><span class="pln">
        a </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> resolver</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="highlight"><span class="pln">query</span></span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">host</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">'A'</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln">
        </span></span><span class="kwd"><span class="kwd">for</span></span><span class="pln"><span class="pln"> i </span></span><span class="kwd"><span class="kwd">in</span></span><span class="pln"><span class="pln"> a</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">response</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">answer</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln">
            </span></span><span class="kwd"><span class="kwd">for</span></span><span class="pln"><span class="pln"> j </span></span><span class="kwd"><span class="kwd">in</span></span><span class="pln"><span class="pln"> i</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">items</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln">
                </span></span><span class="kwd"><span class="kwd">if</span></span><span class="pln"><span class="pln"> hasattr</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">j</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">'address'</span></span><span class="pun"><span class="pun">):</span></span><span class="pln"><span class="pln">
                    </span></span><span class="kwd"><span class="kwd">if</span></span><span class="pln"><span class="pln"> </span></span><span class="kwd"><span class="kwd">not</span></span><span class="pln"><span class="pln"> re</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">search</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">r</span></span><span class="str"><span class="str">'1\.1\.1\.1|8\.8\.8\.8|127\.0\.0\.1|114\.114\.114\.114|0\.0\.0\.0'</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> j</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">address</span></span><span class="pun"><span class="pun">):</span></span><span class="pln"><span class="pln">
                        </span></span><span class="kwd"><span class="kwd">return</span></span><span class="pln"><span class="pln"> j</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">address
    </span></span><span class="kwd"><span class="kwd">except</span></span><span class="pln"><span class="pln"> dns</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">resolver</span></span><span class="pun"><span class="pun">.</span></span><span class="typ"><span class="typ">NoAnswer</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln">
        </span></span><span class="kwd"><span class="kwd">pass</span></span><span class="pln"><span class="pln">
    </span></span><span class="kwd"><span class="kwd">except</span></span><span class="pln"><span class="pln"> </span></span><span class="typ"><span class="typ">Exception</span></span><span class="pln"><span class="pln"> </span></span><span class="kwd"><span class="kwd">as</span></span><span class="pln"><span class="pln"> e</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln">
        logging</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">exception</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">e</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln">
    </span></span><span class="kwd"><span class="kwd">return</span></span><span class="pln"><span class="pln"> host </span></span></pre></div></div><span id="ezoic-pub-ad-placeholder-161"></span><div style="margin:20px 2px;color:#424345;font-weight:700">Example #4</div><div class="examplebox"><div class="exampleboxheader"><table width="100%"><tbody><tr><td width="80%" style="padding:2px;font-size:14px;line-height:25px">Source Project:
<a href="https://www.programcreek.com/python/?project_name=FeeiCN%2FESD"><span style="font-style:italic">ESD</span>&nbsp;&nbsp;</a>
Author: <span style="font-style:italic">FeeiCN</span>&nbsp;&nbsp;
File: <a href="https://www.programcreek.com/python?code=FeeiCN%2FESD%2FESD-master%2FESD%2F__init__.py">__init__.py </a>&nbsp;&nbsp;
License: <a href="https://www.programcreek.com/python?code=FeeiCN%2FESD%2FESD-master%2FLICENSE">GNU General Public License v3.0</a></td><td width="10%" align="right" style="padding-right:5px;font-size:14px;color:#08c"><span style="color:#08c" id="195049votes">6</span>
votes</td><td width="12%" align="right" style="padding-right:5px;font-size:14px"><span class="vote vote_down click_button" style="float:right;padding-bottom:-2px;border-radius:2px;border:1px solid #d8d8d8" id="195049"><img alt="vote down" src="./Python Examples of dns.resolver.query_files/dislike.png" width="26" ezimgfmt="rs rscb13 src ng ngcb13" class=" ezlazyloaded" data-ezsrc="https://www.programcreek.com/common/static/images/dislike.png?ezimgfmt=rs:26x26/rscb13/ng:webp/ngcb13" ezoid="0.8993204922365059"></span>
<span class="vote vote_up click_button" style="float:left;padding-top:-2px;border-radius:2px;border:1px solid #d8d8d8" id="195049"><img alt="vote up" src="./Python Examples of dns.resolver.query_files/like.png" width="26" ezimgfmt="rs rscb13 src ng ngcb13" class=" ezlazyloaded" data-ezsrc="https://www.programcreek.com/common/static/images/like.png?ezimgfmt=rs:26x26/rscb13/ng:webp/ngcb13" ezoid="0.8950273786444611"></span></td></tr></tbody></table></div><div class="exampleboxbody"><pre class="prettyprint"><span class="kwd"><span class="kwd">def</span></span><span class="pln"><span class="pln"> transfer_info</span></span><span class="pun"><span class="pun">(</span></span><span class="kwd"><span class="kwd">self</span></span><span class="pun"><span class="pun">):</span></span><span class="pln"><span class="pln">
        ret_zones </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> list</span></span><span class="pun"><span class="pun">()</span></span><span class="pln"><span class="pln">
        </span></span><span class="kwd"><span class="kwd">try</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln">
            nss </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> dns</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">resolver</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="highlight"><span class="pln">query</span></span></span><span class="pun"><span class="pun">(</span></span><span class="kwd"><span class="kwd">self</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">domain</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">'NS'</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln">
            nameservers </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">[</span></span><span class="pln"><span class="pln">str</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">ns</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln"> </span></span><span class="kwd"><span class="kwd">for</span></span><span class="pln"><span class="pln"> ns </span></span><span class="kwd"><span class="kwd">in</span></span><span class="pln"><span class="pln"> nss</span></span><span class="pun"><span class="pun">]</span></span><span class="pln"><span class="pln">
            ns_addr </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> dns</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">resolver</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="highlight"><span class="pln">query</span></span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">nameservers</span></span><span class="pun"><span class="pun">[</span></span><span class="lit"><span class="lit">0</span></span><span class="pun"><span class="pun">],</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">'A'</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln">
            </span></span><span class="com"><span class="com"># dnspython 的 bug，需要设置 lifetime 参数</span></span><span class="pln"><span class="pln">
            zones </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> dns</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">zone</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">from_xfr</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">dns</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="highlight"><span class="pln">query</span></span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">xfr</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">ns_addr</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> </span></span><span class="kwd"><span class="kwd">self</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">domain</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> relativize</span></span><span class="pun"><span class="pun">=</span></span><span class="kwd"><span class="kwd">False</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> timeout</span></span><span class="pun"><span class="pun">=</span></span><span class="lit"><span class="lit">2</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> lifetime</span></span><span class="pun"><span class="pun">=</span></span><span class="lit"><span class="lit">2</span></span><span class="pun"><span class="pun">),</span></span><span class="pln"><span class="pln"> check_origin</span></span><span class="pun"><span class="pun">=</span></span><span class="kwd"><span class="kwd">False</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln">
            names </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> zones</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">nodes</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">keys</span></span><span class="pun"><span class="pun">()</span></span><span class="pln"><span class="pln">
            </span></span><span class="kwd"><span class="kwd">for</span></span><span class="pln"><span class="pln"> n </span></span><span class="kwd"><span class="kwd">in</span></span><span class="pln"><span class="pln"> names</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln">
                subdomain </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">''</span></span><span class="pln"><span class="pln">
                </span></span><span class="kwd"><span class="kwd">for</span></span><span class="pln"><span class="pln"> t </span></span><span class="kwd"><span class="kwd">in</span></span><span class="pln"><span class="pln"> range</span></span><span class="pun"><span class="pun">(</span></span><span class="lit"><span class="lit">0</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> len</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">n</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">-</span></span><span class="pln"><span class="pln"> </span></span><span class="lit"><span class="lit">1</span></span><span class="pun"><span class="pun">):</span></span><span class="pln"><span class="pln">
                    </span></span><span class="kwd"><span class="kwd">if</span></span><span class="pln"><span class="pln"> subdomain </span></span><span class="pun"><span class="pun">!=</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">''</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln">
                        subdomain </span></span><span class="pun"><span class="pun">+=</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">'.'</span></span><span class="pln"><span class="pln">
                    subdomain </span></span><span class="pun"><span class="pun">+=</span></span><span class="pln"><span class="pln"> str</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">n</span></span><span class="pun"><span class="pun">[</span></span><span class="pln"><span class="pln">t</span></span><span class="pun"><span class="pun">].</span></span><span class="pln"><span class="pln">decode</span></span><span class="pun"><span class="pun">())</span></span><span class="pln"><span class="pln">
                </span></span><span class="kwd"><span class="kwd">if</span></span><span class="pln"><span class="pln"> subdomain </span></span><span class="pun"><span class="pun">!=</span></span><span class="pln"><span class="pln"> </span></span><span class="kwd"><span class="kwd">self</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">domain</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln">
                    ret_zones</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">append</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">subdomain</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln">
            </span></span><span class="kwd"><span class="kwd">return</span></span><span class="pln"><span class="pln"> ret_zones
        </span></span><span class="kwd"><span class="kwd">except</span></span><span class="pln"><span class="pln"> </span></span><span class="typ"><span class="typ">BaseException</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln">
            </span></span><span class="kwd"><span class="kwd">return</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">[]</span></span><span class="pln"><span class="pln"> </span></span></pre></div></div><div style="margin:20px 2px;color:#424345;font-weight:700">Example #5</div><div class="examplebox"><div class="exampleboxheader"><table width="100%"><tbody><tr><td width="80%" style="padding:2px;font-size:14px;line-height:25px">Source Project:
<a href="https://www.programcreek.com/python/?project_name=depthsecurity%2Farmory"><span style="font-style:italic">armory</span>&nbsp;&nbsp;</a>
Author: <span style="font-style:italic">depthsecurity</span>&nbsp;&nbsp;
File: <a href="https://www.programcreek.com/python?code=depthsecurity%2Farmory%2Farmory-master%2Farmory%2Fincluded%2Futilities%2Fget_domain_ip.py">get_domain_ip.py </a>&nbsp;&nbsp;
License: <a href="https://www.programcreek.com/python?code=depthsecurity%2Farmory%2Farmory-master%2FLICENSE">GNU General Public License v3.0</a></td><td width="10%" align="right" style="padding-right:5px;font-size:14px;color:#08c"><span style="color:#08c" id="239896votes">6</span>
votes</td><td width="12%" align="right" style="padding-right:5px;font-size:14px"><span class="vote vote_down click_button" style="float:right;padding-bottom:-2px;border-radius:2px;border:1px solid #d8d8d8" id="239896"><img alt="vote down" src="./Python Examples of dns.resolver.query_files/dislike.png" width="26" ezimgfmt="rs rscb13 src ng ngcb13" class=" ezlazyloaded" data-ezsrc="https://www.programcreek.com/common/static/images/dislike.png?ezimgfmt=rs:26x26/rscb13/ng:webp/ngcb13" ezoid="0.11994501624395859"></span>
<span class="vote vote_up click_button" style="float:left;padding-top:-2px;border-radius:2px;border:1px solid #d8d8d8" id="239896"><img alt="vote up" src="./Python Examples of dns.resolver.query_files/like.png" width="26" ezimgfmt="rs rscb13 src ng ngcb13" class=" ezlazyloaded" data-ezsrc="https://www.programcreek.com/common/static/images/like.png?ezimgfmt=rs:26x26/rscb13/ng:webp/ngcb13" ezoid="0.4088252979829119"></span></td></tr></tbody></table></div><div class="exampleboxbody"><pre class="prettyprint"><span class="kwd"><span class="kwd">def</span></span><span class="pln"><span class="pln"> run</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">domain</span></span><span class="pun"><span class="pun">):</span></span><span class="pln"><span class="pln">
    ips </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">[]</span></span><span class="pln"><span class="pln">
    resolver </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> dns</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">resolver</span></span><span class="pun"><span class="pun">.</span></span><span class="typ"><span class="typ">Resolver</span></span><span class="pun"><span class="pun">()</span></span><span class="pln"><span class="pln">
    resolver</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">lifetime </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> resolver</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">timeout </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> </span></span><span class="lit"><span class="lit">5.0</span></span><span class="pln"><span class="pln">

    </span></span><span class="kwd"><span class="kwd">try</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln">
        answers </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> resolver</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="highlight"><span class="pln">query</span></span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">domain</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">"A"</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln">
        </span></span><span class="kwd"><span class="kwd">for</span></span><span class="pln"><span class="pln"> a </span></span><span class="kwd"><span class="kwd">in</span></span><span class="pln"><span class="pln"> answers</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln">
            ips</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">append</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">a</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">address</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln">
        </span></span><span class="kwd"><span class="kwd">return</span></span><span class="pln"><span class="pln"> ips
    </span></span><span class="kwd"><span class="kwd">except</span></span><span class="pln"><span class="pln"> </span></span><span class="typ"><span class="typ">Exception</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln">
        </span></span><span class="com"><span class="com"># print("Regular DNS Not Resolved\n")</span></span><span class="pln"><span class="pln">
    </span></span><span class="com"><span class="com"># Temporarily disabling - seems to cause massive delays at times.</span></span><span class="pln"><span class="pln">

    </span></span><span class="com"><span class="com">#     pass</span></span><span class="pln"><span class="pln">
    </span></span><span class="com"><span class="com"># try:</span></span><span class="pln"><span class="pln">
    </span></span><span class="com"><span class="com">#    ips = [ str(i[4][0]) for i in socket.getaddrinfo(domain, 443) ] </span></span><span class="pln"><span class="pln">
    </span></span><span class="com"><span class="com">#    return ips</span></span><span class="pln"><span class="pln">
    </span></span><span class="com"><span class="com"># except Exception:</span></span><span class="pln"><span class="pln">
    </span></span><span class="com"><span class="com">#    print("Unable to Resolve\n")</span></span><span class="pln"><span class="pln">
       </span></span><span class="kwd"><span class="kwd">return</span></span><span class="pln"><span class="pln"> ips </span></span></pre></div></div><div style="margin:20px 2px;color:#424345;font-weight:700">Example #6</div><div class="examplebox"><div class="exampleboxheader"><table width="100%"><tbody><tr><td width="80%" style="padding:2px;font-size:14px;line-height:25px">Source Project:
<a href="https://www.programcreek.com/python/?project_name=adferrand%2Fdnsrobocert"><span style="font-style:italic">dnsrobocert</span>&nbsp;&nbsp;</a>
Author: <span style="font-style:italic">adferrand</span>&nbsp;&nbsp;
File: <a href="https://www.programcreek.com/python?code=adferrand%2Fdnsrobocert%2Fdnsrobocert-master%2Fsrc%2Fdnsrobocert%2Fcore%2Fhooks.py">hooks.py </a>&nbsp;&nbsp;
License: <a href="https://www.programcreek.com/python?code=adferrand%2Fdnsrobocert%2Fdnsrobocert-master%2FLICENSE">MIT License</a></td><td width="10%" align="right" style="padding-right:5px;font-size:14px;color:#08c"><span style="color:#08c" id="293321votes">6</span>
votes</td><td width="12%" align="right" style="padding-right:5px;font-size:14px"><span class="vote vote_down click_button" style="float:right;padding-bottom:-2px;border-radius:2px;border:1px solid #d8d8d8" id="293321"><img alt="vote down" src="./Python Examples of dns.resolver.query_files/dislike.png" width="26" ezimgfmt="rs rscb13 src ng ngcb13" class=" ezlazyloaded" data-ezsrc="https://www.programcreek.com/common/static/images/dislike.png?ezimgfmt=rs:26x26/rscb13/ng:webp/ngcb13" ezoid="0.35463742038309665"></span>
<span class="vote vote_up click_button" style="float:left;padding-top:-2px;border-radius:2px;border:1px solid #d8d8d8" id="293321"><img alt="vote up" src="./Python Examples of dns.resolver.query_files/like.png" width="26" ezimgfmt="rs rscb13 src ng ngcb13" class=" ezlazyloaded" data-ezsrc="https://www.programcreek.com/common/static/images/like.png?ezimgfmt=rs:26x26/rscb13/ng:webp/ngcb13" ezoid="0.383643487695545"></span></td></tr></tbody></table></div><div class="exampleboxbody"><pre class="prettyprint"><span class="kwd"><span class="kwd">def</span></span><span class="pln"><span class="pln"> _check_one_challenge</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">challenge</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln"> str</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> token</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln"> </span></span><span class="typ"><span class="typ">Optional</span></span><span class="pun"><span class="pun">[</span></span><span class="pln"><span class="pln">str</span></span><span class="pun"><span class="pun">])</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">-&gt;</span></span><span class="pln"><span class="pln"> </span></span><span class="kwd"><span class="kwd">bool</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln">
    </span></span><span class="kwd"><span class="kwd">try</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln">
        answers </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> resolver</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="highlight"><span class="pln">query</span></span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">challenge</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">"TXT"</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln">
    </span></span><span class="kwd"><span class="kwd">except</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">resolver</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">NXDOMAIN</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> resolver</span></span><span class="pun"><span class="pun">.</span></span><span class="typ"><span class="typ">NoAnswer</span></span><span class="pun"><span class="pun">):</span></span><span class="pln"><span class="pln">
        </span></span><span class="kwd"><span class="kwd">print</span></span><span class="pun"><span class="pun">(</span></span><span class="str"><span class="str">"TXT {0} does not exist."</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">format</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">challenge</span></span><span class="pun"><span class="pun">))</span></span><span class="pln"><span class="pln">
        </span></span><span class="kwd"><span class="kwd">return</span></span><span class="pln"><span class="pln"> </span></span><span class="kwd"><span class="kwd">False</span></span><span class="pln"><span class="pln">
    </span></span><span class="kwd"><span class="kwd">else</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln">
        </span></span><span class="kwd"><span class="kwd">print</span></span><span class="pun"><span class="pun">(</span></span><span class="str"><span class="str">"TXT {0} exists."</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">format</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">challenge</span></span><span class="pun"><span class="pun">))</span></span><span class="pln"><span class="pln">

    </span></span><span class="kwd"><span class="kwd">if</span></span><span class="pln"><span class="pln"> token</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln">
        validation_answers </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">[</span></span><span class="pln"><span class="pln">
            rdata
            </span></span><span class="kwd"><span class="kwd">for</span></span><span class="pln"><span class="pln"> rdata </span></span><span class="kwd"><span class="kwd">in</span></span><span class="pln"><span class="pln"> answers
            </span></span><span class="kwd"><span class="kwd">for</span></span><span class="pln"><span class="pln"> txt_string </span></span><span class="kwd"><span class="kwd">in</span></span><span class="pln"><span class="pln"> rdata</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">strings
            </span></span><span class="kwd"><span class="kwd">if</span></span><span class="pln"><span class="pln"> txt_string</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">decode</span></span><span class="pun"><span class="pun">(</span></span><span class="str"><span class="str">"utf-8"</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">==</span></span><span class="pln"><span class="pln"> token
        </span></span><span class="pun"><span class="pun">]</span></span><span class="pln"><span class="pln">

        </span></span><span class="kwd"><span class="kwd">if</span></span><span class="pln"><span class="pln"> </span></span><span class="kwd"><span class="kwd">not</span></span><span class="pln"><span class="pln"> validation_answers</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln">
            </span></span><span class="kwd"><span class="kwd">print</span></span><span class="pun"><span class="pun">(</span></span><span class="str"><span class="str">"TXT {0} does not have the expected token value."</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">format</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">challenge</span></span><span class="pun"><span class="pun">))</span></span><span class="pln"><span class="pln">
            </span></span><span class="kwd"><span class="kwd">return</span></span><span class="pln"><span class="pln"> </span></span><span class="kwd"><span class="kwd">False</span></span><span class="pln"><span class="pln">

        </span></span><span class="kwd"><span class="kwd">print</span></span><span class="pun"><span class="pun">(</span></span><span class="str"><span class="str">"TXT {0} has the expected token value."</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln">

    </span></span><span class="kwd"><span class="kwd">return</span></span><span class="pln"><span class="pln"> </span></span><span class="kwd"><span class="kwd">True</span></span><span class="pln"><span class="pln"> </span></span></pre></div></div><span id="ezoic-pub-ad-placeholder-160"></span><div style="margin:20px 2px;color:#424345;font-weight:700">Example #7</div><div class="examplebox"><div class="exampleboxheader"><table width="100%"><tbody><tr><td width="80%" style="padding:2px;font-size:14px;line-height:25px">Source Project:
<a href="https://www.programcreek.com/python/?project_name=mschwager%2Ffierce"><span style="font-style:italic">fierce</span>&nbsp;&nbsp;</a>
Author: <span style="font-style:italic">mschwager</span>&nbsp;&nbsp;
File: <a href="https://www.programcreek.com/python?code=mschwager%2Ffierce%2Ffierce-master%2Ffierce%2Ffierce.py">fierce.py </a>&nbsp;&nbsp;
License: <a href="https://www.programcreek.com/python?code=mschwager%2Ffierce%2Ffierce-master%2FLICENSE">GNU General Public License v3.0</a></td><td width="10%" align="right" style="padding-right:5px;font-size:14px;color:#08c"><span style="color:#08c" id="321789votes">6</span>
votes</td><td width="12%" align="right" style="padding-right:5px;font-size:14px"><span class="vote vote_down click_button" style="float:right;padding-bottom:-2px;border-radius:2px;border:1px solid #d8d8d8" id="321789"><img alt="vote down" src="data:image/svg+xml,%3Csvg%20xmlns=%22http://www.w3.org/2000/svg%22%20width=%2248%22%20height=%2248%22%3E%3C/svg%3E" width="26" ezimgfmt="rs rscb13 src ng ngcb13" class="ezlazyload" data-ezsrc="https://www.programcreek.com/common/static/images/dislike.png"></span>
<span class="vote vote_up click_button" style="float:left;padding-top:-2px;border-radius:2px;border:1px solid #d8d8d8" id="321789"><img alt="vote up" src="data:image/svg+xml,%3Csvg%20xmlns=%22http://www.w3.org/2000/svg%22%20width=%2248%22%20height=%2248%22%3E%3C/svg%3E" width="26" ezimgfmt="rs rscb13 src ng ngcb13" class="ezlazyload" data-ezsrc="https://www.programcreek.com/common/static/images/like.png"></span></td></tr></tbody></table></div><div class="exampleboxbody"><pre class="prettyprint"><span class="kwd"><span class="kwd">def</span></span><span class="pln"><span class="pln"> </span><span class="highlight"><span class="pln">query</span></span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">resolver</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> domain</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> record_type</span></span><span class="pun"><span class="pun">=</span></span><span class="str"><span class="str">'A'</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> tcp</span></span><span class="pun"><span class="pun">=</span></span><span class="kwd"><span class="kwd">False</span></span><span class="pun"><span class="pun">):</span></span><span class="pln"><span class="pln">
    </span></span><span class="kwd"><span class="kwd">try</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln">
        resp </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> resolver</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="highlight"><span class="pln">query</span></span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">domain</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> record_type</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> raise_on_no_answer</span></span><span class="pun"><span class="pun">=</span></span><span class="kwd"><span class="kwd">False</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> tcp</span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln">tcp</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln">
        </span></span><span class="kwd"><span class="kwd">if</span></span><span class="pln"><span class="pln"> resp</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">response</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">answer</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln">
            </span></span><span class="kwd"><span class="kwd">return</span></span><span class="pln"><span class="pln"> resp

        </span></span><span class="com"><span class="com"># If we don't receive an answer from our current resolver let's</span></span><span class="pln"><span class="pln">
        </span></span><span class="com"><span class="com"># assume we received information on nameservers we can use and</span></span><span class="pln"><span class="pln">
        </span></span><span class="com"><span class="com"># perform the same </span><span class="highlight"><span class="com">query</span></span><span class="com"> with those nameservers</span></span><span class="pln"><span class="pln">
        </span></span><span class="kwd"><span class="kwd">if</span></span><span class="pln"><span class="pln"> resp</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">response</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">additional </span></span><span class="kwd"><span class="kwd">and</span></span><span class="pln"><span class="pln"> resp</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">response</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">authority</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln">
            ns </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">[</span></span><span class="pln"><span class="pln">
                rdata</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">address
                </span></span><span class="kwd"><span class="kwd">for</span></span><span class="pln"><span class="pln"> additionals </span></span><span class="kwd"><span class="kwd">in</span></span><span class="pln"><span class="pln"> resp</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">response</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">additional
                </span></span><span class="kwd"><span class="kwd">for</span></span><span class="pln"><span class="pln"> rdata </span></span><span class="kwd"><span class="kwd">in</span></span><span class="pln"><span class="pln"> additionals</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">items
            </span></span><span class="pun"><span class="pun">]</span></span><span class="pln"><span class="pln">
            resolver</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">nameservers </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> ns
            </span></span><span class="kwd"><span class="kwd">return</span></span><span class="pln"><span class="pln"> </span><span class="highlight"><span class="pln">query</span></span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">resolver</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> domain</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> record_type</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> tcp</span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln">tcp</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln">

        </span></span><span class="kwd"><span class="kwd">return</span></span><span class="pln"><span class="pln"> </span></span><span class="kwd"><span class="kwd">None</span></span><span class="pln"><span class="pln">
    </span></span><span class="kwd"><span class="kwd">except</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">dns</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">resolver</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">NXDOMAIN</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> dns</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">resolver</span></span><span class="pun"><span class="pun">.</span></span><span class="typ"><span class="typ">NoNameservers</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> dns</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">exception</span></span><span class="pun"><span class="pun">.</span></span><span class="typ"><span class="typ">Timeout</span></span><span class="pun"><span class="pun">):</span></span><span class="pln"><span class="pln">
        </span></span><span class="kwd"><span class="kwd">return</span></span><span class="pln"><span class="pln"> </span></span><span class="kwd"><span class="kwd">None</span></span><span class="pln"><span class="pln"> </span></span></pre></div></div><div style="margin:20px 2px;color:#424345;font-weight:700">Example #8</div><div class="examplebox"><div class="exampleboxheader"><table width="100%"><tbody><tr><td width="80%" style="padding:2px;font-size:14px;line-height:25px">Source Project:
<a href="https://www.programcreek.com/python/?project_name=shmilylty%2FOneForAll"><span style="font-style:italic">OneForAll</span>&nbsp;&nbsp;</a>
Author: <span style="font-style:italic">shmilylty</span>&nbsp;&nbsp;
File: <a href="https://www.programcreek.com/python?code=shmilylty%2FOneForAll%2FOneForAll-master%2Fmodules%2Fcheck%2Faxfr.py">axfr.py </a>&nbsp;&nbsp;
License: <a href="https://www.programcreek.com/python?code=shmilylty%2FOneForAll%2FOneForAll-master%2FLICENSE">GNU General Public License v3.0</a></td><td width="10%" align="right" style="padding-right:5px;font-size:14px;color:#08c"><span style="color:#08c" id="392425votes">6</span>
votes</td><td width="12%" align="right" style="padding-right:5px;font-size:14px"><span class="vote vote_down click_button" style="float:right;padding-bottom:-2px;border-radius:2px;border:1px solid #d8d8d8" id="392425"><img alt="vote down" src="data:image/svg+xml,%3Csvg%20xmlns=%22http://www.w3.org/2000/svg%22%20width=%2248%22%20height=%2248%22%3E%3C/svg%3E" width="26" ezimgfmt="rs rscb13 src ng ngcb13" class="ezlazyload" data-ezsrc="https://www.programcreek.com/common/static/images/dislike.png"></span>
<span class="vote vote_up click_button" style="float:left;padding-top:-2px;border-radius:2px;border:1px solid #d8d8d8" id="392425"><img alt="vote up" src="data:image/svg+xml,%3Csvg%20xmlns=%22http://www.w3.org/2000/svg%22%20width=%2248%22%20height=%2248%22%3E%3C/svg%3E" width="26" ezimgfmt="rs rscb13 src ng ngcb13" class="ezlazyload" data-ezsrc="https://www.programcreek.com/common/static/images/like.png"></span></td></tr></tbody></table></div><div class="exampleboxbody"><pre class="prettyprint"><span class="kwd"><span class="kwd">def</span></span><span class="pln"><span class="pln"> check</span></span><span class="pun"><span class="pun">(</span></span><span class="kwd"><span class="kwd">self</span></span><span class="pun"><span class="pun">):</span></span><span class="pln"><span class="pln">
        </span></span><span class="str"><span class="str">"""
        check
        """</span></span><span class="pln"><span class="pln">
        resolver </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> utils</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">dns_resolver</span></span><span class="pun"><span class="pun">()</span></span><span class="pln"><span class="pln">
        </span></span><span class="kwd"><span class="kwd">try</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln">
            answers </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> resolver</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="highlight"><span class="pln">query</span></span></span><span class="pun"><span class="pun">(</span></span><span class="kwd"><span class="kwd">self</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">domain</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">"NS"</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln">
        </span></span><span class="kwd"><span class="kwd">except</span></span><span class="pln"><span class="pln"> </span></span><span class="typ"><span class="typ">Exception</span></span><span class="pln"><span class="pln"> </span></span><span class="kwd"><span class="kwd">as</span></span><span class="pln"><span class="pln"> e</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln">
            logger</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">log</span></span><span class="pun"><span class="pun">(</span></span><span class="str"><span class="str">'ERROR'</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> e</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">args</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln">
            </span></span><span class="kwd"><span class="kwd">return</span></span><span class="pln"><span class="pln">
        nsservers </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">[</span></span><span class="pln"><span class="pln">str</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">answer</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln"> </span></span><span class="kwd"><span class="kwd">for</span></span><span class="pln"><span class="pln"> answer </span></span><span class="kwd"><span class="kwd">in</span></span><span class="pln"><span class="pln"> answers</span></span><span class="pun"><span class="pun">]</span></span><span class="pln"><span class="pln">
        </span></span><span class="kwd"><span class="kwd">if</span></span><span class="pln"><span class="pln"> </span></span><span class="kwd"><span class="kwd">not</span></span><span class="pln"><span class="pln"> len</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">nsservers</span></span><span class="pun"><span class="pun">):</span></span><span class="pln"><span class="pln">
            logger</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">log</span></span><span class="pun"><span class="pun">(</span></span><span class="str"><span class="str">'ALERT'</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> f</span></span><span class="str"><span class="str">'No name server record found for {self.domain}'</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln">
            </span></span><span class="kwd"><span class="kwd">return</span></span><span class="pln"><span class="pln">
        </span></span><span class="kwd"><span class="kwd">for</span></span><span class="pln"><span class="pln"> nsserver </span></span><span class="kwd"><span class="kwd">in</span></span><span class="pln"><span class="pln"> nsservers</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln">
            </span></span><span class="kwd"><span class="kwd">self</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">axfr</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">nsserver</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln"> </span></span></pre></div></div><span id="ezoic-pub-ad-placeholder-159"></span><div style="margin:20px 2px;color:#424345;font-weight:700">Example #9</div><div class="examplebox"><div class="exampleboxheader"><table width="100%"><tbody><tr><td width="80%" style="padding:2px;font-size:14px;line-height:25px">Source Project:
<a href="https://www.programcreek.com/python/?project_name=domainaware%2Fparsedmarc"><span style="font-style:italic">parsedmarc</span>&nbsp;&nbsp;</a>
Author: <span style="font-style:italic">domainaware</span>&nbsp;&nbsp;
File: <a href="https://www.programcreek.com/python?code=domainaware%2Fparsedmarc%2Fparsedmarc-master%2Fparsedmarc%2Futils.py">utils.py </a>&nbsp;&nbsp;
License: <a href="https://www.programcreek.com/python?code=domainaware%2Fparsedmarc%2Fparsedmarc-master%2FLICENSE">Apache License 2.0</a></td><td width="10%" align="right" style="padding-right:5px;font-size:14px;color:#08c"><span style="color:#08c" id="409405votes">6</span>
votes</td><td width="12%" align="right" style="padding-right:5px;font-size:14px"><span class="vote vote_down click_button" style="float:right;padding-bottom:-2px;border-radius:2px;border:1px solid #d8d8d8" id="409405"><img alt="vote down" src="data:image/svg+xml,%3Csvg%20xmlns=%22http://www.w3.org/2000/svg%22%20width=%2248%22%20height=%2248%22%3E%3C/svg%3E" width="26" ezimgfmt="rs rscb13 src ng ngcb13" class="ezlazyload" data-ezsrc="https://www.programcreek.com/common/static/images/dislike.png"></span>
<span class="vote vote_up click_button" style="float:left;padding-top:-2px;border-radius:2px;border:1px solid #d8d8d8" id="409405"><img alt="vote up" src="data:image/svg+xml,%3Csvg%20xmlns=%22http://www.w3.org/2000/svg%22%20width=%2248%22%20height=%2248%22%3E%3C/svg%3E" width="26" ezimgfmt="rs rscb13 src ng ngcb13" class="ezlazyload" data-ezsrc="https://www.programcreek.com/common/static/images/like.png"></span></td></tr></tbody></table></div><div class="exampleboxbody"><pre class="prettyprint"><span class="kwd"><span class="kwd">def</span></span><span class="pln"><span class="pln"> get_reverse_dns</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">ip_address</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> cache</span></span><span class="pun"><span class="pun">=</span></span><span class="kwd"><span class="kwd">None</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> nameservers</span></span><span class="pun"><span class="pun">=</span></span><span class="kwd"><span class="kwd">None</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> timeout</span></span><span class="pun"><span class="pun">=</span></span><span class="lit"><span class="lit">2.0</span></span><span class="pun"><span class="pun">):</span></span><span class="pln"><span class="pln">
    </span></span><span class="str"><span class="str">"""
    Resolves an IP address to a hostname using a reverse DNS </span><span class="highlight"><span class="str">query</span></span><span class="str">

    Args:
        ip_address (str): The IP address to resolve
        cache (ExpiringDict): Cache storage
        nameservers (list): A list of one or more nameservers to use
        (Cloudflare's public DNS resolvers by default)
        timeout (float): Sets the DNS </span><span class="highlight"><span class="str">query</span></span><span class="str"> timeout in seconds

    Returns:
        str: The reverse DNS hostname (if any)
    """</span></span><span class="pln"><span class="pln">
    hostname </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> </span></span><span class="kwd"><span class="kwd">None</span></span><span class="pln"><span class="pln">
    </span></span><span class="kwd"><span class="kwd">try</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln">
        address </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> dns</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">reversename</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">from_address</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">ip_address</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln">
        hostname </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> query_dns</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">address</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">"PTR"</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> cache</span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln">cache</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln">
                             nameservers</span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln">nameservers</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln">
                             timeout</span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln">timeout</span></span><span class="pun"><span class="pun">)[</span></span><span class="lit"><span class="lit">0</span></span><span class="pun"><span class="pun">]</span></span><span class="pln"><span class="pln">

    </span></span><span class="kwd"><span class="kwd">except</span></span><span class="pln"><span class="pln"> dns</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">exception</span></span><span class="pun"><span class="pun">.</span></span><span class="typ"><span class="typ">DNSException</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln">
        </span></span><span class="kwd"><span class="kwd">pass</span></span><span class="pln"><span class="pln">

    </span></span><span class="kwd"><span class="kwd">return</span></span><span class="pln"><span class="pln"> hostname </span></span></pre></div></div><div style="margin:20px 2px;color:#424345;font-weight:700">Example #10</div><div class="examplebox"><div class="exampleboxheader"><table width="100%"><tbody><tr><td width="80%" style="padding:2px;font-size:14px;line-height:25px">Source Project:
<a href="https://www.programcreek.com/python/?project_name=lanmaster53%2Frecon-ng-marketplace"><span style="font-style:italic">recon-ng-marketplace</span>&nbsp;&nbsp;</a>
Author: <span style="font-style:italic">lanmaster53</span>&nbsp;&nbsp;
File: <a href="https://www.programcreek.com/python?code=lanmaster53%2Frecon-ng-marketplace%2Frecon-ng-marketplace-master%2Fmodules%2Frecon%2Fhosts-hosts%2Freverse_resolve.py">reverse_resolve.py </a>&nbsp;&nbsp;
License: <a href="https://www.programcreek.com/python?code=lanmaster53%2Frecon-ng-marketplace%2Frecon-ng-marketplace-master%2FLICENSE">GNU General Public License v3.0</a></td><td width="10%" align="right" style="padding-right:5px;font-size:14px;color:#08c"><span style="color:#08c" id="422305votes">6</span>
votes</td><td width="12%" align="right" style="padding-right:5px;font-size:14px"><span class="vote vote_down click_button" style="float:right;padding-bottom:-2px;border-radius:2px;border:1px solid #d8d8d8" id="422305"><img alt="vote down" src="data:image/svg+xml,%3Csvg%20xmlns=%22http://www.w3.org/2000/svg%22%20width=%2248%22%20height=%2248%22%3E%3C/svg%3E" width="26" ezimgfmt="rs rscb13 src ng ngcb13" class="ezlazyload" data-ezsrc="https://www.programcreek.com/common/static/images/dislike.png"></span>
<span class="vote vote_up click_button" style="float:left;padding-top:-2px;border-radius:2px;border:1px solid #d8d8d8" id="422305"><img alt="vote up" src="data:image/svg+xml,%3Csvg%20xmlns=%22http://www.w3.org/2000/svg%22%20width=%2248%22%20height=%2248%22%3E%3C/svg%3E" width="26" ezimgfmt="rs rscb13 src ng ngcb13" class="ezlazyload" data-ezsrc="https://www.programcreek.com/common/static/images/like.png"></span></td></tr></tbody></table></div><div class="exampleboxbody"><pre class="prettyprint"><span class="kwd"><span class="kwd">def</span></span><span class="pln"><span class="pln"> module_run</span></span><span class="pun"><span class="pun">(</span></span><span class="kwd"><span class="kwd">self</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> addresses</span></span><span class="pun"><span class="pun">):</span></span><span class="pln"><span class="pln">
        max_attempts </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> </span></span><span class="lit"><span class="lit">3</span></span><span class="pln"><span class="pln">
        resolver </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> </span></span><span class="kwd"><span class="kwd">self</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">get_resolver</span></span><span class="pun"><span class="pun">()</span></span><span class="pln"><span class="pln">
        </span></span><span class="kwd"><span class="kwd">for</span></span><span class="pln"><span class="pln"> address </span></span><span class="kwd"><span class="kwd">in</span></span><span class="pln"><span class="pln"> addresses</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln">
            attempt </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> </span></span><span class="lit"><span class="lit">0</span></span><span class="pln"><span class="pln">
            </span></span><span class="kwd"><span class="kwd">while</span></span><span class="pln"><span class="pln"> attempt </span></span><span class="pun"><span class="pun">&lt;</span></span><span class="pln"><span class="pln"> max_attempts</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln">
                </span></span><span class="kwd"><span class="kwd">try</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln">
                    addr </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> dns</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">reversename</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">from_address</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">address</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln">
                    hosts </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> resolver</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="highlight"><span class="pln">query</span></span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">addr</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">'PTR'</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln">
                </span></span><span class="kwd"><span class="kwd">except</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">dns</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">resolver</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">NXDOMAIN</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> dns</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">resolver</span></span><span class="pun"><span class="pun">.</span></span><span class="typ"><span class="typ">NoAnswer</span></span><span class="pun"><span class="pun">):</span></span><span class="pln"><span class="pln">
                    </span></span><span class="kwd"><span class="kwd">self</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">verbose</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">f</span></span><span class="str"><span class="str">"{address} =&gt; No record found."</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln">
                </span></span><span class="kwd"><span class="kwd">except</span></span><span class="pln"><span class="pln"> dns</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">resolver</span></span><span class="pun"><span class="pun">.</span></span><span class="typ"><span class="typ">Timeout</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln">
                    </span></span><span class="kwd"><span class="kwd">self</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">verbose</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">f</span></span><span class="str"><span class="str">"{address} =&gt; Request timed out."</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln">
                    attempt </span></span><span class="pun"><span class="pun">+=</span></span><span class="pln"><span class="pln"> </span></span><span class="lit"><span class="lit">1</span></span><span class="pln"><span class="pln">
                    </span></span><span class="kwd"><span class="kwd">continue</span></span><span class="pln"><span class="pln">
                </span></span><span class="kwd"><span class="kwd">except</span></span><span class="pln"><span class="pln"> dns</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">resolver</span></span><span class="pun"><span class="pun">.</span></span><span class="typ"><span class="typ">NoNameservers</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln">
                    </span></span><span class="kwd"><span class="kwd">self</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">verbose</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">f</span></span><span class="str"><span class="str">"{address} =&gt; Invalid nameserver."</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln">
                    </span></span><span class="com"><span class="com">#self.error('Invalid nameserver.')</span></span><span class="pln"><span class="pln">
                    </span></span><span class="com"><span class="com">#return</span></span><span class="pln"><span class="pln">
                </span></span><span class="kwd"><span class="kwd">else</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln">
                    </span></span><span class="kwd"><span class="kwd">for</span></span><span class="pln"><span class="pln"> host </span></span><span class="kwd"><span class="kwd">in</span></span><span class="pln"><span class="pln"> hosts</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln">
                        host </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> str</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">host</span></span><span class="pun"><span class="pun">)[:-</span></span><span class="lit"><span class="lit">1</span></span><span class="pun"><span class="pun">]</span></span><span class="pln"><span class="pln"> </span></span><span class="com"><span class="com"># slice the trailing dot</span></span><span class="pln"><span class="pln">
                        </span></span><span class="kwd"><span class="kwd">self</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">insert_hosts</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">host</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> address</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln">
                </span></span><span class="com"><span class="com"># break out of the loop</span></span><span class="pln"><span class="pln">
                attempt </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> max_attempts </span></span></pre></div></div><span id="ezoic-pub-ad-placeholder-162"></span><div style="margin:20px 2px;color:#424345;font-weight:700">Example #11</div><div class="examplebox"><div class="exampleboxheader"><table width="100%"><tbody><tr><td width="80%" style="padding:2px;font-size:14px;line-height:25px">Source Project:
<a href="https://www.programcreek.com/python/?project_name=lanmaster53%2Frecon-ng-marketplace"><span style="font-style:italic">recon-ng-marketplace</span>&nbsp;&nbsp;</a>
Author: <span style="font-style:italic">lanmaster53</span>&nbsp;&nbsp;
File: <a href="https://www.programcreek.com/python?code=lanmaster53%2Frecon-ng-marketplace%2Frecon-ng-marketplace-master%2Fmodules%2Frecon%2Fdomains-hosts%2Fbrute_hosts.py">brute_hosts.py </a>&nbsp;&nbsp;
License: <a href="https://www.programcreek.com/python?code=lanmaster53%2Frecon-ng-marketplace%2Frecon-ng-marketplace-master%2FLICENSE">GNU General Public License v3.0</a></td><td width="10%" align="right" style="padding-right:5px;font-size:14px;color:#08c"><span style="color:#08c" id="422310votes">6</span>
votes</td><td width="12%" align="right" style="padding-right:5px;font-size:14px"><span class="vote vote_down click_button" style="float:right;padding-bottom:-2px;border-radius:2px;border:1px solid #d8d8d8" id="422310"><img alt="vote down" src="data:image/svg+xml,%3Csvg%20xmlns=%22http://www.w3.org/2000/svg%22%20width=%2248%22%20height=%2248%22%3E%3C/svg%3E" width="26" ezimgfmt="rs rscb13 src ng ngcb13" class="ezlazyload" data-ezsrc="https://www.programcreek.com/common/static/images/dislike.png"></span>
<span class="vote vote_up click_button" style="float:left;padding-top:-2px;border-radius:2px;border:1px solid #d8d8d8" id="422310"><img alt="vote up" src="data:image/svg+xml,%3Csvg%20xmlns=%22http://www.w3.org/2000/svg%22%20width=%2248%22%20height=%2248%22%3E%3C/svg%3E" width="26" ezimgfmt="rs rscb13 src ng ngcb13" class="ezlazyload" data-ezsrc="https://www.programcreek.com/common/static/images/like.png"></span></td></tr></tbody></table></div><div class="exampleboxbody"><pre class="prettyprint"><span class="kwd"><span class="kwd">def</span></span><span class="pln"><span class="pln"> module_run</span></span><span class="pun"><span class="pun">(</span></span><span class="kwd"><span class="kwd">self</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> domains</span></span><span class="pun"><span class="pun">):</span></span><span class="pln"><span class="pln">
        </span></span><span class="kwd"><span class="kwd">with</span></span><span class="pln"><span class="pln"> open</span></span><span class="pun"><span class="pun">(</span></span><span class="kwd"><span class="kwd">self</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">options</span></span><span class="pun"><span class="pun">[</span></span><span class="str"><span class="str">'wordlist'</span></span><span class="pun"><span class="pun">])</span></span><span class="pln"><span class="pln"> </span></span><span class="kwd"><span class="kwd">as</span></span><span class="pln"><span class="pln"> fp</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln">
            words </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> fp</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">read</span></span><span class="pun"><span class="pun">().</span></span><span class="pln"><span class="pln">split</span></span><span class="pun"><span class="pun">()</span></span><span class="pln"><span class="pln">
        resolver </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> </span></span><span class="kwd"><span class="kwd">self</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">get_resolver</span></span><span class="pun"><span class="pun">()</span></span><span class="pln"><span class="pln">
        </span></span><span class="kwd"><span class="kwd">for</span></span><span class="pln"><span class="pln"> domain </span></span><span class="kwd"><span class="kwd">in</span></span><span class="pln"><span class="pln"> domains</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln">
            </span></span><span class="kwd"><span class="kwd">self</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">heading</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">domain</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> level</span></span><span class="pun"><span class="pun">=</span></span><span class="lit"><span class="lit">0</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln">
            wildcard </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> </span></span><span class="kwd"><span class="kwd">None</span></span><span class="pln"><span class="pln">
            </span></span><span class="kwd"><span class="kwd">try</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln">
                answers </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> resolver</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="highlight"><span class="pln">query</span></span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">f</span></span><span class="str"><span class="str">"*.{domain}"</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln">
                wildcard </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> answers</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">response</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">answer</span></span><span class="pun"><span class="pun">[</span></span><span class="lit"><span class="lit">0</span></span><span class="pun"><span class="pun">][</span></span><span class="lit"><span class="lit">0</span></span><span class="pun"><span class="pun">]</span></span><span class="pln"><span class="pln">
                </span></span><span class="kwd"><span class="kwd">self</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">output</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">f</span></span><span class="str"><span class="str">"Wildcard DNS entry found for '{domain}' at '{wildcard}'."</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln">
            </span></span><span class="kwd"><span class="kwd">except</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">dns</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">resolver</span></span><span class="pun"><span class="pun">.</span></span><span class="typ"><span class="typ">NoNameservers</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> dns</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">resolver</span></span><span class="pun"><span class="pun">.</span></span><span class="typ"><span class="typ">Timeout</span></span><span class="pun"><span class="pun">):</span></span><span class="pln"><span class="pln">
                </span></span><span class="kwd"><span class="kwd">self</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">error</span></span><span class="pun"><span class="pun">(</span></span><span class="str"><span class="str">'Invalid nameserver.'</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln">
                </span></span><span class="kwd"><span class="kwd">continue</span></span><span class="pln"><span class="pln">
            </span></span><span class="kwd"><span class="kwd">except</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">dns</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">resolver</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">NXDOMAIN</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> dns</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">resolver</span></span><span class="pun"><span class="pun">.</span></span><span class="typ"><span class="typ">NoAnswer</span></span><span class="pun"><span class="pun">):</span></span><span class="pln"><span class="pln">
                </span></span><span class="kwd"><span class="kwd">self</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">verbose</span></span><span class="pun"><span class="pun">(</span></span><span class="str"><span class="str">'No Wildcard DNS entry found.'</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln">
            </span></span><span class="kwd"><span class="kwd">self</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">thread</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">words</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> domain</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> resolver</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> wildcard</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln"> </span></span></pre></div></div><div style="margin:20px 2px;color:#424345;font-weight:700">Example #12</div><div class="examplebox"><div class="exampleboxheader"><table width="100%"><tbody><tr><td width="80%" style="padding:2px;font-size:14px;line-height:25px">Source Project:
<a href="https://www.programcreek.com/python/?project_name=ecederstrand%2Fexchangelib"><span style="font-style:italic">exchangelib</span>&nbsp;&nbsp;</a>
Author: <span style="font-style:italic">ecederstrand</span>&nbsp;&nbsp;
File: <a href="https://www.programcreek.com/python?code=ecederstrand%2Fexchangelib%2Fexchangelib-master%2Fexchangelib%2Futil.py">util.py </a>&nbsp;&nbsp;
License: <a href="https://www.programcreek.com/python?code=ecederstrand%2Fexchangelib%2Fexchangelib-master%2FLICENSE">BSD 2-Clause "Simplified" License</a></td><td width="10%" align="right" style="padding-right:5px;font-size:14px;color:#08c"><span style="color:#08c" id="467066votes">6</span>
votes</td><td width="12%" align="right" style="padding-right:5px;font-size:14px"><span class="vote vote_down click_button" style="float:right;padding-bottom:-2px;border-radius:2px;border:1px solid #d8d8d8" id="467066"><img alt="vote down" src="data:image/svg+xml,%3Csvg%20xmlns=%22http://www.w3.org/2000/svg%22%20width=%2248%22%20height=%2248%22%3E%3C/svg%3E" width="26" ezimgfmt="rs rscb13 src ng ngcb13" class="ezlazyload" data-ezsrc="https://www.programcreek.com/common/static/images/dislike.png"></span>
<span class="vote vote_up click_button" style="float:left;padding-top:-2px;border-radius:2px;border:1px solid #d8d8d8" id="467066"><img alt="vote up" src="data:image/svg+xml,%3Csvg%20xmlns=%22http://www.w3.org/2000/svg%22%20width=%2248%22%20height=%2248%22%3E%3C/svg%3E" width="26" ezimgfmt="rs rscb13 src ng ngcb13" class="ezlazyload" data-ezsrc="https://www.programcreek.com/common/static/images/like.png"></span></td></tr></tbody></table></div><div class="exampleboxbody"><pre class="prettyprint"><span class="kwd"><span class="kwd">def</span></span><span class="pln"><span class="pln"> chunkify</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">iterable</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> chunksize</span></span><span class="pun"><span class="pun">):</span></span><span class="pln"><span class="pln">
    </span></span><span class="str"><span class="str">"""Splits an iterable into chunks of size ``chunksize``. The last chunk may be smaller than ``chunksize``.

    Args:
      iterable:
      chunksize:

    """</span></span><span class="pln"><span class="pln">
    </span></span><span class="kwd"><span class="kwd">from</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">queryset </span></span><span class="kwd"><span class="kwd">import</span></span><span class="pln"><span class="pln"> </span></span><span class="typ"><span class="typ">QuerySet</span></span><span class="pln"><span class="pln">
    </span></span><span class="kwd"><span class="kwd">if</span></span><span class="pln"><span class="pln"> hasattr</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">iterable</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">'__getitem__'</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln"> </span></span><span class="kwd"><span class="kwd">and</span></span><span class="pln"><span class="pln"> </span></span><span class="kwd"><span class="kwd">not</span></span><span class="pln"><span class="pln"> isinstance</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">iterable</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> </span></span><span class="typ"><span class="typ">QuerySet</span></span><span class="pun"><span class="pun">):</span></span><span class="pln"><span class="pln">
        </span></span><span class="com"><span class="com"># tuple, list. QuerySet has __getitem__ but that evaluates the entire </span><span class="highlight"><span class="com">query</span></span><span class="com"> greedily. We don't want that here.</span></span><span class="pln"><span class="pln">
        </span></span><span class="kwd"><span class="kwd">for</span></span><span class="pln"><span class="pln"> i </span></span><span class="kwd"><span class="kwd">in</span></span><span class="pln"><span class="pln"> range</span></span><span class="pun"><span class="pun">(</span></span><span class="lit"><span class="lit">0</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> len</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">iterable</span></span><span class="pun"><span class="pun">),</span></span><span class="pln"><span class="pln"> chunksize</span></span><span class="pun"><span class="pun">):</span></span><span class="pln"><span class="pln">
            </span></span><span class="kwd"><span class="kwd">yield</span></span><span class="pln"><span class="pln"> iterable</span></span><span class="pun"><span class="pun">[</span></span><span class="pln"><span class="pln">i</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln">i </span></span><span class="pun"><span class="pun">+</span></span><span class="pln"><span class="pln"> chunksize</span></span><span class="pun"><span class="pun">]</span></span><span class="pln"><span class="pln">
    </span></span><span class="kwd"><span class="kwd">else</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln">
        </span></span><span class="com"><span class="com"># generator, set, map, QuerySet</span></span><span class="pln"><span class="pln">
        chunk </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">[]</span></span><span class="pln"><span class="pln">
        </span></span><span class="kwd"><span class="kwd">for</span></span><span class="pln"><span class="pln"> i </span></span><span class="kwd"><span class="kwd">in</span></span><span class="pln"><span class="pln"> iterable</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln">
            chunk</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">append</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">i</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln">
            </span></span><span class="kwd"><span class="kwd">if</span></span><span class="pln"><span class="pln"> len</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">chunk</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">==</span></span><span class="pln"><span class="pln"> chunksize</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln">
                </span></span><span class="kwd"><span class="kwd">yield</span></span><span class="pln"><span class="pln"> chunk
                chunk </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">[]</span></span><span class="pln"><span class="pln">
        </span></span><span class="kwd"><span class="kwd">if</span></span><span class="pln"><span class="pln"> chunk</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln">
            </span></span><span class="kwd"><span class="kwd">yield</span></span><span class="pln"><span class="pln"> chunk </span></span></pre></div></div><span id="ezoic-pub-ad-placeholder-163"></span><div style="margin:20px 2px;color:#424345;font-weight:700">Example #13</div><div class="examplebox"><div class="exampleboxheader"><table width="100%"><tbody><tr><td width="80%" style="padding:2px;font-size:14px;line-height:25px">Source Project:
<a href="https://www.programcreek.com/python/?project_name=ecederstrand%2Fexchangelib"><span style="font-style:italic">exchangelib</span>&nbsp;&nbsp;</a>
Author: <span style="font-style:italic">ecederstrand</span>&nbsp;&nbsp;
File: <a href="https://www.programcreek.com/python?code=ecederstrand%2Fexchangelib%2Fexchangelib-master%2Fexchangelib%2Futil.py">util.py </a>&nbsp;&nbsp;
License: <a href="https://www.programcreek.com/python?code=ecederstrand%2Fexchangelib%2Fexchangelib-master%2FLICENSE">BSD 2-Clause "Simplified" License</a></td><td width="10%" align="right" style="padding-right:5px;font-size:14px;color:#08c"><span style="color:#08c" id="467067votes">6</span>
votes</td><td width="12%" align="right" style="padding-right:5px;font-size:14px"><span class="vote vote_down click_button" style="float:right;padding-bottom:-2px;border-radius:2px;border:1px solid #d8d8d8" id="467067"><img alt="vote down" src="data:image/svg+xml,%3Csvg%20xmlns=%22http://www.w3.org/2000/svg%22%20width=%2248%22%20height=%2248%22%3E%3C/svg%3E" width="26" ezimgfmt="rs rscb13 src ng ngcb13" class="ezlazyload" data-ezsrc="https://www.programcreek.com/common/static/images/dislike.png"></span>
<span class="vote vote_up click_button" style="float:left;padding-top:-2px;border-radius:2px;border:1px solid #d8d8d8" id="467067"><img alt="vote up" src="data:image/svg+xml,%3Csvg%20xmlns=%22http://www.w3.org/2000/svg%22%20width=%2248%22%20height=%2248%22%3E%3C/svg%3E" width="26" ezimgfmt="rs rscb13 src ng ngcb13" class="ezlazyload" data-ezsrc="https://www.programcreek.com/common/static/images/like.png"></span></td></tr></tbody></table></div><div class="exampleboxbody"><pre class="prettyprint"><span class="kwd"><span class="kwd">def</span></span><span class="pln"><span class="pln"> peek</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">iterable</span></span><span class="pun"><span class="pun">):</span></span><span class="pln"><span class="pln">
    </span></span><span class="str"><span class="str">"""Checks if an iterable is empty and returns status and the rewinded iterable

    Args:
      iterable:

    """</span></span><span class="pln"><span class="pln">
    </span></span><span class="kwd"><span class="kwd">from</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">queryset </span></span><span class="kwd"><span class="kwd">import</span></span><span class="pln"><span class="pln"> </span></span><span class="typ"><span class="typ">QuerySet</span></span><span class="pln"><span class="pln">
    </span></span><span class="kwd"><span class="kwd">if</span></span><span class="pln"><span class="pln"> isinstance</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">iterable</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> </span></span><span class="typ"><span class="typ">QuerySet</span></span><span class="pun"><span class="pun">):</span></span><span class="pln"><span class="pln">
        </span></span><span class="com"><span class="com"># QuerySet has __len__ but that evaluates the entire </span><span class="highlight"><span class="com">query</span></span><span class="com"> greedily. We don't want that here. Instead, peek()</span></span><span class="pln"><span class="pln">
        </span></span><span class="com"><span class="com"># should be called on QuerySet.iterator()</span></span><span class="pln"><span class="pln">
        </span></span><span class="kwd"><span class="kwd">raise</span></span><span class="pln"><span class="pln"> </span></span><span class="typ"><span class="typ">ValueError</span></span><span class="pun"><span class="pun">(</span></span><span class="str"><span class="str">'Cannot peek on a QuerySet'</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln">
    </span></span><span class="kwd"><span class="kwd">if</span></span><span class="pln"><span class="pln"> hasattr</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">iterable</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">'__len__'</span></span><span class="pun"><span class="pun">):</span></span><span class="pln"><span class="pln">
        </span></span><span class="com"><span class="com"># tuple, list, set</span></span><span class="pln"><span class="pln">
        </span></span><span class="kwd"><span class="kwd">return</span></span><span class="pln"><span class="pln"> </span></span><span class="kwd"><span class="kwd">not</span></span><span class="pln"><span class="pln"> iterable</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> iterable
    </span></span><span class="com"><span class="com"># generator</span></span><span class="pln"><span class="pln">
    </span></span><span class="kwd"><span class="kwd">try</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln">
        first </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> </span></span><span class="kwd"><span class="kwd">next</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">iterable</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln">
    </span></span><span class="kwd"><span class="kwd">except</span></span><span class="pln"><span class="pln"> </span></span><span class="typ"><span class="typ">StopIteration</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln">
        </span></span><span class="kwd"><span class="kwd">return</span></span><span class="pln"><span class="pln"> </span></span><span class="kwd"><span class="kwd">True</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> iterable
    </span></span><span class="com"><span class="com"># We can't rewind a generator. Instead, chain the first element and the rest of the generator</span></span><span class="pln"><span class="pln">
    </span></span><span class="kwd"><span class="kwd">return</span></span><span class="pln"><span class="pln"> </span></span><span class="kwd"><span class="kwd">False</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> itertools</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">chain</span></span><span class="pun"><span class="pun">([</span></span><span class="pln"><span class="pln">first</span></span><span class="pun"><span class="pun">],</span></span><span class="pln"><span class="pln"> iterable</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln"> </span></span></pre></div></div><div style="margin:20px 2px;color:#424345;font-weight:700">Example #14</div><div class="examplebox"><div class="exampleboxheader"><table width="100%"><tbody><tr><td width="80%" style="padding:2px;font-size:14px;line-height:25px">Source Project:
<a href="https://www.programcreek.com/python/?project_name=elgatito%2Fscript.elementum.burst"><span style="font-style:italic">script.elementum.burst</span>&nbsp;&nbsp;</a>
Author: <span style="font-style:italic">elgatito</span>&nbsp;&nbsp;
File: <a href="https://www.programcreek.com/python?code=elgatito%2Fscript.elementum.burst%2Fscript.elementum.burst-master%2Fresources%2Fsite-packages%2Fdns%2Fe164.py">e164.py </a>&nbsp;&nbsp;
License: <a href="https://www.programcreek.com/python?code=elgatito%2Fscript.elementum.burst%2Fscript.elementum.burst-master%2FLICENSE">Do What The F*ck You Want To Public License</a></td><td width="10%" align="right" style="padding-right:5px;font-size:14px;color:#08c"><span style="color:#08c" id="481317votes">6</span>
votes</td><td width="12%" align="right" style="padding-right:5px;font-size:14px"><span class="vote vote_down click_button" style="float:right;padding-bottom:-2px;border-radius:2px;border:1px solid #d8d8d8" id="481317"><img alt="vote down" src="data:image/svg+xml,%3Csvg%20xmlns=%22http://www.w3.org/2000/svg%22%20width=%2248%22%20height=%2248%22%3E%3C/svg%3E" width="26" ezimgfmt="rs rscb13 src ng ngcb13" class="ezlazyload" data-ezsrc="https://www.programcreek.com/common/static/images/dislike.png"></span>
<span class="vote vote_up click_button" style="float:left;padding-top:-2px;border-radius:2px;border:1px solid #d8d8d8" id="481317"><img alt="vote up" src="data:image/svg+xml,%3Csvg%20xmlns=%22http://www.w3.org/2000/svg%22%20width=%2248%22%20height=%2248%22%3E%3C/svg%3E" width="26" ezimgfmt="rs rscb13 src ng ngcb13" class="ezlazyload" data-ezsrc="https://www.programcreek.com/common/static/images/like.png"></span></td></tr></tbody></table></div><div class="exampleboxbody"><pre class="prettyprint"><span class="kwd"><span class="kwd">def</span></span><span class="pln"><span class="pln"> </span><span class="highlight"><span class="pln">query</span></span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">number</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> domains</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> resolver</span></span><span class="pun"><span class="pun">=</span></span><span class="kwd"><span class="kwd">None</span></span><span class="pun"><span class="pun">):</span></span><span class="pln"><span class="pln">
    </span></span><span class="str"><span class="str">"""Look for NAPTR RRs for the specified number in the specified domains.

    e.g. lookup('16505551212', ['e164.dnspython.org.', 'e164.arpa.'])
    """</span></span><span class="pln"><span class="pln">
    </span></span><span class="kwd"><span class="kwd">if</span></span><span class="pln"><span class="pln"> resolver </span></span><span class="kwd"><span class="kwd">is</span></span><span class="pln"><span class="pln"> </span></span><span class="kwd"><span class="kwd">None</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln">
        resolver </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> dns</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">resolver</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">get_default_resolver</span></span><span class="pun"><span class="pun">()</span></span><span class="pln"><span class="pln">
    e_nx </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> dns</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">resolver</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">NXDOMAIN</span></span><span class="pun"><span class="pun">()</span></span><span class="pln"><span class="pln">
    </span></span><span class="kwd"><span class="kwd">for</span></span><span class="pln"><span class="pln"> domain </span></span><span class="kwd"><span class="kwd">in</span></span><span class="pln"><span class="pln"> domains</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln">
        </span></span><span class="kwd"><span class="kwd">if</span></span><span class="pln"><span class="pln"> isinstance</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">domain</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> string_types</span></span><span class="pun"><span class="pun">):</span></span><span class="pln"><span class="pln">
            domain </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> dns</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">name</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">from_text</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">domain</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln">
        qname </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> dns</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">e164</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">from_e164</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">number</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> domain</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln">
        </span></span><span class="kwd"><span class="kwd">try</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln">
            </span></span><span class="kwd"><span class="kwd">return</span></span><span class="pln"><span class="pln"> resolver</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="highlight"><span class="pln">query</span></span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">qname</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">'NAPTR'</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln">
        </span></span><span class="kwd"><span class="kwd">except</span></span><span class="pln"><span class="pln"> dns</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">resolver</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">NXDOMAIN </span></span><span class="kwd"><span class="kwd">as</span></span><span class="pln"><span class="pln"> e</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln">
            e_nx </span></span><span class="pun"><span class="pun">+=</span></span><span class="pln"><span class="pln"> e
    </span></span><span class="kwd"><span class="kwd">raise</span></span><span class="pln"><span class="pln"> e_nx </span></span></pre></div></div><div style="margin:20px 2px;color:#424345;font-weight:700">Example #15</div><div class="examplebox"><div class="exampleboxheader"><table width="100%"><tbody><tr><td width="80%" style="padding:2px;font-size:14px;line-height:25px">Source Project:
<a href="https://www.programcreek.com/python/?project_name=black-security%2Fcyber-security-framework"><span style="font-style:italic">cyber-security-framework</span>&nbsp;&nbsp;</a>
Author: <span style="font-style:italic">black-security</span>&nbsp;&nbsp;
File: <a href="https://www.programcreek.com/python?code=black-security%2Fcyber-security-framework%2Fcyber-security-framework-master%2Fremote%2Fdns%2Fdnask.py">dnask.py </a>&nbsp;&nbsp;
License: <a href="https://www.programcreek.com/python?code=black-security%2Fcyber-security-framework%2Fcyber-security-framework-master%2FLICENSE">MIT License</a></td><td width="10%" align="right" style="padding-right:5px;font-size:14px;color:#08c"><span style="color:#08c" id="500802votes">6</span>
votes</td><td width="12%" align="right" style="padding-right:5px;font-size:14px"><span class="vote vote_down click_button" style="float:right;padding-bottom:-2px;border-radius:2px;border:1px solid #d8d8d8" id="500802"><img alt="vote down" src="data:image/svg+xml,%3Csvg%20xmlns=%22http://www.w3.org/2000/svg%22%20width=%2248%22%20height=%2248%22%3E%3C/svg%3E" width="26" ezimgfmt="rs rscb13 src ng ngcb13" class="ezlazyload" data-ezsrc="https://www.programcreek.com/common/static/images/dislike.png"></span>
<span class="vote vote_up click_button" style="float:left;padding-top:-2px;border-radius:2px;border:1px solid #d8d8d8" id="500802"><img alt="vote up" src="data:image/svg+xml,%3Csvg%20xmlns=%22http://www.w3.org/2000/svg%22%20width=%2248%22%20height=%2248%22%3E%3C/svg%3E" width="26" ezimgfmt="rs rscb13 src ng ngcb13" class="ezlazyload" data-ezsrc="https://www.programcreek.com/common/static/images/like.png"></span></td></tr></tbody></table></div><div class="exampleboxbody"><pre class="prettyprint"><span class="kwd"><span class="kwd">def</span></span><span class="pln"><span class="pln"> __init__</span></span><span class="pun"><span class="pun">(</span></span><span class="kwd"><span class="kwd">self</span></span><span class="pun"><span class="pun">):</span></span><span class="pln"><span class="pln">
        </span></span><span class="kwd"><span class="kwd">super</span></span><span class="pun"><span class="pun">().</span></span><span class="pln"><span class="pln">__init__</span></span><span class="pun"><span class="pun">()</span></span><span class="pln"><span class="pln">
        </span></span><span class="kwd"><span class="kwd">self</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">parser</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">add_argument</span></span><span class="pun"><span class="pun">(</span></span><span class="str"><span class="str">"</span><span class="highlight"><span class="str">query</span></span><span class="str">"</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> type</span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln">str</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> help</span></span><span class="pun"><span class="pun">=</span></span><span class="str"><span class="str">"Query string."</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln">
        </span></span><span class="kwd"><span class="kwd">self</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">parser</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">add_argument</span></span><span class="pun"><span class="pun">(</span></span><span class="str"><span class="str">"-t"</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">"--rdtype"</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> type</span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln">str</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> </span></span><span class="kwd"><span class="kwd">default</span></span><span class="pun"><span class="pun">=</span></span><span class="lit"><span class="lit">1</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> help</span></span><span class="pun"><span class="pun">=</span></span><span class="str"><span class="str">"Query type."</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln">
        </span></span><span class="kwd"><span class="kwd">self</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">parser</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">add_argument</span></span><span class="pun"><span class="pun">(</span></span><span class="str"><span class="str">"-c"</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">"--rdclass"</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> type</span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln">str</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> </span></span><span class="kwd"><span class="kwd">default</span></span><span class="pun"><span class="pun">=</span></span><span class="lit"><span class="lit">1</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> help</span></span><span class="pun"><span class="pun">=</span></span><span class="str"><span class="str">"Query class."</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln">
        </span></span><span class="kwd"><span class="kwd">self</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">parser</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">add_argument</span></span><span class="pun"><span class="pun">(</span></span><span class="str"><span class="str">"-m"</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">"--metaquery"</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> action</span></span><span class="pun"><span class="pun">=</span></span><span class="str"><span class="str">"store_true"</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> help</span></span><span class="pun"><span class="pun">=</span></span><span class="str"><span class="str">"Execute as MetaQuery."</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln">
        </span></span><span class="kwd"><span class="kwd">self</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">parser</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">add_argument</span></span><span class="pun"><span class="pun">(</span></span><span class="str"><span class="str">"-s"</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">"--source"</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> type</span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln">str</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> </span></span><span class="kwd"><span class="kwd">default</span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln">socket</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">gethostbyname</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">socket</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">gethostname</span></span><span class="pun"><span class="pun">()),</span></span><span class="pln"><span class="pln"> help</span></span><span class="pun"><span class="pun">=</span></span><span class="str"><span class="str">"Source address."</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln">
        </span></span><span class="kwd"><span class="kwd">self</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">parser</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">add_argument</span></span><span class="pun"><span class="pun">(</span></span><span class="str"><span class="str">"-sP"</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">"--source-port"</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> type</span></span><span class="pun"><span class="pun">=</span></span><span class="kwd"><span class="kwd">int</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> </span></span><span class="kwd"><span class="kwd">default</span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln">random</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">randint</span></span><span class="pun"><span class="pun">(</span></span><span class="lit"><span class="lit">1</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> </span></span><span class="lit"><span class="lit">65535</span></span><span class="pun"><span class="pun">),</span></span><span class="pln"><span class="pln"> help</span></span><span class="pun"><span class="pun">=</span></span><span class="str"><span class="str">"Source port."</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln">
        </span></span><span class="kwd"><span class="kwd">self</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">parser</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">add_argument</span></span><span class="pun"><span class="pun">(</span></span><span class="str"><span class="str">"--tcp"</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> action</span></span><span class="pun"><span class="pun">=</span></span><span class="str"><span class="str">"store_true"</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> help</span></span><span class="pun"><span class="pun">=</span></span><span class="str"><span class="str">"Use TCP to make the </span><span class="highlight"><span class="str">query</span></span><span class="str">."</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln">
        </span></span><span class="kwd"><span class="kwd">self</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">parser</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">add_argument</span></span><span class="pun"><span class="pun">(</span></span><span class="str"><span class="str">"-ns"</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">"--nameservers"</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> nargs</span></span><span class="pun"><span class="pun">=</span></span><span class="str"><span class="str">"+"</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> type</span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln">str</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> help</span></span><span class="pun"><span class="pun">=</span></span><span class="str"><span class="str">"A list of nameservers to </span><span class="highlight"><span class="str">query</span></span><span class="str">. Each nameserver is a string which contains the IP address of a nameserver."</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln">
        </span></span><span class="kwd"><span class="kwd">self</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">parser</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">add_argument</span></span><span class="pun"><span class="pun">(</span></span><span class="str"><span class="str">"-p"</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">"--port"</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> type</span></span><span class="pun"><span class="pun">=</span></span><span class="kwd"><span class="kwd">int</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> </span></span><span class="kwd"><span class="kwd">default</span></span><span class="pun"><span class="pun">=</span></span><span class="lit"><span class="lit">53</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> help</span></span><span class="pun"><span class="pun">=</span></span><span class="str"><span class="str">"The port to which to send queries (Defaults to 53)."</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln">
        </span></span><span class="kwd"><span class="kwd">self</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">parser</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">add_argument</span></span><span class="pun"><span class="pun">(</span></span><span class="str"><span class="str">"-T"</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">"--timeout"</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> type</span></span><span class="pun"><span class="pun">=</span></span><span class="kwd"><span class="kwd">int</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> </span></span><span class="kwd"><span class="kwd">default</span></span><span class="pun"><span class="pun">=</span></span><span class="lit"><span class="lit">8</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> help</span></span><span class="pun"><span class="pun">=</span></span><span class="str"><span class="str">"The number of seconds to wait for a response from a server, before timing out."</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln">
        </span></span><span class="kwd"><span class="kwd">self</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">parser</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">add_argument</span></span><span class="pun"><span class="pun">(</span></span><span class="str"><span class="str">"-l"</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">"--lifetime"</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> type</span></span><span class="pun"><span class="pun">=</span></span><span class="kwd"><span class="kwd">int</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> </span></span><span class="kwd"><span class="kwd">default</span></span><span class="pun"><span class="pun">=</span></span><span class="lit"><span class="lit">8</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> help</span></span><span class="pun"><span class="pun">=</span></span><span class="str"><span class="str">"The total number of seconds to spend trying to get an answer to the question. If the lifetime expires, a Timeout exception will occur."</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln">
        </span></span><span class="kwd"><span class="kwd">self</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">parser</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">add_argument</span></span><span class="pun"><span class="pun">(</span></span><span class="str"><span class="str">"-e"</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">"--edns"</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> type</span></span><span class="pun"><span class="pun">=</span></span><span class="kwd"><span class="kwd">int</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> </span></span><span class="kwd"><span class="kwd">default</span></span><span class="pun"><span class="pun">=-</span></span><span class="lit"><span class="lit">1</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> help</span></span><span class="pun"><span class="pun">=</span></span><span class="str"><span class="str">"The EDNS level to use (Defaults to -1, no Edns)."</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln">
        </span></span><span class="kwd"><span class="kwd">self</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">parser</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">add_argument</span></span><span class="pun"><span class="pun">(</span></span><span class="str"><span class="str">"-eF"</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">"--edns-flags"</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> type</span></span><span class="pun"><span class="pun">=</span></span><span class="kwd"><span class="kwd">int</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> help</span></span><span class="pun"><span class="pun">=</span></span><span class="str"><span class="str">"The EDNS flags."</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln">
        </span></span><span class="kwd"><span class="kwd">self</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">parser</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">add_argument</span></span><span class="pun"><span class="pun">(</span></span><span class="str"><span class="str">"-eP"</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">"--edns-payload"</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> type</span></span><span class="pun"><span class="pun">=</span></span><span class="kwd"><span class="kwd">int</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> </span></span><span class="kwd"><span class="kwd">default</span></span><span class="pun"><span class="pun">=</span></span><span class="lit"><span class="lit">0</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> help</span></span><span class="pun"><span class="pun">=</span></span><span class="str"><span class="str">"The EDNS payload size (Defaults to 0)."</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln">
        </span></span><span class="kwd"><span class="kwd">self</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">parser</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">add_argument</span></span><span class="pun"><span class="pun">(</span></span><span class="str"><span class="str">"-S"</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">"--want-dnssec"</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> action</span></span><span class="pun"><span class="pun">=</span></span><span class="str"><span class="str">"store_true"</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> help</span></span><span class="pun"><span class="pun">=</span></span><span class="str"><span class="str">"Indicate that DNSSEC is desired."</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln">
        </span></span><span class="kwd"><span class="kwd">self</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">parser</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">add_argument</span></span><span class="pun"><span class="pun">(</span></span><span class="str"><span class="str">"-f"</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">"--flags"</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> type</span></span><span class="pun"><span class="pun">=</span></span><span class="kwd"><span class="kwd">int</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> </span></span><span class="kwd"><span class="kwd">default</span></span><span class="pun"><span class="pun">=</span></span><span class="kwd"><span class="kwd">None</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> help</span></span><span class="pun"><span class="pun">=</span></span><span class="str"><span class="str">"The message flags to use (Defaults to None (i.e. not overwritten))."</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln">
        </span></span><span class="kwd"><span class="kwd">self</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">parser</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">add_argument</span></span><span class="pun"><span class="pun">(</span></span><span class="str"><span class="str">"-r"</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">"--retry-servfail"</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> action</span></span><span class="pun"><span class="pun">=</span></span><span class="str"><span class="str">"store_true"</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> help</span></span><span class="pun"><span class="pun">=</span></span><span class="str"><span class="str">"Retry a nameserver if it says SERVFAIL."</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln">
        </span></span><span class="kwd"><span class="kwd">self</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">parser</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">add_argument</span></span><span class="pun"><span class="pun">(</span></span><span class="str"><span class="str">"-R"</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">"--one-rr-per-rrset"</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> action</span></span><span class="pun"><span class="pun">=</span></span><span class="str"><span class="str">"store_true"</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> help</span></span><span class="pun"><span class="pun">=</span></span><span class="str"><span class="str">"Put each RR into its own RRset (Only useful when executing MetaQueries)."</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln">
        </span></span><span class="kwd"><span class="kwd">self</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">parser</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">add_argument</span></span><span class="pun"><span class="pun">(</span></span><span class="str"><span class="str">"--filename"</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> type</span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln">argparse</span></span><span class="pun"><span class="pun">.</span></span><span class="typ"><span class="typ">FileType</span></span><span class="pun"><span class="pun">(</span></span><span class="str"><span class="str">"r"</span></span><span class="pun"><span class="pun">),</span></span><span class="pln"><span class="pln"> help</span></span><span class="pun"><span class="pun">=</span></span><span class="str"><span class="str">"The filename of a configuration file in standard /etc/resolv.conf format. This parameter is meaningful only when I{configure} is true and the platform is POSIX."</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln">
        </span></span><span class="kwd"><span class="kwd">self</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">parser</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">add_argument</span></span><span class="pun"><span class="pun">(</span></span><span class="str"><span class="str">"--configure-resolver"</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> action</span></span><span class="pun"><span class="pun">=</span></span><span class="str"><span class="str">"store_false"</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> help</span></span><span class="pun"><span class="pun">=</span></span><span class="str"><span class="str">"If True (the default), the resolver instance is configured in the normal fashion for the operating system the resolver is running on. (I.e. a /etc/resolv.conf file on POSIX systems and from the registry on Windows systems."</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln"> </span></span></pre></div></div><div style="margin:20px 2px;color:#424345;font-weight:700">Example #16</div><div class="examplebox"><div class="exampleboxheader"><table width="100%"><tbody><tr><td width="80%" style="padding:2px;font-size:14px;line-height:25px">Source Project:
<a href="https://www.programcreek.com/python/?project_name=black-security%2Fcyber-security-framework"><span style="font-style:italic">cyber-security-framework</span>&nbsp;&nbsp;</a>
Author: <span style="font-style:italic">black-security</span>&nbsp;&nbsp;
File: <a href="https://www.programcreek.com/python?code=black-security%2Fcyber-security-framework%2Fcyber-security-framework-master%2Fremote%2Fdns%2Fdnask.py">dnask.py </a>&nbsp;&nbsp;
License: <a href="https://www.programcreek.com/python?code=black-security%2Fcyber-security-framework%2Fcyber-security-framework-master%2FLICENSE">MIT License</a></td><td width="10%" align="right" style="padding-right:5px;font-size:14px;color:#08c"><span style="color:#08c" id="500803votes">6</span>
votes</td><td width="12%" align="right" style="padding-right:5px;font-size:14px"><span class="vote vote_down click_button" style="float:right;padding-bottom:-2px;border-radius:2px;border:1px solid #d8d8d8" id="500803"><img alt="vote down" src="data:image/svg+xml,%3Csvg%20xmlns=%22http://www.w3.org/2000/svg%22%20width=%2248%22%20height=%2248%22%3E%3C/svg%3E" width="26" ezimgfmt="rs rscb13 src ng ngcb13" class="ezlazyload" data-ezsrc="https://www.programcreek.com/common/static/images/dislike.png"></span>
<span class="vote vote_up click_button" style="float:left;padding-top:-2px;border-radius:2px;border:1px solid #d8d8d8" id="500803"><img alt="vote up" src="data:image/svg+xml,%3Csvg%20xmlns=%22http://www.w3.org/2000/svg%22%20width=%2248%22%20height=%2248%22%3E%3C/svg%3E" width="26" ezimgfmt="rs rscb13 src ng ngcb13" class="ezlazyload" data-ezsrc="https://www.programcreek.com/common/static/images/like.png"></span></td></tr></tbody></table></div><div class="exampleboxbody"><pre class="prettyprint"><span class="kwd"><span class="kwd">def</span></span><span class="pln"><span class="pln"> run</span></span><span class="pun"><span class="pun">(</span></span><span class="kwd"><span class="kwd">self</span></span><span class="pun"><span class="pun">):</span></span><span class="pln"><span class="pln">
        arguments </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> </span></span><span class="kwd"><span class="kwd">self</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">arguments</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">__dict__
        nameservers </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> arguments</span></span><span class="pun"><span class="pun">.</span></span><span class="kwd"><span class="kwd">get</span></span><span class="pun"><span class="pun">(</span></span><span class="str"><span class="str">"nameservers"</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln">
        resolver </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> dns</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">resolver</span></span><span class="pun"><span class="pun">.</span></span><span class="typ"><span class="typ">Resolver</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">arguments</span></span><span class="pun"><span class="pun">.</span></span><span class="kwd"><span class="kwd">get</span></span><span class="pun"><span class="pun">(</span></span><span class="str"><span class="str">"filename"</span></span><span class="pun"><span class="pun">),</span></span><span class="pln"><span class="pln"> arguments</span></span><span class="pun"><span class="pun">.</span></span><span class="kwd"><span class="kwd">get</span></span><span class="pun"><span class="pun">(</span></span><span class="str"><span class="str">"configure_resolver"</span></span><span class="pun"><span class="pun">))</span></span><span class="pln"><span class="pln">
        resolver</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">set_flags</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">arguments</span></span><span class="pun"><span class="pun">.</span></span><span class="kwd"><span class="kwd">get</span></span><span class="pun"><span class="pun">(</span></span><span class="str"><span class="str">"flags"</span></span><span class="pun"><span class="pun">))</span></span><span class="pln"><span class="pln">
        resolver</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">use_edns</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">arguments</span></span><span class="pun"><span class="pun">.</span></span><span class="kwd"><span class="kwd">get</span></span><span class="pun"><span class="pun">(</span></span><span class="str"><span class="str">"edns"</span></span><span class="pun"><span class="pun">),</span></span><span class="pln"><span class="pln"> arguments</span></span><span class="pun"><span class="pun">.</span></span><span class="kwd"><span class="kwd">get</span></span><span class="pun"><span class="pun">(</span></span><span class="str"><span class="str">"edns_flags"</span></span><span class="pun"><span class="pun">),</span></span><span class="pln"><span class="pln"> arguments</span></span><span class="pun"><span class="pun">.</span></span><span class="kwd"><span class="kwd">get</span></span><span class="pun"><span class="pun">(</span></span><span class="str"><span class="str">"edns_payload"</span></span><span class="pun"><span class="pun">))</span></span><span class="pln"><span class="pln">
        </span></span><span class="kwd"><span class="kwd">if</span></span><span class="pln"><span class="pln"> nameservers</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln">
            resolver</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">nameservers </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> nameservers
        resolver</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">port </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> arguments</span></span><span class="pun"><span class="pun">.</span></span><span class="kwd"><span class="kwd">get</span></span><span class="pun"><span class="pun">(</span></span><span class="str"><span class="str">"port"</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln">
        resolver</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">timeout </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> arguments</span></span><span class="pun"><span class="pun">.</span></span><span class="kwd"><span class="kwd">get</span></span><span class="pun"><span class="pun">(</span></span><span class="str"><span class="str">"timeout"</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln">
        resolver</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">lifetime </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> arguments</span></span><span class="pun"><span class="pun">.</span></span><span class="kwd"><span class="kwd">get</span></span><span class="pun"><span class="pun">(</span></span><span class="str"><span class="str">"lifetime"</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln">
        resolver</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">retry_servfail </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> arguments</span></span><span class="pun"><span class="pun">.</span></span><span class="kwd"><span class="kwd">get</span></span><span class="pun"><span class="pun">(</span></span><span class="str"><span class="str">"retry_servfail"</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln">
        </span></span><span class="kwd"><span class="kwd">if</span></span><span class="pln"><span class="pln"> arguments</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">pop</span></span><span class="pun"><span class="pun">(</span></span><span class="str"><span class="str">"metaquery"</span></span><span class="pun"><span class="pun">):</span></span><span class="pln"><span class="pln">
            kwargs </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">{</span></span><span class="pln"><span class="pln">v</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln"> arguments</span></span><span class="pun"><span class="pun">.</span></span><span class="kwd"><span class="kwd">get</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">k</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln"> </span></span><span class="kwd"><span class="kwd">for</span></span><span class="pln"><span class="pln"> k</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> v </span></span><span class="kwd"><span class="kwd">in</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">{</span></span><span class="str"><span class="str">"rdclass"</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">"rdclass"</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">"edns"</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">"use_edns"</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">"want_dnssec"</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">"want_dnssec"</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">"edns_flags"</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">"ednsflags"</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">"edns_payload"</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">"request_payload"</span></span><span class="pun"><span class="pun">}.</span></span><span class="pln"><span class="pln">items</span></span><span class="pun"><span class="pun">()}</span></span><span class="pln"><span class="pln">
            message </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> dns</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">message</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">make_query</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">arguments</span></span><span class="pun"><span class="pun">.</span></span><span class="kwd"><span class="kwd">get</span></span><span class="pun"><span class="pun">(</span></span><span class="str"><span class="str">"</span><span class="highlight"><span class="str">query</span></span><span class="str">"</span></span><span class="pun"><span class="pun">),</span></span><span class="pln"><span class="pln"> arguments</span></span><span class="pun"><span class="pun">.</span></span><span class="kwd"><span class="kwd">get</span></span><span class="pun"><span class="pun">(</span></span><span class="str"><span class="str">"rdtype"</span></span><span class="pun"><span class="pun">),</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">**</span></span><span class="pln"><span class="pln">kwargs</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln">
            kwargs </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">{</span></span><span class="pln"><span class="pln">k</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln"> arguments</span></span><span class="pun"><span class="pun">.</span></span><span class="kwd"><span class="kwd">get</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">k</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln"> </span></span><span class="kwd"><span class="kwd">for</span></span><span class="pln"><span class="pln"> k </span></span><span class="kwd"><span class="kwd">in</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">[</span></span><span class="str"><span class="str">"timeout"</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">"port"</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">"source"</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">"source_port"</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">"one_rr_per_rrset"</span></span><span class="pun"><span class="pun">]}</span></span><span class="pln"><span class="pln">
            </span></span><span class="kwd"><span class="kwd">if</span></span><span class="pln"><span class="pln"> arguments</span></span><span class="pun"><span class="pun">.</span></span><span class="kwd"><span class="kwd">get</span></span><span class="pun"><span class="pun">(</span></span><span class="str"><span class="str">"tcp"</span></span><span class="pun"><span class="pun">):</span></span><span class="pln"><span class="pln">
                resp </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> dns</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="highlight"><span class="pln">query</span></span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">tcp</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">message</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> resolver</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">nameservers</span></span><span class="pun"><span class="pun">[</span></span><span class="lit"><span class="lit">0</span></span><span class="pun"><span class="pun">],</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">**</span></span><span class="pln"><span class="pln">kwargs</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln">
            </span></span><span class="kwd"><span class="kwd">else</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln">
                resp </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> dns</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="highlight"><span class="pln">query</span></span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">udp</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">message</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> resolver</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">nameservers</span></span><span class="pun"><span class="pun">[</span></span><span class="lit"><span class="lit">0</span></span><span class="pun"><span class="pun">],</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">**</span></span><span class="pln"><span class="pln">kwargs</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln">
            </span></span><span class="kwd"><span class="kwd">print</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">resp</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln">
        </span></span><span class="kwd"><span class="kwd">else</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln">
            kwargs </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">{</span></span><span class="pln"><span class="pln">k</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln"> arguments</span></span><span class="pun"><span class="pun">.</span></span><span class="kwd"><span class="kwd">get</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">k</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln"> </span></span><span class="kwd"><span class="kwd">for</span></span><span class="pln"><span class="pln"> k </span></span><span class="kwd"><span class="kwd">in</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">[</span></span><span class="str"><span class="str">"rdtype"</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">"rdclass"</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">"tcp"</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">"source"</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">"source_port"</span></span><span class="pun"><span class="pun">]}</span></span><span class="pln"><span class="pln">
            answer </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> resolver</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="highlight"><span class="pln">query</span></span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">arguments</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">pop</span></span><span class="pun"><span class="pun">(</span></span><span class="str"><span class="str">"</span><span class="highlight"><span class="str">query</span></span><span class="str">"</span></span><span class="pun"><span class="pun">),</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">**</span></span><span class="pln"><span class="pln">kwargs</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln">
            </span></span><span class="kwd"><span class="kwd">print</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">answer</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">response</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln"> </span></span></pre></div></div><div style="margin:20px 2px;color:#424345;font-weight:700">Example #17</div><div class="examplebox"><div class="exampleboxheader"><table width="100%"><tbody><tr><td width="80%" style="padding:2px;font-size:14px;line-height:25px">Source Project:
<a href="https://www.programcreek.com/python/?project_name=kp625544%2Fsubtake"><span style="font-style:italic">subtake</span>&nbsp;&nbsp;</a>
Author: <span style="font-style:italic">kp625544</span>&nbsp;&nbsp;
File: <a href="https://www.programcreek.com/python?code=kp625544%2Fsubtake%2Fsubtake-master%2Fsubbrute%2Fsubbrute.py">subbrute.py </a>&nbsp;&nbsp;
License: <a href="https://www.programcreek.com/python?code=kp625544%2Fsubtake%2Fsubtake-master%2FLICENSE">GNU General Public License v2.0</a></td><td width="10%" align="right" style="padding-right:5px;font-size:14px;color:#08c"><span style="color:#08c" id="22066votes">5</span>
votes</td><td width="12%" align="right" style="padding-right:5px;font-size:14px"><span class="vote vote_down click_button" style="float:right;padding-bottom:-2px;border-radius:2px;border:1px solid #d8d8d8" id="22066"><img alt="vote down" src="data:image/svg+xml,%3Csvg%20xmlns=%22http://www.w3.org/2000/svg%22%20width=%2248%22%20height=%2248%22%3E%3C/svg%3E" width="26" ezimgfmt="rs rscb13 src ng ngcb13" class="ezlazyload" data-ezsrc="https://www.programcreek.com/common/static/images/dislike.png"></span>
<span class="vote vote_up click_button" style="float:left;padding-top:-2px;border-radius:2px;border:1px solid #d8d8d8" id="22066"><img alt="vote up" src="data:image/svg+xml,%3Csvg%20xmlns=%22http://www.w3.org/2000/svg%22%20width=%2248%22%20height=%2248%22%3E%3C/svg%3E" width="26" ezimgfmt="rs rscb13 src ng ngcb13" class="ezlazyload" data-ezsrc="https://www.programcreek.com/common/static/images/like.png"></span></td></tr></tbody></table></div><div class="exampleboxbody"><pre class="prettyprint"><span class="kwd"><span class="kwd">def</span></span><span class="pln"><span class="pln"> __init__</span></span><span class="pun"><span class="pun">(</span></span><span class="kwd"><span class="kwd">self</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> target</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> record_type</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> resolver_q</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> resolver_list</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> wildcards</span></span><span class="pun"><span class="pun">):</span></span><span class="pln"><span class="pln">
        multiprocessing</span></span><span class="pun"><span class="pun">.</span></span><span class="typ"><span class="typ">Process</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">__init__</span></span><span class="pun"><span class="pun">(</span></span><span class="kwd"><span class="kwd">self</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> target </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> </span></span><span class="kwd"><span class="kwd">self</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">run</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln">
        </span></span><span class="kwd"><span class="kwd">self</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">daemon </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> </span></span><span class="kwd"><span class="kwd">True</span></span><span class="pln"><span class="pln">
        signal_init</span></span><span class="pun"><span class="pun">()</span></span><span class="pln"><span class="pln">

        </span></span><span class="kwd"><span class="kwd">self</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">time_to_die </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> </span></span><span class="kwd"><span class="kwd">False</span></span><span class="pln"><span class="pln">
        </span></span><span class="kwd"><span class="kwd">self</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">resolver_q </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> resolver_q
        </span></span><span class="kwd"><span class="kwd">self</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">wildcards </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> wildcards
        </span></span><span class="com"><span class="com">#Do we need wildcards for other types of records?</span></span><span class="pln"><span class="pln">
        </span></span><span class="com"><span class="com">#This needs testing!</span></span><span class="pln"><span class="pln">
        </span></span><span class="kwd"><span class="kwd">self</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">record_type </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">"A"</span></span><span class="pln"><span class="pln">
        </span></span><span class="kwd"><span class="kwd">if</span></span><span class="pln"><span class="pln"> record_type </span></span><span class="pun"><span class="pun">==</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">"AAAA"</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln">
            </span></span><span class="kwd"><span class="kwd">self</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">record_type </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> record_type
        </span></span><span class="kwd"><span class="kwd">self</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">resolver_list </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> resolver_list
        resolver </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> dns</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">resolver</span></span><span class="pun"><span class="pun">.</span></span><span class="typ"><span class="typ">Resolver</span></span><span class="pun"><span class="pun">()</span></span><span class="pln"><span class="pln">
        </span></span><span class="com"><span class="com">#The domain provided by the user.</span></span><span class="pln"><span class="pln">
        </span></span><span class="kwd"><span class="kwd">self</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">target </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> target
        </span></span><span class="com"><span class="com">#1 website in the world,  modify the following line when this status changes.</span></span><span class="pln"><span class="pln">
        </span></span><span class="com"><span class="com">#www.google.cn,  I'm looking at you ;)</span></span><span class="pln"><span class="pln">
        </span></span><span class="kwd"><span class="kwd">self</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">most_popular_website </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">"www.google.com"</span></span><span class="pln"><span class="pln">
        </span></span><span class="com"><span class="com">#We shouldn't need the backup_resolver, but we we can use them if need be.</span></span><span class="pln"><span class="pln">
        </span></span><span class="com"><span class="com">#We must have a resolver,  and localhost can work in some environments.</span></span><span class="pln"><span class="pln">
        </span></span><span class="kwd"><span class="kwd">self</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">backup_resolver </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> resolver</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">nameservers </span></span><span class="pun"><span class="pun">+</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">[</span></span><span class="str"><span class="str">'127.0.0.1'</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">'8.8.8.8'</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">'8.8.4.4'</span></span><span class="pun"><span class="pun">]</span></span><span class="pln"><span class="pln">
        </span></span><span class="com"><span class="com">#Ideally a nameserver should respond in less than 1 sec.</span></span><span class="pln"><span class="pln">
        resolver</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">timeout </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> </span></span><span class="lit"><span class="lit">1</span></span><span class="pln"><span class="pln">
        resolver</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">lifetime </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> </span></span><span class="lit"><span class="lit">1</span></span><span class="pln"><span class="pln">
        </span></span><span class="kwd"><span class="kwd">try</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln">
            </span></span><span class="com"><span class="com">#Lets test the letancy of our connection.</span></span><span class="pln"><span class="pln">
            </span></span><span class="com"><span class="com">#Google's DNS server should be an ideal time test.</span></span><span class="pln"><span class="pln">
            resolver</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">nameservers </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">[</span></span><span class="str"><span class="str">'8.8.8.8'</span></span><span class="pun"><span class="pun">]</span></span><span class="pln"><span class="pln">
            resolver</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="highlight"><span class="pln">query</span></span></span><span class="pun"><span class="pun">(</span></span><span class="kwd"><span class="kwd">self</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">most_popular_website</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> </span></span><span class="kwd"><span class="kwd">self</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">record_type</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln">
        </span></span><span class="kwd"><span class="kwd">except</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln">
            </span></span><span class="com"><span class="com">#Our connection is slower than a junebug in molasses</span></span><span class="pln"><span class="pln">
            resolver </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> dns</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">resolver</span></span><span class="pun"><span class="pun">.</span></span><span class="typ"><span class="typ">Resolver</span></span><span class="pun"><span class="pun">()</span></span><span class="pln"><span class="pln">
        </span></span><span class="kwd"><span class="kwd">self</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">resolver </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> resolver </span></span></pre></div></div><div style="margin:20px 2px;color:#424345;font-weight:700">Example #18</div><div class="examplebox"><div class="exampleboxheader"><table width="100%"><tbody><tr><td width="80%" style="padding:2px;font-size:14px;line-height:25px">Source Project:
<a href="https://www.programcreek.com/python/?project_name=kp625544%2Fsubtake"><span style="font-style:italic">subtake</span>&nbsp;&nbsp;</a>
Author: <span style="font-style:italic">kp625544</span>&nbsp;&nbsp;
File: <a href="https://www.programcreek.com/python?code=kp625544%2Fsubtake%2Fsubtake-master%2Fsubbrute%2Fsubbrute.py">subbrute.py </a>&nbsp;&nbsp;
License: <a href="https://www.programcreek.com/python?code=kp625544%2Fsubtake%2Fsubtake-master%2FLICENSE">GNU General Public License v2.0</a></td><td width="10%" align="right" style="padding-right:5px;font-size:14px;color:#08c"><span style="color:#08c" id="22068votes">5</span>
votes</td><td width="12%" align="right" style="padding-right:5px;font-size:14px"><span class="vote vote_down click_button" style="float:right;padding-bottom:-2px;border-radius:2px;border:1px solid #d8d8d8" id="22068"><img alt="vote down" src="data:image/svg+xml,%3Csvg%20xmlns=%22http://www.w3.org/2000/svg%22%20width=%2248%22%20height=%2248%22%3E%3C/svg%3E" width="26" ezimgfmt="rs rscb13 src ng ngcb13" class="ezlazyload" data-ezsrc="https://www.programcreek.com/common/static/images/dislike.png"></span>
<span class="vote vote_up click_button" style="float:left;padding-top:-2px;border-radius:2px;border:1px solid #d8d8d8" id="22068"><img alt="vote up" src="data:image/svg+xml,%3Csvg%20xmlns=%22http://www.w3.org/2000/svg%22%20width=%2248%22%20height=%2248%22%3E%3C/svg%3E" width="26" ezimgfmt="rs rscb13 src ng ngcb13" class="ezlazyload" data-ezsrc="https://www.programcreek.com/common/static/images/like.png"></span></td></tr></tbody></table></div><div class="exampleboxbody"><pre class="prettyprint"><span class="kwd"><span class="kwd">def</span></span><span class="pln"><span class="pln"> verify</span></span><span class="pun"><span class="pun">(</span></span><span class="kwd"><span class="kwd">self</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> nameserver_list</span></span><span class="pun"><span class="pun">):</span></span><span class="pln"><span class="pln">
        added_resolver </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> </span></span><span class="kwd"><span class="kwd">False</span></span><span class="pln"><span class="pln">
        </span></span><span class="kwd"><span class="kwd">for</span></span><span class="pln"><span class="pln"> server </span></span><span class="kwd"><span class="kwd">in</span></span><span class="pln"><span class="pln"> nameserver_list</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln">
            </span></span><span class="kwd"><span class="kwd">if</span></span><span class="pln"><span class="pln"> </span></span><span class="kwd"><span class="kwd">self</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">time_to_die</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln">
                </span></span><span class="com"><span class="com">#We are done here.</span></span><span class="pln"><span class="pln">
                </span></span><span class="kwd"><span class="kwd">break</span></span><span class="pln"><span class="pln">
            server </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> server</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">strip</span></span><span class="pun"><span class="pun">()</span></span><span class="pln"><span class="pln">
            </span></span><span class="kwd"><span class="kwd">if</span></span><span class="pln"><span class="pln"> server</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln">
                </span></span><span class="kwd"><span class="kwd">self</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">resolver</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">nameservers </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">[</span></span><span class="pln"><span class="pln">server</span></span><span class="pun"><span class="pun">]</span></span><span class="pln"><span class="pln">
                </span></span><span class="kwd"><span class="kwd">try</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln">
                    </span></span><span class="com"><span class="com">#test_result = self.resolver.</span><span class="highlight"><span class="com">query</span></span><span class="com">(self.most_popular_website, "A")</span></span><span class="pln"><span class="pln">
                    </span></span><span class="com"><span class="com">#should throw an exception before this line.</span></span><span class="pln"><span class="pln">
                    </span></span><span class="kwd"><span class="kwd">if</span></span><span class="pln"><span class="pln"> </span></span><span class="kwd"><span class="kwd">True</span></span><span class="pun"><span class="pun">:</span></span><span class="com"><span class="com">#test_result:</span></span><span class="pln"><span class="pln">
                        </span></span><span class="com"><span class="com">#Only add the nameserver to the queue if we can detect wildcards. </span></span><span class="pln"><span class="pln">
                        </span></span><span class="kwd"><span class="kwd">if</span></span><span class="pun"><span class="pun">(</span></span><span class="kwd"><span class="kwd">self</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">find_wildcards</span></span><span class="pun"><span class="pun">(</span></span><span class="kwd"><span class="kwd">self</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">target</span></span><span class="pun"><span class="pun">)):</span></span><span class="com"><span class="com"># and self.find_wildcards(".com")</span></span><span class="pln"><span class="pln">
                            </span></span><span class="com"><span class="com">#wildcards have been added to the set, it is now safe to be added to the queue.</span></span><span class="pln"><span class="pln">
                            </span></span><span class="com"><span class="com">#blocking queue,  this process will halt on put() when the queue is full:</span></span><span class="pln"><span class="pln">
                            </span></span><span class="kwd"><span class="kwd">self</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">add_nameserver</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">server</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln">
                            added_resolver </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> </span></span><span class="kwd"><span class="kwd">True</span></span><span class="pln"><span class="pln">
                        </span></span><span class="kwd"><span class="kwd">else</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln">
                            trace</span></span><span class="pun"><span class="pun">(</span></span><span class="str"><span class="str">"Rejected nameserver - wildcard:"</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> server</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln">
                </span></span><span class="kwd"><span class="kwd">except</span></span><span class="pln"><span class="pln"> </span></span><span class="typ"><span class="typ">Exception</span></span><span class="pln"><span class="pln"> </span></span><span class="kwd"><span class="kwd">as</span></span><span class="pln"><span class="pln"> e</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln">
                    </span></span><span class="com"><span class="com">#Rejected server :(</span></span><span class="pln"><span class="pln">
                    trace</span></span><span class="pun"><span class="pun">(</span></span><span class="str"><span class="str">"Rejected nameserver - unreliable:"</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> server</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> type</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">e</span></span><span class="pun"><span class="pun">))</span></span><span class="pln"><span class="pln"> 
        </span></span><span class="kwd"><span class="kwd">return</span></span><span class="pln"><span class="pln"> added_resolver </span></span></pre></div></div><div style="margin:20px 2px;color:#424345;font-weight:700">Example #19</div><div class="examplebox"><div class="exampleboxheader"><table width="100%"><tbody><tr><td width="80%" style="padding:2px;font-size:14px;line-height:25px">Source Project:
<a href="https://www.programcreek.com/python/?project_name=al0ne%2FVxscan"><span style="font-style:italic">Vxscan</span>&nbsp;&nbsp;</a>
Author: <span style="font-style:italic">al0ne</span>&nbsp;&nbsp;
File: <a href="https://www.programcreek.com/python?code=al0ne%2FVxscan%2FVxscan-master%2Flib%2Furl.py">url.py </a>&nbsp;&nbsp;
License: <a href="https://www.programcreek.com/python?code=al0ne%2FVxscan%2FVxscan-master%2FLICENSE">Apache License 2.0</a></td><td width="10%" align="right" style="padding-right:5px;font-size:14px;color:#08c"><span style="color:#08c" id="38928votes">5</span>
votes</td><td width="12%" align="right" style="padding-right:5px;font-size:14px"><span class="vote vote_down click_button" style="float:right;padding-bottom:-2px;border-radius:2px;border:1px solid #d8d8d8" id="38928"><img alt="vote down" src="data:image/svg+xml,%3Csvg%20xmlns=%22http://www.w3.org/2000/svg%22%20width=%2248%22%20height=%2248%22%3E%3C/svg%3E" width="26" ezimgfmt="rs rscb13 src ng ngcb13" class="ezlazyload" data-ezsrc="https://www.programcreek.com/common/static/images/dislike.png"></span>
<span class="vote vote_up click_button" style="float:left;padding-top:-2px;border-radius:2px;border:1px solid #d8d8d8" id="38928"><img alt="vote up" src="data:image/svg+xml,%3Csvg%20xmlns=%22http://www.w3.org/2000/svg%22%20width=%2248%22%20height=%2248%22%3E%3C/svg%3E" width="26" ezimgfmt="rs rscb13 src ng ngcb13" class="ezlazyload" data-ezsrc="https://www.programcreek.com/common/static/images/like.png"></span></td></tr></tbody></table></div><div class="exampleboxbody"><pre class="prettyprint"><span class="kwd"><span class="kwd">def</span></span><span class="pln"><span class="pln"> diff</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">urls</span></span><span class="pun"><span class="pun">):</span></span><span class="pln"><span class="pln">
    parms </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">[]</span></span><span class="pln"><span class="pln">
    host </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">[]</span></span><span class="pln"><span class="pln">
    result </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">[]</span></span><span class="pln"><span class="pln">
    path </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">[]</span></span><span class="pln"><span class="pln">
    </span></span><span class="com"><span class="com"># url = 'https://www.xxx.com/?page=1</span></span><span class="pln"><span class="pln">
    </span></span><span class="com"><span class="com"># 伪静态去重 通过urlparse取出来page=1,根据逗号拆分取出来k=page，然后保存不重复的k</span></span><span class="pln"><span class="pln">
    </span></span><span class="kwd"><span class="kwd">for</span></span><span class="pln"><span class="pln"> i </span></span><span class="kwd"><span class="kwd">in</span></span><span class="pln"><span class="pln"> urls</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln">
        url </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> parse</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">urlparse</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">i</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln">
        </span></span><span class="kwd"><span class="kwd">print</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">url</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln">
        k</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> v</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">*</span></span><span class="pln"><span class="pln">_ </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> url</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="highlight"><span class="pln">query</span></span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">split</span></span><span class="pun"><span class="pun">(</span></span><span class="str"><span class="str">'='</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln">
        </span></span><span class="kwd"><span class="kwd">if</span></span><span class="pln"><span class="pln"> url</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">netloc </span></span><span class="kwd"><span class="kwd">in</span></span><span class="pln"><span class="pln"> host</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln">
            </span></span><span class="kwd"><span class="kwd">if</span></span><span class="pln"><span class="pln"> url</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">path </span></span><span class="kwd"><span class="kwd">in</span></span><span class="pln"><span class="pln"> path</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln">
                </span></span><span class="kwd"><span class="kwd">if</span></span><span class="pln"><span class="pln"> k </span></span><span class="kwd"><span class="kwd">not</span></span><span class="pln"><span class="pln"> </span></span><span class="kwd"><span class="kwd">in</span></span><span class="pln"><span class="pln"> parms</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln">
                    parms</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">append</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">k</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln">
                    result</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">append</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">i</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln">
            </span></span><span class="kwd"><span class="kwd">else</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln">
                result</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">append</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">i</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln">
                path</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">append</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">url</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">path</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln">
        </span></span><span class="kwd"><span class="kwd">else</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln">
            host</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">append</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">url</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">netloc</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln">
            result</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">append</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">i</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln">
            path</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">append</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">url</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">path</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln">
            parms</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">append</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">k</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln">

    </span></span><span class="kwd"><span class="kwd">return</span></span><span class="pln"><span class="pln"> result </span></span></pre></div></div><div style="margin:20px 2px;color:#424345;font-weight:700">Example #20</div><div class="examplebox"><div class="exampleboxheader"><table width="100%"><tbody><tr><td width="80%" style="padding:2px;font-size:14px;line-height:25px">Source Project:
<a href="https://www.programcreek.com/python/?project_name=PrivacyScore%2FPrivacyScore"><span style="font-style:italic">PrivacyScore</span>&nbsp;&nbsp;</a>
Author: <span style="font-style:italic">PrivacyScore</span>&nbsp;&nbsp;
File: <a href="https://www.programcreek.com/python?code=PrivacyScore%2FPrivacyScore%2FPrivacyScore-master%2Fprivacyscore%2Ftest_suites%2Fnetwork.py">network.py </a>&nbsp;&nbsp;
License: <a href="https://www.programcreek.com/python?code=PrivacyScore%2FPrivacyScore%2FPrivacyScore-master%2FLICENSE">GNU General Public License v3.0</a></td><td width="10%" align="right" style="padding-right:5px;font-size:14px;color:#08c"><span style="color:#08c" id="131388votes">5</span>
votes</td><td width="12%" align="right" style="padding-right:5px;font-size:14px"><span class="vote vote_down click_button" style="float:right;padding-bottom:-2px;border-radius:2px;border:1px solid #d8d8d8" id="131388"><img alt="vote down" src="data:image/svg+xml,%3Csvg%20xmlns=%22http://www.w3.org/2000/svg%22%20width=%2248%22%20height=%2248%22%3E%3C/svg%3E" width="26" ezimgfmt="rs rscb13 src ng ngcb13" class="ezlazyload" data-ezsrc="https://www.programcreek.com/common/static/images/dislike.png"></span>
<span class="vote vote_up click_button" style="float:left;padding-top:-2px;border-radius:2px;border:1px solid #d8d8d8" id="131388"><img alt="vote up" src="data:image/svg+xml,%3Csvg%20xmlns=%22http://www.w3.org/2000/svg%22%20width=%2248%22%20height=%2248%22%3E%3C/svg%3E" width="26" ezimgfmt="rs rscb13 src ng ngcb13" class="ezlazyload" data-ezsrc="https://www.programcreek.com/common/static/images/like.png"></span></td></tr></tbody></table></div><div class="exampleboxbody"><pre class="prettyprint"><span class="kwd"><span class="kwd">def</span></span><span class="pln"><span class="pln"> _a_lookup</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">name</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln"> str</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">-&gt;</span></span><span class="pln"><span class="pln"> </span></span><span class="typ"><span class="typ">List</span></span><span class="pun"><span class="pun">[</span></span><span class="pln"><span class="pln">str</span></span><span class="pun"><span class="pun">]:</span></span><span class="pln"><span class="pln">
    </span></span><span class="kwd"><span class="kwd">try</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln">
        </span></span><span class="kwd"><span class="kwd">return</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">[</span></span><span class="pln"><span class="pln">e</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">address </span></span><span class="kwd"><span class="kwd">for</span></span><span class="pln"><span class="pln"> e </span></span><span class="kwd"><span class="kwd">in</span></span><span class="pln"><span class="pln"> resolver</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="highlight"><span class="pln">query</span></span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">name</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">'A'</span></span><span class="pun"><span class="pun">)]</span></span><span class="pln"><span class="pln">
    </span></span><span class="kwd"><span class="kwd">except</span></span><span class="pln"><span class="pln"> </span></span><span class="typ"><span class="typ">DNSException</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln">
        </span></span><span class="kwd"><span class="kwd">return</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">[]</span></span><span class="pln"><span class="pln"> </span></span></pre></div></div><div style="margin:20px 2px;color:#424345;font-weight:700">Example #21</div><div class="examplebox"><div class="exampleboxheader"><table width="100%"><tbody><tr><td width="80%" style="padding:2px;font-size:14px;line-height:25px">Source Project:
<a href="https://www.programcreek.com/python/?project_name=PrivacyScore%2FPrivacyScore"><span style="font-style:italic">PrivacyScore</span>&nbsp;&nbsp;</a>
Author: <span style="font-style:italic">PrivacyScore</span>&nbsp;&nbsp;
File: <a href="https://www.programcreek.com/python?code=PrivacyScore%2FPrivacyScore%2FPrivacyScore-master%2Fprivacyscore%2Ftest_suites%2Fnetwork.py">network.py </a>&nbsp;&nbsp;
License: <a href="https://www.programcreek.com/python?code=PrivacyScore%2FPrivacyScore%2FPrivacyScore-master%2FLICENSE">GNU General Public License v3.0</a></td><td width="10%" align="right" style="padding-right:5px;font-size:14px;color:#08c"><span style="color:#08c" id="131389votes">5</span>
votes</td><td width="12%" align="right" style="padding-right:5px;font-size:14px"><span class="vote vote_down click_button" style="float:right;padding-bottom:-2px;border-radius:2px;border:1px solid #d8d8d8" id="131389"><img alt="vote down" src="data:image/svg+xml,%3Csvg%20xmlns=%22http://www.w3.org/2000/svg%22%20width=%2248%22%20height=%2248%22%3E%3C/svg%3E" width="26" ezimgfmt="rs rscb13 src ng ngcb13" class="ezlazyload" data-ezsrc="https://www.programcreek.com/common/static/images/dislike.png"></span>
<span class="vote vote_up click_button" style="float:left;padding-top:-2px;border-radius:2px;border:1px solid #d8d8d8" id="131389"><img alt="vote up" src="data:image/svg+xml,%3Csvg%20xmlns=%22http://www.w3.org/2000/svg%22%20width=%2248%22%20height=%2248%22%3E%3C/svg%3E" width="26" ezimgfmt="rs rscb13 src ng ngcb13" class="ezlazyload" data-ezsrc="https://www.programcreek.com/common/static/images/like.png"></span></td></tr></tbody></table></div><div class="exampleboxbody"><pre class="prettyprint"><span class="kwd"><span class="kwd">def</span></span><span class="pln"><span class="pln"> _cname_lookup</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">name</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln"> str</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">-&gt;</span></span><span class="pln"><span class="pln"> </span></span><span class="typ"><span class="typ">List</span></span><span class="pun"><span class="pun">[</span></span><span class="pln"><span class="pln">str</span></span><span class="pun"><span class="pun">]:</span></span><span class="pln"><span class="pln">
    </span></span><span class="kwd"><span class="kwd">try</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln">
        </span></span><span class="kwd"><span class="kwd">return</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">[</span></span><span class="pln"><span class="pln">e</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">to_text</span></span><span class="pun"><span class="pun">()[:-</span></span><span class="lit"><span class="lit">1</span></span><span class="pun"><span class="pun">].</span></span><span class="pln"><span class="pln">lower</span></span><span class="pun"><span class="pun">()</span></span><span class="pln"><span class="pln"> </span></span><span class="kwd"><span class="kwd">for</span></span><span class="pln"><span class="pln"> e </span></span><span class="kwd"><span class="kwd">in</span></span><span class="pln"><span class="pln"> resolver</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="highlight"><span class="pln">query</span></span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">name</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">'CNAME'</span></span><span class="pun"><span class="pun">)]</span></span><span class="pln"><span class="pln">
    </span></span><span class="kwd"><span class="kwd">except</span></span><span class="pln"><span class="pln"> </span></span><span class="typ"><span class="typ">DNSException</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln">
        </span></span><span class="kwd"><span class="kwd">return</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">[]</span></span><span class="pln"><span class="pln"> </span></span></pre></div></div><div style="margin:20px 2px;color:#424345;font-weight:700">Example #22</div><div class="examplebox"><div class="exampleboxheader"><table width="100%"><tbody><tr><td width="80%" style="padding:2px;font-size:14px;line-height:25px">Source Project:
<a href="https://www.programcreek.com/python/?project_name=PrivacyScore%2FPrivacyScore"><span style="font-style:italic">PrivacyScore</span>&nbsp;&nbsp;</a>
Author: <span style="font-style:italic">PrivacyScore</span>&nbsp;&nbsp;
File: <a href="https://www.programcreek.com/python?code=PrivacyScore%2FPrivacyScore%2FPrivacyScore-master%2Fprivacyscore%2Ftest_suites%2Fnetwork.py">network.py </a>&nbsp;&nbsp;
License: <a href="https://www.programcreek.com/python?code=PrivacyScore%2FPrivacyScore%2FPrivacyScore-master%2FLICENSE">GNU General Public License v3.0</a></td><td width="10%" align="right" style="padding-right:5px;font-size:14px;color:#08c"><span style="color:#08c" id="131390votes">5</span>
votes</td><td width="12%" align="right" style="padding-right:5px;font-size:14px"><span class="vote vote_down click_button" style="float:right;padding-bottom:-2px;border-radius:2px;border:1px solid #d8d8d8" id="131390"><img alt="vote down" src="data:image/svg+xml,%3Csvg%20xmlns=%22http://www.w3.org/2000/svg%22%20width=%2248%22%20height=%2248%22%3E%3C/svg%3E" width="26" ezimgfmt="rs rscb13 src ng ngcb13" class="ezlazyload" data-ezsrc="https://www.programcreek.com/common/static/images/dislike.png"></span>
<span class="vote vote_up click_button" style="float:left;padding-top:-2px;border-radius:2px;border:1px solid #d8d8d8" id="131390"><img alt="vote up" src="data:image/svg+xml,%3Csvg%20xmlns=%22http://www.w3.org/2000/svg%22%20width=%2248%22%20height=%2248%22%3E%3C/svg%3E" width="26" ezimgfmt="rs rscb13 src ng ngcb13" class="ezlazyload" data-ezsrc="https://www.programcreek.com/common/static/images/like.png"></span></td></tr></tbody></table></div><div class="exampleboxbody"><pre class="prettyprint"><span class="kwd"><span class="kwd">def</span></span><span class="pln"><span class="pln"> _mx_lookup</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">name</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln"> str</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">-&gt;</span></span><span class="pln"><span class="pln"> </span></span><span class="typ"><span class="typ">List</span></span><span class="pun"><span class="pun">[</span></span><span class="pln"><span class="pln">str</span></span><span class="pun"><span class="pun">]:</span></span><span class="pln"><span class="pln">
    </span></span><span class="kwd"><span class="kwd">try</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln">
        </span></span><span class="kwd"><span class="kwd">return</span></span><span class="pln"><span class="pln"> sorted</span></span><span class="pun"><span class="pun">([(</span></span><span class="pln"><span class="pln">e</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">preference</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> e</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">exchange</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">to_text</span></span><span class="pun"><span class="pun">()[:-</span></span><span class="lit"><span class="lit">1</span></span><span class="pun"><span class="pun">].</span></span><span class="pln"><span class="pln">lower</span></span><span class="pun"><span class="pun">())</span></span><span class="pln"><span class="pln">
                       </span></span><span class="kwd"><span class="kwd">for</span></span><span class="pln"><span class="pln"> e </span></span><span class="kwd"><span class="kwd">in</span></span><span class="pln"><span class="pln"> resolver</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="highlight"><span class="pln">query</span></span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">name</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">'MX'</span></span><span class="pun"><span class="pun">)],</span></span><span class="pln"><span class="pln"> key</span></span><span class="pun"><span class="pun">=</span></span><span class="kwd"><span class="kwd">lambda</span></span><span class="pln"><span class="pln"> v</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln"> v</span></span><span class="pun"><span class="pun">[</span></span><span class="lit"><span class="lit">0</span></span><span class="pun"><span class="pun">])</span></span><span class="pln"><span class="pln">
    </span></span><span class="kwd"><span class="kwd">except</span></span><span class="pln"><span class="pln"> </span></span><span class="typ"><span class="typ">DNSException</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln">
        </span></span><span class="kwd"><span class="kwd">return</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">[]</span></span><span class="pln"><span class="pln"> </span></span></pre></div></div><div style="margin:20px 2px;color:#424345;font-weight:700">Example #23</div><div class="examplebox"><div class="exampleboxheader"><table width="100%"><tbody><tr><td width="80%" style="padding:2px;font-size:14px;line-height:25px">Source Project:
<a href="https://www.programcreek.com/python/?project_name=PrivacyScore%2FPrivacyScore"><span style="font-style:italic">PrivacyScore</span>&nbsp;&nbsp;</a>
Author: <span style="font-style:italic">PrivacyScore</span>&nbsp;&nbsp;
File: <a href="https://www.programcreek.com/python?code=PrivacyScore%2FPrivacyScore%2FPrivacyScore-master%2Fprivacyscore%2Ftest_suites%2Fnetwork.py">network.py </a>&nbsp;&nbsp;
License: <a href="https://www.programcreek.com/python?code=PrivacyScore%2FPrivacyScore%2FPrivacyScore-master%2FLICENSE">GNU General Public License v3.0</a></td><td width="10%" align="right" style="padding-right:5px;font-size:14px;color:#08c"><span style="color:#08c" id="131391votes">5</span>
votes</td><td width="12%" align="right" style="padding-right:5px;font-size:14px"><span class="vote vote_down click_button" style="float:right;padding-bottom:-2px;border-radius:2px;border:1px solid #d8d8d8" id="131391"><img alt="vote down" src="data:image/svg+xml,%3Csvg%20xmlns=%22http://www.w3.org/2000/svg%22%20width=%2248%22%20height=%2248%22%3E%3C/svg%3E" width="26" ezimgfmt="rs rscb13 src ng ngcb13" class="ezlazyload" data-ezsrc="https://www.programcreek.com/common/static/images/dislike.png"></span>
<span class="vote vote_up click_button" style="float:left;padding-top:-2px;border-radius:2px;border:1px solid #d8d8d8" id="131391"><img alt="vote up" src="data:image/svg+xml,%3Csvg%20xmlns=%22http://www.w3.org/2000/svg%22%20width=%2248%22%20height=%2248%22%3E%3C/svg%3E" width="26" ezimgfmt="rs rscb13 src ng ngcb13" class="ezlazyload" data-ezsrc="https://www.programcreek.com/common/static/images/like.png"></span></td></tr></tbody></table></div><div class="exampleboxbody"><pre class="prettyprint"><span class="kwd"><span class="kwd">def</span></span><span class="pln"><span class="pln"> _reverse_lookup</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">ip</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln"> str</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">-&gt;</span></span><span class="pln"><span class="pln"> </span></span><span class="typ"><span class="typ">List</span></span><span class="pun"><span class="pun">[</span></span><span class="pln"><span class="pln">str</span></span><span class="pun"><span class="pun">]:</span></span><span class="pln"><span class="pln">
    </span></span><span class="kwd"><span class="kwd">try</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln">
        address </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> reversename</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">from_address</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">ip</span></span><span class="pun"><span class="pun">).</span></span><span class="pln"><span class="pln">to_text</span></span><span class="pun"><span class="pun">()</span></span><span class="pln"><span class="pln">
        </span></span><span class="kwd"><span class="kwd">return</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">[</span></span><span class="pln"><span class="pln">rev</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">to_text</span></span><span class="pun"><span class="pun">()[:-</span></span><span class="lit"><span class="lit">1</span></span><span class="pun"><span class="pun">].</span></span><span class="pln"><span class="pln">lower</span></span><span class="pun"><span class="pun">()</span></span><span class="pln"><span class="pln">
                </span></span><span class="kwd"><span class="kwd">for</span></span><span class="pln"><span class="pln"> rev </span></span><span class="kwd"><span class="kwd">in</span></span><span class="pln"><span class="pln"> resolver</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="highlight"><span class="pln">query</span></span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">address</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">'PTR'</span></span><span class="pun"><span class="pun">)]</span></span><span class="pln"><span class="pln">
    </span></span><span class="kwd"><span class="kwd">except</span></span><span class="pln"><span class="pln"> </span></span><span class="typ"><span class="typ">DNSException</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln">
        </span></span><span class="kwd"><span class="kwd">return</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">[]</span></span><span class="pln"><span class="pln"> </span></span></pre></div></div><div style="margin:20px 2px;color:#424345;font-weight:700">Example #24</div><div class="examplebox"><div class="exampleboxheader"><table width="100%"><tbody><tr><td width="80%" style="padding:2px;font-size:14px;line-height:25px">Source Project:
<a href="https://www.programcreek.com/python/?project_name=lucasayres%2Fpython-tools"><span style="font-style:italic">python-tools</span>&nbsp;&nbsp;</a>
Author: <span style="font-style:italic">lucasayres</span>&nbsp;&nbsp;
File: <a href="https://www.programcreek.com/python?code=lucasayres%2Fpython-tools%2Fpython-tools-master%2Ftools%2Fwhois.py">whois.py </a>&nbsp;&nbsp;
License: <a href="https://www.programcreek.com/python?code=lucasayres%2Fpython-tools%2Fpython-tools-master%2FLICENSE">MIT License</a></td><td width="10%" align="right" style="padding-right:5px;font-size:14px;color:#08c"><span style="color:#08c" id="190947votes">5</span>
votes</td><td width="12%" align="right" style="padding-right:5px;font-size:14px"><span class="vote vote_down click_button" style="float:right;padding-bottom:-2px;border-radius:2px;border:1px solid #d8d8d8" id="190947"><img alt="vote down" src="data:image/svg+xml,%3Csvg%20xmlns=%22http://www.w3.org/2000/svg%22%20width=%2248%22%20height=%2248%22%3E%3C/svg%3E" width="26" ezimgfmt="rs rscb13 src ng ngcb13" class="ezlazyload" data-ezsrc="https://www.programcreek.com/common/static/images/dislike.png"></span>
<span class="vote vote_up click_button" style="float:left;padding-top:-2px;border-radius:2px;border:1px solid #d8d8d8" id="190947"><img alt="vote up" src="data:image/svg+xml,%3Csvg%20xmlns=%22http://www.w3.org/2000/svg%22%20width=%2248%22%20height=%2248%22%3E%3C/svg%3E" width="26" ezimgfmt="rs rscb13 src ng ngcb13" class="ezlazyload" data-ezsrc="https://www.programcreek.com/common/static/images/like.png"></span></td></tr></tbody></table></div><div class="exampleboxbody"><pre class="prettyprint"><span class="kwd"><span class="kwd">def</span></span><span class="pln"><span class="pln"> whois</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">url</span></span><span class="pun"><span class="pun">):</span></span><span class="pln"><span class="pln">
    </span></span><span class="str"><span class="str">"""Get WHOIS from IP address or hostname.

    Args:
        url (str): IP address or hostname.

    Returns:
        dict: Return a JSON object with the WHOIS.

    """</span></span><span class="pln"><span class="pln">
    url </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> url</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">strip</span></span><span class="pun"><span class="pun">()</span></span><span class="pln"><span class="pln">
    </span></span><span class="kwd"><span class="kwd">if</span></span><span class="pln"><span class="pln"> </span></span><span class="kwd"><span class="kwd">not</span></span><span class="pln"><span class="pln"> parse</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">urlparse</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">url</span></span><span class="pun"><span class="pun">).</span></span><span class="pln"><span class="pln">scheme</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln">
        url </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">'http://'</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">+</span></span><span class="pln"><span class="pln"> url
    host </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> parse</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">urlparse</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">url</span></span><span class="pun"><span class="pun">).</span></span><span class="pln"><span class="pln">netloc
    </span></span><span class="kwd"><span class="kwd">try</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln">
        ipaddress</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">ip_address</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">host</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln">
        ip </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> host
    </span></span><span class="kwd"><span class="kwd">except</span></span><span class="pln"><span class="pln"> </span></span><span class="typ"><span class="typ">Exception</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln">
        </span></span><span class="kwd"><span class="kwd">try</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln">
            ips </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> resolver</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="highlight"><span class="pln">query</span></span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">host</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">'A'</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln">
            ip </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> ips</span></span><span class="pun"><span class="pun">[</span></span><span class="lit"><span class="lit">0</span></span><span class="pun"><span class="pun">]</span></span><span class="pln"><span class="pln">
        </span></span><span class="kwd"><span class="kwd">except</span></span><span class="pln"><span class="pln"> </span></span><span class="typ"><span class="typ">Exception</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln">
            </span></span><span class="kwd"><span class="kwd">return</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">{}</span></span><span class="pln"><span class="pln">

    obj </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> </span></span><span class="typ"><span class="typ">IPWhois</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">ip</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln">
    </span></span><span class="kwd"><span class="kwd">return</span></span><span class="pln"><span class="pln"> obj</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">lookup_whois</span></span><span class="pun"><span class="pun">()</span></span><span class="pln"><span class="pln"> </span></span></pre></div></div><div style="margin:20px 2px;color:#424345;font-weight:700">Example #25</div><div class="examplebox"><div class="exampleboxheader"><table width="100%"><tbody><tr><td width="80%" style="padding:2px;font-size:14px;line-height:25px">Source Project:
<a href="https://www.programcreek.com/python/?project_name=FeeiCN%2FESD"><span style="font-style:italic">ESD</span>&nbsp;&nbsp;</a>
Author: <span style="font-style:italic">FeeiCN</span>&nbsp;&nbsp;
File: <a href="https://www.programcreek.com/python?code=FeeiCN%2FESD%2FESD-master%2FESD%2F__init__.py">__init__.py </a>&nbsp;&nbsp;
License: <a href="https://www.programcreek.com/python?code=FeeiCN%2FESD%2FESD-master%2FLICENSE">GNU General Public License v3.0</a></td><td width="10%" align="right" style="padding-right:5px;font-size:14px;color:#08c"><span style="color:#08c" id="195050votes">5</span>
votes</td><td width="12%" align="right" style="padding-right:5px;font-size:14px"><span class="vote vote_down click_button" style="float:right;padding-bottom:-2px;border-radius:2px;border:1px solid #d8d8d8" id="195050"><img alt="vote down" src="data:image/svg+xml,%3Csvg%20xmlns=%22http://www.w3.org/2000/svg%22%20width=%2248%22%20height=%2248%22%3E%3C/svg%3E" width="26" ezimgfmt="rs rscb13 src ng ngcb13" class="ezlazyload" data-ezsrc="https://www.programcreek.com/common/static/images/dislike.png"></span>
<span class="vote vote_up click_button" style="float:left;padding-top:-2px;border-radius:2px;border:1px solid #d8d8d8" id="195050"><img alt="vote up" src="data:image/svg+xml,%3Csvg%20xmlns=%22http://www.w3.org/2000/svg%22%20width=%2248%22%20height=%2248%22%3E%3C/svg%3E" width="26" ezimgfmt="rs rscb13 src ng ngcb13" class="ezlazyload" data-ezsrc="https://www.programcreek.com/common/static/images/like.png"></span></td></tr></tbody></table></div><div class="exampleboxbody"><pre class="prettyprint"><span class="kwd"><span class="kwd">def</span></span><span class="pln"><span class="pln"> dns_resolve</span></span><span class="pun"><span class="pun">(</span></span><span class="kwd"><span class="kwd">self</span></span><span class="pun"><span class="pun">):</span></span><span class="pln"><span class="pln">
        padding_domain </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">'www.'</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">+</span></span><span class="pln"><span class="pln"> </span></span><span class="kwd"><span class="kwd">self</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">domain
        </span></span><span class="com"><span class="com"># loop = asyncio.get_event_loop()</span></span><span class="pln"><span class="pln">
        loop </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> asyncio</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">new_event_loop</span></span><span class="pun"><span class="pun">()</span></span><span class="pln"><span class="pln">
        asyncio</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">set_event_loop</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">loop</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln">
        resolver </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> aiodns</span></span><span class="pun"><span class="pun">.</span></span><span class="typ"><span class="typ">DNSResolver</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">loop</span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln">loop</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln">
        f </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> resolver</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="highlight"><span class="pln">query</span></span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">padding_domain</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">'A'</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln">
        result </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> loop</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">run_until_complete</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">f</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln">
        </span></span><span class="kwd"><span class="kwd">return</span></span><span class="pln"><span class="pln"> result</span></span><span class="pun"><span class="pun">[</span></span><span class="lit"><span class="lit">0</span></span><span class="pun"><span class="pun">].</span></span><span class="pln"><span class="pln">host </span></span></pre></div></div><div style="margin:20px 2px;color:#424345;font-weight:700">Example #26</div><div class="examplebox"><div class="exampleboxheader"><table width="100%"><tbody><tr><td width="80%" style="padding:2px;font-size:14px;line-height:25px">Source Project:
<a href="https://www.programcreek.com/python/?project_name=FeeiCN%2FESD"><span style="font-style:italic">ESD</span>&nbsp;&nbsp;</a>
Author: <span style="font-style:italic">FeeiCN</span>&nbsp;&nbsp;
File: <a href="https://www.programcreek.com/python?code=FeeiCN%2FESD%2FESD-master%2FESD%2F__init__.py">__init__.py </a>&nbsp;&nbsp;
License: <a href="https://www.programcreek.com/python?code=FeeiCN%2FESD%2FESD-master%2FLICENSE">GNU General Public License v3.0</a></td><td width="10%" align="right" style="padding-right:5px;font-size:14px;color:#08c"><span style="color:#08c" id="195054votes">5</span>
votes</td><td width="12%" align="right" style="padding-right:5px;font-size:14px"><span class="vote vote_down click_button" style="float:right;padding-bottom:-2px;border-radius:2px;border:1px solid #d8d8d8" id="195054"><img alt="vote down" src="data:image/svg+xml,%3Csvg%20xmlns=%22http://www.w3.org/2000/svg%22%20width=%2248%22%20height=%2248%22%3E%3C/svg%3E" width="26" ezimgfmt="rs rscb13 src ng ngcb13" class="ezlazyload" data-ezsrc="https://www.programcreek.com/common/static/images/dislike.png"></span>
<span class="vote vote_up click_button" style="float:left;padding-top:-2px;border-radius:2px;border:1px solid #d8d8d8" id="195054"><img alt="vote up" src="data:image/svg+xml,%3Csvg%20xmlns=%22http://www.w3.org/2000/svg%22%20width=%2248%22%20height=%2248%22%3E%3C/svg%3E" width="26" ezimgfmt="rs rscb13 src ng ngcb13" class="ezlazyload" data-ezsrc="https://www.programcreek.com/common/static/images/like.png"></span></td></tr></tbody></table></div><div class="exampleboxbody"><pre class="prettyprint"><span class="kwd"><span class="kwd">def</span></span><span class="pln"><span class="pln"> __init__</span></span><span class="pun"><span class="pun">(</span></span><span class="kwd"><span class="kwd">self</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> domain</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> zoomeye_struct</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> conf</span></span><span class="pun"><span class="pun">):</span></span><span class="pln"><span class="pln">
        </span></span><span class="kwd"><span class="kwd">self</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">headers </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">{</span></span><span class="pln"><span class="pln">
            </span></span><span class="str"><span class="str">"Authorization"</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">"JWT {token}"</span></span><span class="pln"><span class="pln">
        </span></span><span class="pun"><span class="pun">}</span></span><span class="pln"><span class="pln">
        </span></span><span class="kwd"><span class="kwd">self</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">url </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">'https://api.zoomeye.org/web/search?</span><span class="highlight"><span class="str">query</span></span><span class="str">=site:{domain}&amp;page={num}'</span></span><span class="pln"><span class="pln">
        </span></span><span class="kwd"><span class="kwd">self</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">domain </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> domain
        </span></span><span class="kwd"><span class="kwd">self</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">zoomeye_struct </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> zoomeye_struct
        </span></span><span class="kwd"><span class="kwd">self</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">conf </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> conf </span></span></pre></div></div><div style="margin:20px 2px;color:#424345;font-weight:700">Example #27</div><div class="examplebox"><div class="exampleboxheader"><table width="100%"><tbody><tr><td width="80%" style="padding:2px;font-size:14px;line-height:25px">Source Project:
<a href="https://www.programcreek.com/python/?project_name=birforce%2Fvnpy_crypto"><span style="font-style:italic">vnpy_crypto</span>&nbsp;&nbsp;</a>
Author: <span style="font-style:italic">birforce</span>&nbsp;&nbsp;
File: <a href="https://www.programcreek.com/python?code=birforce%2Fvnpy_crypto%2Fvnpy_crypto-master%2Fvenv%2Flib%2Fpython3.6%2Fsite-packages%2Fpymongo%2Furi_parser.py">uri_parser.py </a>&nbsp;&nbsp;
License: <a href="https://www.programcreek.com/python?code=birforce%2Fvnpy_crypto%2Fvnpy_crypto-master%2FLICENSE">MIT License</a></td><td width="10%" align="right" style="padding-right:5px;font-size:14px;color:#08c"><span style="color:#08c" id="210375votes">5</span>
votes</td><td width="12%" align="right" style="padding-right:5px;font-size:14px"><span class="vote vote_down click_button" style="float:right;padding-bottom:-2px;border-radius:2px;border:1px solid #d8d8d8" id="210375"><img alt="vote down" src="data:image/svg+xml,%3Csvg%20xmlns=%22http://www.w3.org/2000/svg%22%20width=%2248%22%20height=%2248%22%3E%3C/svg%3E" width="26" ezimgfmt="rs rscb13 src ng ngcb13" class="ezlazyload" data-ezsrc="https://www.programcreek.com/common/static/images/dislike.png"></span>
<span class="vote vote_up click_button" style="float:left;padding-top:-2px;border-radius:2px;border:1px solid #d8d8d8" id="210375"><img alt="vote up" src="data:image/svg+xml,%3Csvg%20xmlns=%22http://www.w3.org/2000/svg%22%20width=%2248%22%20height=%2248%22%3E%3C/svg%3E" width="26" ezimgfmt="rs rscb13 src ng ngcb13" class="ezlazyload" data-ezsrc="https://www.programcreek.com/common/static/images/like.png"></span></td></tr></tbody></table></div><div class="exampleboxbody"><pre class="prettyprint"><span class="kwd"><span class="kwd">def</span></span><span class="pln"><span class="pln"> _get_dns_srv_hosts</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">hostname</span></span><span class="pun"><span class="pun">):</span></span><span class="pln"><span class="pln">
    </span></span><span class="kwd"><span class="kwd">try</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln">
        results </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> resolver</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="highlight"><span class="pln">query</span></span></span><span class="pun"><span class="pun">(</span></span><span class="str"><span class="str">'_mongodb._tcp.'</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">+</span></span><span class="pln"><span class="pln"> hostname</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">'SRV'</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln">
    </span></span><span class="kwd"><span class="kwd">except</span></span><span class="pln"><span class="pln"> </span></span><span class="typ"><span class="typ">Exception</span></span><span class="pln"><span class="pln"> </span></span><span class="kwd"><span class="kwd">as</span></span><span class="pln"><span class="pln"> exc</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln">
        </span></span><span class="kwd"><span class="kwd">raise</span></span><span class="pln"><span class="pln"> </span></span><span class="typ"><span class="typ">ConfigurationError</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">str</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">exc</span></span><span class="pun"><span class="pun">))</span></span><span class="pln"><span class="pln">
    </span></span><span class="kwd"><span class="kwd">return</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">[(</span></span><span class="pln"><span class="pln">maybe_decode</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">res</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">target</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">to_text</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">omit_final_dot</span></span><span class="pun"><span class="pun">=</span></span><span class="kwd"><span class="kwd">True</span></span><span class="pun"><span class="pun">)),</span></span><span class="pln"><span class="pln"> res</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">port</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln">
            </span></span><span class="kwd"><span class="kwd">for</span></span><span class="pln"><span class="pln"> res </span></span><span class="kwd"><span class="kwd">in</span></span><span class="pln"><span class="pln"> results</span></span><span class="pun"><span class="pun">]</span></span><span class="pln"><span class="pln"> </span></span></pre></div></div><div style="margin:20px 2px;color:#424345;font-weight:700">Example #28</div><div class="examplebox"><div class="exampleboxheader"><table width="100%"><tbody><tr><td width="80%" style="padding:2px;font-size:14px;line-height:25px">Source Project:
<a href="https://www.programcreek.com/python/?project_name=birforce%2Fvnpy_crypto"><span style="font-style:italic">vnpy_crypto</span>&nbsp;&nbsp;</a>
Author: <span style="font-style:italic">birforce</span>&nbsp;&nbsp;
File: <a href="https://www.programcreek.com/python?code=birforce%2Fvnpy_crypto%2Fvnpy_crypto-master%2Fvenv%2Flib%2Fpython3.6%2Fsite-packages%2Fpymongo%2Furi_parser.py">uri_parser.py </a>&nbsp;&nbsp;
License: <a href="https://www.programcreek.com/python?code=birforce%2Fvnpy_crypto%2Fvnpy_crypto-master%2FLICENSE">MIT License</a></td><td width="10%" align="right" style="padding-right:5px;font-size:14px;color:#08c"><span style="color:#08c" id="210376votes">5</span>
votes</td><td width="12%" align="right" style="padding-right:5px;font-size:14px"><span class="vote vote_down click_button" style="float:right;padding-bottom:-2px;border-radius:2px;border:1px solid #d8d8d8" id="210376"><img alt="vote down" src="data:image/svg+xml,%3Csvg%20xmlns=%22http://www.w3.org/2000/svg%22%20width=%2248%22%20height=%2248%22%3E%3C/svg%3E" width="26" ezimgfmt="rs rscb13 src ng ngcb13" class="ezlazyload" data-ezsrc="https://www.programcreek.com/common/static/images/dislike.png"></span>
<span class="vote vote_up click_button" style="float:left;padding-top:-2px;border-radius:2px;border:1px solid #d8d8d8" id="210376"><img alt="vote up" src="data:image/svg+xml,%3Csvg%20xmlns=%22http://www.w3.org/2000/svg%22%20width=%2248%22%20height=%2248%22%3E%3C/svg%3E" width="26" ezimgfmt="rs rscb13 src ng ngcb13" class="ezlazyload" data-ezsrc="https://www.programcreek.com/common/static/images/like.png"></span></td></tr></tbody></table></div><div class="exampleboxbody"><pre class="prettyprint"><span class="kwd"><span class="kwd">def</span></span><span class="pln"><span class="pln"> _get_dns_txt_options</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">hostname</span></span><span class="pun"><span class="pun">):</span></span><span class="pln"><span class="pln">
    </span></span><span class="kwd"><span class="kwd">try</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln">
        results </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> resolver</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="highlight"><span class="pln">query</span></span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">hostname</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">'TXT'</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln">
    </span></span><span class="kwd"><span class="kwd">except</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">resolver</span></span><span class="pun"><span class="pun">.</span></span><span class="typ"><span class="typ">NoAnswer</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> resolver</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">NXDOMAIN</span></span><span class="pun"><span class="pun">):</span></span><span class="pln"><span class="pln">
        </span></span><span class="com"><span class="com"># No TXT records</span></span><span class="pln"><span class="pln">
        </span></span><span class="kwd"><span class="kwd">return</span></span><span class="pln"><span class="pln"> </span></span><span class="kwd"><span class="kwd">None</span></span><span class="pln"><span class="pln">
    </span></span><span class="kwd"><span class="kwd">except</span></span><span class="pln"><span class="pln"> </span></span><span class="typ"><span class="typ">Exception</span></span><span class="pln"><span class="pln"> </span></span><span class="kwd"><span class="kwd">as</span></span><span class="pln"><span class="pln"> exc</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln">
        </span></span><span class="kwd"><span class="kwd">raise</span></span><span class="pln"><span class="pln"> </span></span><span class="typ"><span class="typ">ConfigurationError</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">str</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">exc</span></span><span class="pun"><span class="pun">))</span></span><span class="pln"><span class="pln">
    </span></span><span class="kwd"><span class="kwd">if</span></span><span class="pln"><span class="pln"> len</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">results</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">&gt;</span></span><span class="pln"><span class="pln"> </span></span><span class="lit"><span class="lit">1</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln">
        </span></span><span class="kwd"><span class="kwd">raise</span></span><span class="pln"><span class="pln"> </span></span><span class="typ"><span class="typ">ConfigurationError</span></span><span class="pun"><span class="pun">(</span></span><span class="str"><span class="str">'Only one TXT record is supported'</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln">
    </span></span><span class="kwd"><span class="kwd">return</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">
        b</span></span><span class="str"><span class="str">'&amp;'</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">join</span></span><span class="pun"><span class="pun">([</span></span><span class="pln"><span class="pln">b</span></span><span class="str"><span class="str">''</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">join</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">res</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">strings</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln"> </span></span><span class="kwd"><span class="kwd">for</span></span><span class="pln"><span class="pln"> res </span></span><span class="kwd"><span class="kwd">in</span></span><span class="pln"><span class="pln"> results</span></span><span class="pun"><span class="pun">])).</span></span><span class="pln"><span class="pln">decode</span></span><span class="pun"><span class="pun">(</span></span><span class="str"><span class="str">'utf-8'</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln"> </span></span></pre></div></div><div style="margin:20px 2px;color:#424345;font-weight:700">Example #29</div><div class="examplebox"><div class="exampleboxheader"><table width="100%"><tbody><tr><td width="80%" style="padding:2px;font-size:14px;line-height:25px">Source Project:
<a href="https://www.programcreek.com/python/?project_name=Yukinoshita47%2FYuki-Chan-The-Auto-Pentest"><span style="font-style:italic">Yuki-Chan-The-Auto-Pentest</span>&nbsp;&nbsp;</a>
Author: <span style="font-style:italic">Yukinoshita47</span>&nbsp;&nbsp;
File: <a href="https://www.programcreek.com/python?code=Yukinoshita47%2FYuki-Chan-The-Auto-Pentest%2FYuki-Chan-The-Auto-Pentest-master%2FModule%2Fsublist3r%2Fsubbrute%2Fsubbrute.py">subbrute.py </a>&nbsp;&nbsp;
License: <a href="https://www.programcreek.com/python?code=Yukinoshita47%2FYuki-Chan-The-Auto-Pentest%2FYuki-Chan-The-Auto-Pentest-master%2FLICENSE">MIT License</a></td><td width="10%" align="right" style="padding-right:5px;font-size:14px;color:#08c"><span style="color:#08c" id="222552votes">5</span>
votes</td><td width="12%" align="right" style="padding-right:5px;font-size:14px"><span class="vote vote_down click_button" style="float:right;padding-bottom:-2px;border-radius:2px;border:1px solid #d8d8d8" id="222552"><img alt="vote down" src="data:image/svg+xml,%3Csvg%20xmlns=%22http://www.w3.org/2000/svg%22%20width=%2248%22%20height=%2248%22%3E%3C/svg%3E" width="26" ezimgfmt="rs rscb13 src ng ngcb13" class="ezlazyload" data-ezsrc="https://www.programcreek.com/common/static/images/dislike.png"></span>
<span class="vote vote_up click_button" style="float:left;padding-top:-2px;border-radius:2px;border:1px solid #d8d8d8" id="222552"><img alt="vote up" src="data:image/svg+xml,%3Csvg%20xmlns=%22http://www.w3.org/2000/svg%22%20width=%2248%22%20height=%2248%22%3E%3C/svg%3E" width="26" ezimgfmt="rs rscb13 src ng ngcb13" class="ezlazyload" data-ezsrc="https://www.programcreek.com/common/static/images/like.png"></span></td></tr></tbody></table></div><div class="exampleboxbody"><pre class="prettyprint"><span class="kwd"><span class="kwd">def</span></span><span class="pln"><span class="pln"> __init__</span></span><span class="pun"><span class="pun">(</span></span><span class="kwd"><span class="kwd">self</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> target</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> record_type</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> resolver_q</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> resolver_list</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> wildcards</span></span><span class="pun"><span class="pun">):</span></span><span class="pln"><span class="pln">
        multiprocessing</span></span><span class="pun"><span class="pun">.</span></span><span class="typ"><span class="typ">Process</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">__init__</span></span><span class="pun"><span class="pun">(</span></span><span class="kwd"><span class="kwd">self</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> target </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> </span></span><span class="kwd"><span class="kwd">self</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">run</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln">
        </span></span><span class="kwd"><span class="kwd">self</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">daemon </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> </span></span><span class="kwd"><span class="kwd">True</span></span><span class="pln"><span class="pln">
        signal_init</span></span><span class="pun"><span class="pun">()</span></span><span class="pln"><span class="pln">

        </span></span><span class="kwd"><span class="kwd">self</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">time_to_die </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> </span></span><span class="kwd"><span class="kwd">False</span></span><span class="pln"><span class="pln">
        </span></span><span class="kwd"><span class="kwd">self</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">resolver_q </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> resolver_q
        </span></span><span class="kwd"><span class="kwd">self</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">wildcards </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> wildcards
        </span></span><span class="com"><span class="com">#Do we need wildcards for other types of records?</span></span><span class="pln"><span class="pln">
        </span></span><span class="com"><span class="com">#This needs testing!</span></span><span class="pln"><span class="pln">
        </span></span><span class="kwd"><span class="kwd">self</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">record_type </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">"A"</span></span><span class="pln"><span class="pln">
        </span></span><span class="kwd"><span class="kwd">if</span></span><span class="pln"><span class="pln"> record_type </span></span><span class="pun"><span class="pun">==</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">"AAAA"</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln">
            </span></span><span class="kwd"><span class="kwd">self</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">record_type </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> record_type
        </span></span><span class="kwd"><span class="kwd">self</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">resolver_list </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> resolver_list
        resolver </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> dns</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">resolver</span></span><span class="pun"><span class="pun">.</span></span><span class="typ"><span class="typ">Resolver</span></span><span class="pun"><span class="pun">()</span></span><span class="pln"><span class="pln">
        </span></span><span class="com"><span class="com">#The domain provided by the user.</span></span><span class="pln"><span class="pln">
        </span></span><span class="kwd"><span class="kwd">self</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">target </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> target
        </span></span><span class="com"><span class="com">#1 website in the world,  modify the following line when this status changes.</span></span><span class="pln"><span class="pln">
        </span></span><span class="com"><span class="com">#www.google.cn,  I'm looking at you ;)</span></span><span class="pln"><span class="pln">
        </span></span><span class="kwd"><span class="kwd">self</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">most_popular_website </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">"www.google.com"</span></span><span class="pln"><span class="pln">
        </span></span><span class="com"><span class="com">#We shouldn't need the backup_resolver, but we we can use them if need be.</span></span><span class="pln"><span class="pln">
        </span></span><span class="com"><span class="com">#We must have a resolver,  and localhost can work in some environments.</span></span><span class="pln"><span class="pln">
        </span></span><span class="kwd"><span class="kwd">self</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">backup_resolver </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> resolver</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">nameservers </span></span><span class="pun"><span class="pun">+</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">[</span></span><span class="str"><span class="str">'127.0.0.1'</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">'8.8.8.8'</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> </span></span><span class="str"><span class="str">'8.8.4.4'</span></span><span class="pun"><span class="pun">]</span></span><span class="pln"><span class="pln">
        </span></span><span class="com"><span class="com">#Ideally a nameserver should respond in less than 1 sec.</span></span><span class="pln"><span class="pln">
        resolver</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">timeout </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> </span></span><span class="lit"><span class="lit">1</span></span><span class="pln"><span class="pln">
        resolver</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">lifetime </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> </span></span><span class="lit"><span class="lit">1</span></span><span class="pln"><span class="pln">
        </span></span><span class="kwd"><span class="kwd">try</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln">
            </span></span><span class="com"><span class="com">#Lets test the letancy of our connection.</span></span><span class="pln"><span class="pln">
            </span></span><span class="com"><span class="com">#Google's DNS server should be an ideal time test.</span></span><span class="pln"><span class="pln">
            resolver</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">nameservers </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">[</span></span><span class="str"><span class="str">'8.8.8.8'</span></span><span class="pun"><span class="pun">]</span></span><span class="pln"><span class="pln">
            resolver</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="highlight"><span class="pln">query</span></span></span><span class="pun"><span class="pun">(</span></span><span class="kwd"><span class="kwd">self</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">most_popular_website</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> </span></span><span class="kwd"><span class="kwd">self</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">record_type</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln">
        </span></span><span class="kwd"><span class="kwd">except</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln">
            </span></span><span class="com"><span class="com">#Our connection is slower than a junebug in molasses</span></span><span class="pln"><span class="pln">
            resolver </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> dns</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">resolver</span></span><span class="pun"><span class="pun">.</span></span><span class="typ"><span class="typ">Resolver</span></span><span class="pun"><span class="pun">()</span></span><span class="pln"><span class="pln">
        </span></span><span class="kwd"><span class="kwd">self</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">resolver </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> resolver </span></span></pre></div></div><div style="margin:20px 2px;color:#424345;font-weight:700">Example #30</div><div class="examplebox"><div class="exampleboxheader"><table width="100%"><tbody><tr><td width="80%" style="padding:2px;font-size:14px;line-height:25px">Source Project:
<a href="https://www.programcreek.com/python/?project_name=Yukinoshita47%2FYuki-Chan-The-Auto-Pentest"><span style="font-style:italic">Yuki-Chan-The-Auto-Pentest</span>&nbsp;&nbsp;</a>
Author: <span style="font-style:italic">Yukinoshita47</span>&nbsp;&nbsp;
File: <a href="https://www.programcreek.com/python?code=Yukinoshita47%2FYuki-Chan-The-Auto-Pentest%2FYuki-Chan-The-Auto-Pentest-master%2FModule%2Fsublist3r%2Fsubbrute%2Fsubbrute.py">subbrute.py </a>&nbsp;&nbsp;
License: <a href="https://www.programcreek.com/python?code=Yukinoshita47%2FYuki-Chan-The-Auto-Pentest%2FYuki-Chan-The-Auto-Pentest-master%2FLICENSE">MIT License</a></td><td width="10%" align="right" style="padding-right:5px;font-size:14px;color:#08c"><span style="color:#08c" id="222554votes">5</span>
votes</td><td width="12%" align="right" style="padding-right:5px;font-size:14px"><span class="vote vote_down click_button" style="float:right;padding-bottom:-2px;border-radius:2px;border:1px solid #d8d8d8" id="222554"><img alt="vote down" src="data:image/svg+xml,%3Csvg%20xmlns=%22http://www.w3.org/2000/svg%22%20width=%2248%22%20height=%2248%22%3E%3C/svg%3E" width="26" ezimgfmt="rs rscb13 src ng ngcb13" class="ezlazyload" data-ezsrc="https://www.programcreek.com/common/static/images/dislike.png"></span>
<span class="vote vote_up click_button" style="float:left;padding-top:-2px;border-radius:2px;border:1px solid #d8d8d8" id="222554"><img alt="vote up" src="data:image/svg+xml,%3Csvg%20xmlns=%22http://www.w3.org/2000/svg%22%20width=%2248%22%20height=%2248%22%3E%3C/svg%3E" width="26" ezimgfmt="rs rscb13 src ng ngcb13" class="ezlazyload" data-ezsrc="https://www.programcreek.com/common/static/images/like.png"></span></td></tr></tbody></table></div><div class="exampleboxbody"><pre class="prettyprint"><span class="kwd"><span class="kwd">def</span></span><span class="pln"><span class="pln"> verify</span></span><span class="pun"><span class="pun">(</span></span><span class="kwd"><span class="kwd">self</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> nameserver_list</span></span><span class="pun"><span class="pun">):</span></span><span class="pln"><span class="pln">
        added_resolver </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> </span></span><span class="kwd"><span class="kwd">False</span></span><span class="pln"><span class="pln">
        </span></span><span class="kwd"><span class="kwd">for</span></span><span class="pln"><span class="pln"> server </span></span><span class="kwd"><span class="kwd">in</span></span><span class="pln"><span class="pln"> nameserver_list</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln">
            </span></span><span class="kwd"><span class="kwd">if</span></span><span class="pln"><span class="pln"> </span></span><span class="kwd"><span class="kwd">self</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">time_to_die</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln">
                </span></span><span class="com"><span class="com">#We are done here.</span></span><span class="pln"><span class="pln">
                </span></span><span class="kwd"><span class="kwd">break</span></span><span class="pln"><span class="pln">
            server </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> server</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">strip</span></span><span class="pun"><span class="pun">()</span></span><span class="pln"><span class="pln">
            </span></span><span class="kwd"><span class="kwd">if</span></span><span class="pln"><span class="pln"> server</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln">
                </span></span><span class="kwd"><span class="kwd">self</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">resolver</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">nameservers </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> </span></span><span class="pun"><span class="pun">[</span></span><span class="pln"><span class="pln">server</span></span><span class="pun"><span class="pun">]</span></span><span class="pln"><span class="pln">
                </span></span><span class="kwd"><span class="kwd">try</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln">
                    </span></span><span class="com"><span class="com">#test_result = self.resolver.</span><span class="highlight"><span class="com">query</span></span><span class="com">(self.most_popular_website, "A")</span></span><span class="pln"><span class="pln">
                    </span></span><span class="com"><span class="com">#should throw an exception before this line.</span></span><span class="pln"><span class="pln">
                    </span></span><span class="kwd"><span class="kwd">if</span></span><span class="pln"><span class="pln"> </span></span><span class="kwd"><span class="kwd">True</span></span><span class="pun"><span class="pun">:</span></span><span class="com"><span class="com">#test_result:</span></span><span class="pln"><span class="pln">
                        </span></span><span class="com"><span class="com">#Only add the nameserver to the queue if we can detect wildcards. </span></span><span class="pln"><span class="pln">
                        </span></span><span class="kwd"><span class="kwd">if</span></span><span class="pun"><span class="pun">(</span></span><span class="kwd"><span class="kwd">self</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">find_wildcards</span></span><span class="pun"><span class="pun">(</span></span><span class="kwd"><span class="kwd">self</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">target</span></span><span class="pun"><span class="pun">)):</span></span><span class="com"><span class="com"># and self.find_wildcards(".com")</span></span><span class="pln"><span class="pln">
                            </span></span><span class="com"><span class="com">#wildcards have been added to the set, it is now safe to be added to the queue.</span></span><span class="pln"><span class="pln">
                            </span></span><span class="com"><span class="com">#blocking queue,  this process will halt on put() when the queue is full:</span></span><span class="pln"><span class="pln">
                            </span></span><span class="kwd"><span class="kwd">self</span></span><span class="pun"><span class="pun">.</span></span><span class="pln"><span class="pln">add_nameserver</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">server</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln">
                            added_resolver </span></span><span class="pun"><span class="pun">=</span></span><span class="pln"><span class="pln"> </span></span><span class="kwd"><span class="kwd">True</span></span><span class="pln"><span class="pln">
                        </span></span><span class="kwd"><span class="kwd">else</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln">
                            trace</span></span><span class="pun"><span class="pun">(</span></span><span class="str"><span class="str">"Rejected nameserver - wildcard:"</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> server</span></span><span class="pun"><span class="pun">)</span></span><span class="pln"><span class="pln">
                </span></span><span class="kwd"><span class="kwd">except</span></span><span class="pln"><span class="pln"> </span></span><span class="typ"><span class="typ">Exception</span></span><span class="pln"><span class="pln"> </span></span><span class="kwd"><span class="kwd">as</span></span><span class="pln"><span class="pln"> e</span></span><span class="pun"><span class="pun">:</span></span><span class="pln"><span class="pln">
                    </span></span><span class="com"><span class="com">#Rejected server :(</span></span><span class="pln"><span class="pln">
                    trace</span></span><span class="pun"><span class="pun">(</span></span><span class="str"><span class="str">"Rejected nameserver - unreliable:"</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> server</span></span><span class="pun"><span class="pun">,</span></span><span class="pln"><span class="pln"> type</span></span><span class="pun"><span class="pun">(</span></span><span class="pln"><span class="pln">e</span></span><span class="pun"><span class="pun">))</span></span><span class="pln"><span class="pln"> 
        </span></span><span class="kwd"><span class="kwd">return</span></span><span class="pln"><span class="pln"> added_resolver </span></span></pre></div></div><script ez-screx="true">$('.vote').hover(function(){$(this).addClass("hover");},function(){$(this).removeClass("hover");});$('pre').highlight("query",{caseSensitive:true,wordsOnly:true,wordsBoundary:'[\\b\\W]'});</script></div><div style="height:1px;width:100%;clear:both"></div></div><span class="ezoic-autoinsert-ad ezoic-bottom_of_page"></span><div id="footer"><div style="width:800px;margin:0 auto"><style>#footer-list li{font-size:13px;display:inline-block;padding:3px;text-align:center}</style><ul id="footer-list"></ul></div><div style="margin-top:15px"><a href="https://www.programcreek.com/python"><img alt="Program Creek" src="data:image/svg+xml,%3Csvg%20xmlns=%22http://www.w3.org/2000/svg%22%20width=%22342%22%20height=%2284%22%3E%3C/svg%3E" width="100" ezimgfmt="rs rscb13 src ng ngcb13" class="ezlazyload" data-ezsrc="https://www.programcreek.com/common/static/images/pc-logo.png"></a></div></div><script>var __inScopeForCCPA=false;function __uspapi(command,version,callback){var response=null;var successs=false;if(command==="getUSPData"&&version===1){var uspString="1";if(__inScopeForCCPA){uspString+="N";var result;var consentCookie=(result=new RegExp('(?:^|; )ezoccpaconsent=([^;]*)').exec(document.cookie))?(result[1]):null;if(consentCookie==="nonconsent"){uspString+="Y";}
else{uspString+="N";}
uspString+="N"}
else{uspString+="---";}
response={uspString:uspString,version:1};success=true;}
return callback(response,success);};function __receiveUspapiMessage(event){if(event.data.hasOwnProperty('__uspapiCall')){__uspapi('getUSPData',1,function(uspData,success){event.source.postMessage({__uspapiReturn:{returnValue:uspData,success:success,callId:event.data.__uspapiCall.callId}},event.origin);});}
return null;};window.addEventListener("message",__receiveUspapiMessage,false);</script><script data-cfasync="false">!function(){var e=function(e,t){for(var r=0;r<t.length;r++){var n=t[r];if(0==n.complete||void 0!==n.readyState&&n.readyState<4){var o=n.getAttribute("src")||n.currentSrc;void 0!==n.readyState&&0==n.readyState?n.addEventListener("loadstart",(function(e){var t=e.currentTarget.getAttribute("src")||e.currentSrc;window.ezorqs(e,t)})):(o=n.getAttribute("src")||n.currentSrc,window.ezorqs(n,o)),n.addEventListener("load",(function(e){var t=e.currentTarget.getAttribute("src")||e.srcElement.currentSrc;window.ezorqe(e,t)})),n.addEventListener("loadeddata",(function(e){var t=e.currentTarget.getAttribute("src")||e.srcElement.currentSrc;window.ezorqe(e,t)})),n.addEventListener("error",(function(e){var t=e.currentTarget.getAttribute("src")||e.srcElement.currentSrc;window.ezorqe(e,t)}))}}};function t(e){for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].href==e)return!0;return!1}__ez_addAllListeners=function(){e(0,document.querySelectorAll("img")),e(0,document.querySelectorAll("video")),e(0,document.querySelectorAll("audio")),function(e){for(var r=0;r<e.length;r++){var n=e[r];if(("preload"==n.getAttribute("rel")||"stylesheet"==n.getAttribute("rel"))&&null!=n.getAttribute("href")&&t(n.getAttribute("href"))){window.ezorqs(n,n.getAttribute("href"));var o=document.createElement("img");o.onerror=function(e){void 0!==e.path&&void 0!==e.path[0].currentSrc?window.ezorqe(n,e.path[0].currentSrc):void 0!==e.srcElement&&void 0!==e.srcElement.href&&window.ezorqe(n,e.srcElement.href)},o.src=n.getAttribute("href")}}}(document.querySelectorAll("link")),void 0!==window.__ez.ssaf&&window.__ez.ssaf.indexOf(16)>-1&&void 0!==window.__ez.sshsdef&&!1===window.__ez.sshsdef&&Element.prototype.addEventListener&&("function"==typeof window.onload&&(window.addEventListener("load",window.onload),window.onload=null),"function"==typeof document.onload&&(document.addEventListener.addEventListener("load",document.onload),document.onload=null))},__ez.queue.addFunc("__ez_addAllListeners","__ez_addAllListeners",null,!1,["/detroitchicago/tulsa.js"],!0,!0,!0,!0)}();</script><script style="display:none">var __ez_dims=(function(){var setCookie=function(name,content,expiry){return document.cookie=name+'='+content+((expiry)?';expires='+(new Date(Math.floor(new Date().getTime()+expiry*1000)).toUTCString()):'')+';path=/';};var ffid=1;var oh=window.screen.height;var ow=window.screen.width;var h=ffid===1?oh:(oh>ow)?oh:ow;var w=ffid===1?ow:(oh>ow)?ow:oh;var uh=window.innerHeight||document.documentElement.clientHeight||document.getElementsByTagName('body')[0].clientHeight;var uw=window.innerWidth||document.documentElement.clientWidth||document.getElementsByTagName('body')[0].clientWidth;setCookie('ezds',encodeURIComponent('ffid='+ffid+',w='+w+',h='+h),(31536e3*7));setCookie('ezohw',encodeURIComponent('w='+uw+',h='+uh),(31536e3*7));})();</script><script style="display:none" async=""></script></body></html>